<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quickstart in R &mdash; fastDFE beta documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DFE Inference" href="../inference.html" />
    <link rel="prev" title="Installation" href="../../r/installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            fastDFE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started (Python)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/quickstart.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started (R)</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../r/installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart in R</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-inference">Basic inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bootstrapping">Bootstrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#serialization">Serialization</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../inference.html">DFE Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/config.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/parametrizations.html">DFE parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectra.html">Working with SFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parser.html">Parsing SFS from VCF file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/miscellaneous.html">Miscellaneous</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules/inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/config.html">Configuration class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/parametrization.html">Parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/spectrum.html">Spectrum class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/spectra.html">Spectra class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/parser.html">VCF Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/annotation.html">VCF Annotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/filtration.html">VCF Filtration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">fastDFE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quickstart in R</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/r/quickstart.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quickstart-in-r">
<h1>Quickstart in R<a class="headerlink" href="#quickstart-in-r" title="Permalink to this heading"></a></h1>
<section id="basic-inference">
<h2>Basic inference<a class="headerlink" href="#basic-inference" title="Permalink to this heading"></a></h2>
<p>The easiest way to get started is by using the <a class="reference internal" href="../../modules/inference.html#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseInference</span></code></a> class which infers the DFE from a single pairs of SFSs, one neutral and one selected. In this example we create <a class="reference internal" href="../../modules/spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a> objects holding the SFS counts and pass it to <a class="reference internal" href="../../modules/inference.html#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseInference</span></code></a>. Note that we are required to specify the number of monomorphic sites (the last and first entries of the specified counts).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up fastDFE through reticulate</span>
<span class="c1">#install.packages(&quot;reticulate&quot;)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">reticulate</span><span class="p">)</span>
<span class="c1">#py_install(&quot;fastdfe&quot;)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;ggplot2&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dependencies</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="n">fastdfe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">import</span><span class="p">(</span><span class="s">&quot;fastdfe&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">fastdfe</span><span class="o">$</span><span class="n">`__version__`</span><span class="p">)</span>

<span class="n">fastdfe</span><span class="o">$</span><span class="n">visualization</span><span class="o">$</span><span class="n">Visualization</span><span class="o">$</span><span class="n">plot_discretized</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">,</span><span class="w"> </span><span class="n">intervals</span><span class="p">,</span>
<span class="w">                                                                 </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">                                                                 </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;discretized DFE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">interval_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span>
<span class="w">                                                                 </span><span class="n">legend_text_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">kwargs_legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># create a vector of x values</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># create a vector of y values as a function of x</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># create a line plot</span>
<span class="w">    </span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;l&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">return</span><span class="p">()</span>
<span class="w">    </span><span class="c1"># Create dataframe</span>
<span class="w">    </span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">unlist</span><span class="p">(</span><span class="n">values</span><span class="p">),</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">unlist</span><span class="p">(</span><span class="n">errors</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">unlist</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>

<span class="w">    </span><span class="c1"># Create interval factor variable</span>
<span class="w">    </span><span class="n">df</span><span class="o">$</span><span class="n">interval</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">intervals</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interval_labels</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Create the plot</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interval</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">labels</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;identity&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;dodge&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">errors</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">errors</span><span class="p">),</span>
<span class="w">                  </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">position_dodge</span><span class="p">(</span><span class="m">0.9</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;fraction&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s">&#39;bottom&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">legend_text_size</span><span class="p">),</span>
<span class="w">          </span><span class="n">legend.title</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span>

<span class="w">    </span><span class="c1"># Display the plot if show is TRUE</span>
<span class="w">    </span><span class="nf">if</span><span class="p">(</span><span class="n">show</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Save the plot to a file if a filename is provided</span>
<span class="w">    </span><span class="nf">if</span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">file</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">ggsave</span><span class="p">(</span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;in&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># import classes</span>
<span class="n">BaseInference</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fastdfe</span><span class="o">$</span><span class="n">BaseInference</span>
<span class="n">Spectrum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fastdfe</span><span class="o">$</span><span class="n">Spectrum</span>

<span class="c1"># configure inference</span>
<span class="n">inf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">BaseInference</span><span class="p">(</span>
<span class="w">  </span><span class="n">sfs_neut</span><span class="o">=</span><span class="nf">Spectrum</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">177130</span><span class="p">,</span><span class="w"> </span><span class="m">997</span><span class="p">,</span><span class="w"> </span><span class="m">441</span><span class="p">,</span><span class="w"> </span><span class="m">228</span><span class="p">,</span><span class="w"> </span><span class="m">156</span><span class="p">,</span><span class="w"> </span><span class="m">117</span><span class="p">,</span><span class="w"> </span><span class="m">114</span><span class="p">,</span><span class="w"> </span><span class="m">83</span><span class="p">,</span><span class="w"> </span><span class="m">105</span><span class="p">,</span><span class="w"> </span><span class="m">109</span><span class="p">,</span><span class="w"> </span><span class="m">652</span><span class="p">)),</span>
<span class="w">  </span><span class="n">sfs_sel</span><span class="o">=</span><span class="nf">Spectrum</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">797939</span><span class="p">,</span><span class="w"> </span><span class="m">1329</span><span class="p">,</span><span class="w"> </span><span class="m">499</span><span class="p">,</span><span class="w"> </span><span class="m">265</span><span class="p">,</span><span class="w"> </span><span class="m">162</span><span class="p">,</span><span class="w"> </span><span class="m">104</span><span class="p">,</span><span class="w"> </span><span class="m">117</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="m">94</span><span class="p">,</span><span class="w"> </span><span class="m">119</span><span class="p">,</span><span class="w"> </span><span class="m">794</span><span class="p">))</span>
<span class="p">)</span>

<span class="c1"># Run inference</span>
<span class="n">inf</span><span class="o">$</span><span class="nf">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in download.file(url, destfile, method, mode = &quot;wb&quot;, ...):
“downloaded length 65536 != reported length 3024838”
Warning message in download.file(url, destfile, method, mode = &quot;wb&quot;, ...):
“URL &#39;https://cran.r-project.org/src/contrib/sass_0.4.6.tar.gz&#39;: Timeout of 60 seconds was reached”
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error in download.file(url, destfile, method, mode = &quot;wb&quot;, ...) : 
  download from &#39;https://cran.r-project.org/src/contrib/sass_0.4.6.tar.gz&#39; failed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in download.packages(pkgs, destdir = tmpd, available = available, :
“download of package ‘sass’ failed”
Warning message in download.file(url, destfile, method, mode = &quot;wb&quot;, ...):
“downloaded length 1081344 != reported length 2184560”
Warning message in download.file(url, destfile, method, mode = &quot;wb&quot;, ...):
“URL &#39;https://cran.r-project.org/src/contrib/rmarkdown_2.22.tar.gz&#39;: Timeout of 60 seconds was reached”
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error in download.file(url, destfile, method, mode = &quot;wb&quot;, ...) : 
  download from &#39;https://cran.r-project.org/src/contrib/rmarkdown_2.22.tar.gz&#39; failed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in download.packages(pkgs, destdir = tmpd, available = available, :
“download of package ‘rmarkdown’ failed”
Warning message in download.file(url, destfile, method, mode = &quot;wb&quot;, ...):
“downloaded length 458752 != reported length 859025”
Warning message in download.file(url, destfile, method, mode = &quot;wb&quot;, ...):
“URL &#39;https://cran.r-project.org/src/contrib/rpart_4.1.19.tar.gz&#39;: Timeout of 60 seconds was reached”
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error in download.file(url, destfile, method, mode = &quot;wb&quot;, ...) : 
  download from &#39;https://cran.r-project.org/src/contrib/rpart_4.1.19.tar.gz&#39; failed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in download.packages(pkgs, destdir = tmpd, available = available, :
“download of package ‘rpart’ failed”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘sys’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘backports’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘proxy’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘lazyeval’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘curl’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘mime’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘zoo’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘cachem’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘KernSmooth’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘wk’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘fs’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘farver’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘magrittr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘yaml’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘cluster’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘nnet’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘foreign’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘data.table’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘colorspace’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘xfun’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘sp’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘mvtnorm’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘survival’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘SparseM’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘systemfonts’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘units’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘brio’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘ps’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘diffobj’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘isoband’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘MASS’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘hexbin’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘maps’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘nlme’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘xml2’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘askpass’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘checkmate’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘memoise’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘class’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘rex’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘highr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘TH.data’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘sandwich’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘purrr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘stringr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘textshaping’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘tinytex’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘s2’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘pkgload’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘processx’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘mgcv’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘tibble’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘mapproj’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘maptools’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘munsell’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘quantreg’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘rgeos’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘svglite’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘openssl’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘e1071’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘rematch2’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘bslib’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘callr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘scales’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘dplyr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘knitr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘multcomp’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘ragg’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘httr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘htmlwidgets’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘classInt’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘waldo’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘ggplot2’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘htmlTable’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘viridis’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘covr’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘profvis’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘sf’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘testthat’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘Hmisc’ had non-zero exit status”
Warning message in install.packages(&quot;ggplot2&quot;, dependencies = TRUE):
“installation of package ‘vdiffr’ had non-zero exit status”
Updating HTML index of packages in &#39;.Library&#39;

Making &#39;packages.html&#39; ...
 done
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>Error in library(ggplot2): there is no package called ‘ggplot2’
Traceback:

1. library(ggplot2)
</pre></div>
</div>
</div>
</div>
<p>fastDFE uses maximum likelihood estimation (MLE) to find the DFE. By default, 10 local optimization runs are carried out to make sure a reasonably good global optimum has been bound. The DFE furthermore needs to parametrized where <a class="reference internal" href="../../modules/parametrization.html#fastdfe.parametrization.GammaExpParametrization" title="fastdfe.parametrization.GammaExpParametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">GammaExpParametrization</span></code></a> is used by default.</p>
<p>We can now plot the inferred DFE in discretized form (cf. <a class="reference internal" href="../../modules/inference.html#fastdfe.base_inference.BaseInference.plot_discretized" title="fastdfe.base_inference.BaseInference.plot_discretized"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_discretized()</span></code></a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">inf</span><span class="o">$</span><span class="nf">plot_discretized</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/28761d3ebbf3096a578386a8ad64062cef28caf9427f083f64dcf25c2a845621.png" src="../../_images/28761d3ebbf3096a578386a8ad64062cef28caf9427f083f64dcf25c2a845621.png" />
</div>
</div>
<p>We can also plot a comparison of the (selected) modelled and observed SFS (cf. <a class="reference internal" href="../../modules/inference.html#fastdfe.base_inference.BaseInference.plot_sfs_comparison" title="fastdfe.base_inference.BaseInference.plot_sfs_comparison"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_sfs_comparison()</span></code></a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">inf</span><span class="o">$</span><span class="nf">plot_sfs_comparison</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="bootstrapping">
<h2>Bootstrapping<a class="headerlink" href="#bootstrapping" title="Permalink to this heading"></a></h2>
<p>We can perform parametric bootstrapping (cf. <a class="reference internal" href="../../modules/inference.html#fastdfe.base_inference.BaseInference.bootstrap" title="fastdfe.base_inference.BaseInference.bootstrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">bootstrap()</span></code></a>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">inf</span><span class="o">$</span><span class="nf">bootstrap</span><span class="p">()</span>

<span class="c1"># redo the plotting</span>
<span class="n">inf</span><span class="o">$</span><span class="nf">plot_discretized</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="serialization">
<h2>Serialization<a class="headerlink" href="#serialization" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the inference object to the file</span>
<span class="c1"># we can unserialized the inference by using BaseInference.from_file</span>
<span class="n">inf</span><span class="o">$</span><span class="nf">to_file</span><span class="p">(</span><span class="s">&quot;out/serialized.json&quot;</span><span class="p">)</span>

<span class="c1"># alternatively we can also save a summary to file</span>
<span class="n">inf</span><span class="o">$</span><span class="nf">get_summary</span><span class="p">()</span><span class="o">$</span><span class="nf">to_file</span><span class="p">(</span><span class="s">&quot;out/summary.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../r/installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../inference.html" class="btn btn-neutral float-right" title="DFE Inference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Janek Sendrowski.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>