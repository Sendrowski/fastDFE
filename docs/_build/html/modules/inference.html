<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inference &mdash; fastDFE beta documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Configuration class" href="config.html" />
    <link rel="prev" title="Miscellaneous" href="../reference/miscellaneous.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            fastDFE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started (Python)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation_python.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/quickstart_python.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started (R)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation_r.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/quickstart_r.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/inference.html">DFE Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/config.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/parametrizations.html">DFE parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/spectra.html">Working with SFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/parser.html">Parsing SFS from VCF file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/miscellaneous.html">Miscellaneous</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Inference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.base_inference.BaseInference"><code class="docutils literal notranslate"><span class="pre">BaseInference</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.default_x0"><code class="docutils literal notranslate"><span class="pre">BaseInference.default_x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.default_bounds"><code class="docutils literal notranslate"><span class="pre">BaseInference.default_bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.default_scales"><code class="docutils literal notranslate"><span class="pre">BaseInference.default_scales</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.default_opts_mle"><code class="docutils literal notranslate"><span class="pre">BaseInference.default_opts_mle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.__init__"><code class="docutils literal notranslate"><span class="pre">BaseInference.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.sfs_neut"><code class="docutils literal notranslate"><span class="pre">BaseInference.sfs_neut</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.sfs_sel"><code class="docutils literal notranslate"><span class="pre">BaseInference.sfs_sel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.model"><code class="docutils literal notranslate"><span class="pre">BaseInference.model</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.folded"><code class="docutils literal notranslate"><span class="pre">BaseInference.folded</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.n"><code class="docutils literal notranslate"><span class="pre">BaseInference.n</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.discretization"><code class="docutils literal notranslate"><span class="pre">BaseInference.discretization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.theta"><code class="docutils literal notranslate"><span class="pre">BaseInference.theta</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.params_mle"><code class="docutils literal notranslate"><span class="pre">BaseInference.params_mle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.sfs_mle"><code class="docutils literal notranslate"><span class="pre">BaseInference.sfs_mle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.likelihood"><code class="docutils literal notranslate"><span class="pre">BaseInference.likelihood</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.likelihoods"><code class="docutils literal notranslate"><span class="pre">BaseInference.likelihoods</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.n_runs"><code class="docutils literal notranslate"><span class="pre">BaseInference.n_runs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.result"><code class="docutils literal notranslate"><span class="pre">BaseInference.result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.do_bootstrap"><code class="docutils literal notranslate"><span class="pre">BaseInference.do_bootstrap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.n_bootstraps"><code class="docutils literal notranslate"><span class="pre">BaseInference.n_bootstraps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.parallelize"><code class="docutils literal notranslate"><span class="pre">BaseInference.parallelize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.fixed_params"><code class="docutils literal notranslate"><span class="pre">BaseInference.fixed_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.scales"><code class="docutils literal notranslate"><span class="pre">BaseInference.scales</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.bounds"><code class="docutils literal notranslate"><span class="pre">BaseInference.bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.optimization"><code class="docutils literal notranslate"><span class="pre">BaseInference.optimization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.x0"><code class="docutils literal notranslate"><span class="pre">BaseInference.x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.bootstraps"><code class="docutils literal notranslate"><span class="pre">BaseInference.bootstraps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.bootstrap_results"><code class="docutils literal notranslate"><span class="pre">BaseInference.bootstrap_results</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.L2_residual"><code class="docutils literal notranslate"><span class="pre">BaseInference.L2_residual</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.seed"><code class="docutils literal notranslate"><span class="pre">BaseInference.seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.rng"><code class="docutils literal notranslate"><span class="pre">BaseInference.rng</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.execution_time"><code class="docutils literal notranslate"><span class="pre">BaseInference.execution_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.locked"><code class="docutils literal notranslate"><span class="pre">BaseInference.locked</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_fixed_param_names"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_fixed_param_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.check_fixed_params_exist"><code class="docutils literal notranslate"><span class="pre">BaseInference.check_fixed_params_exist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.raise_if_locked"><code class="docutils literal notranslate"><span class="pre">BaseInference.raise_if_locked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.run_if_required"><code class="docutils literal notranslate"><span class="pre">BaseInference.run_if_required()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.run_if_required_wrapper"><code class="docutils literal notranslate"><span class="pre">BaseInference.run_if_required_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.run"><code class="docutils literal notranslate"><span class="pre">BaseInference.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_counts"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_counts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.evaluate_likelihood"><code class="docutils literal notranslate"><span class="pre">BaseInference.evaluate_likelihood()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.assign_result"><code class="docutils literal notranslate"><span class="pre">BaseInference.assign_result()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.report_result"><code class="docutils literal notranslate"><span class="pre">BaseInference.report_result()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.update_properties"><code class="docutils literal notranslate"><span class="pre">BaseInference.update_properties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.bootstrap"><code class="docutils literal notranslate"><span class="pre">BaseInference.bootstrap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.add_alpha_to_bootstraps"><code class="docutils literal notranslate"><span class="pre">BaseInference.add_alpha_to_bootstraps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.resample_sfs"><code class="docutils literal notranslate"><span class="pre">BaseInference.resample_sfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.run_bootstrap_sample"><code class="docutils literal notranslate"><span class="pre">BaseInference.run_bootstrap_sample()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_scales_linear"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_scales_linear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_bounds_linear"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_bounds_linear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.model_sfs"><code class="docutils literal notranslate"><span class="pre">BaseInference.model_sfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.adjust_polarization"><code class="docutils literal notranslate"><span class="pre">BaseInference.adjust_polarization()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.add_demography"><code class="docutils literal notranslate"><span class="pre">BaseInference.add_demography()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_continuous"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_continuous()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_bucket_sizes"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_bucket_sizes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_interval_density"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_interval_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_sfs_comparison"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_sfs_comparison()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_observed_sfs"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_observed_sfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_all"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_all()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_errors_discretized_dfe"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_errors_discretized_dfe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_inferred_parameters"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_inferred_parameters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_inferred_parameters_boxplot"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_inferred_parameters_boxplot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_likelihoods"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_likelihoods()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.lrt"><code class="docutils literal notranslate"><span class="pre">BaseInference.lrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.compare_nested_likelihoods"><code class="docutils literal notranslate"><span class="pre">BaseInference.compare_nested_likelihoods()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.compare_nested_models"><code class="docutils literal notranslate"><span class="pre">BaseInference.compare_nested_models()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_nested_likelihoods"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_nested_likelihoods()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.plot_discretized"><code class="docutils literal notranslate"><span class="pre">BaseInference.plot_discretized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_alpha"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_alpha()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.alpha"><code class="docutils literal notranslate"><span class="pre">BaseInference.alpha</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_bootstrap_params"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_bootstrap_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_bootstrap_param_names"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_bootstrap_param_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_optimized_param_names"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_optimized_param_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_n_optimized"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_n_optimized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.create_config"><code class="docutils literal notranslate"><span class="pre">BaseInference.create_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.from_config"><code class="docutils literal notranslate"><span class="pre">BaseInference.from_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.from_config_file"><code class="docutils literal notranslate"><span class="pre">BaseInference.from_config_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_summary"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_summary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_x0"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_x0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.param_names"><code class="docutils literal notranslate"><span class="pre">BaseInference.param_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.to_json"><code class="docutils literal notranslate"><span class="pre">BaseInference.to_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.from_file"><code class="docutils literal notranslate"><span class="pre">BaseInference.from_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.from_json"><code class="docutils literal notranslate"><span class="pre">BaseInference.from_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_cis_params_mle"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_cis_params_mle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.get_discretized"><code class="docutils literal notranslate"><span class="pre">BaseInference.get_discretized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.base_inference.BaseInference.to_file"><code class="docutils literal notranslate"><span class="pre">BaseInference.to_file()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.joint_inference.JointInference"><code class="docutils literal notranslate"><span class="pre">JointInference</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.__init__"><code class="docutils literal notranslate"><span class="pre">JointInference.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.types"><code class="docutils literal notranslate"><span class="pre">JointInference.types</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.params_mle_raw"><code class="docutils literal notranslate"><span class="pre">JointInference.params_mle_raw</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.shared_params"><code class="docutils literal notranslate"><span class="pre">JointInference.shared_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.covariates"><code class="docutils literal notranslate"><span class="pre">JointInference.covariates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.x0_cov"><code class="docutils literal notranslate"><span class="pre">JointInference.x0_cov</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.fixed_params"><code class="docutils literal notranslate"><span class="pre">JointInference.fixed_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.marginal_inferences"><code class="docutils literal notranslate"><span class="pre">JointInference.marginal_inferences</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.scales"><code class="docutils literal notranslate"><span class="pre">JointInference.scales</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.bounds"><code class="docutils literal notranslate"><span class="pre">JointInference.bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.optimization"><code class="docutils literal notranslate"><span class="pre">JointInference.optimization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.joint_inferences"><code class="docutils literal notranslate"><span class="pre">JointInference.joint_inferences</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.check_shared_params"><code class="docutils literal notranslate"><span class="pre">JointInference.check_shared_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.check_no_shared_params_fixed"><code class="docutils literal notranslate"><span class="pre">JointInference.check_no_shared_params_fixed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_shared_param_names"><code class="docutils literal notranslate"><span class="pre">JointInference.get_shared_param_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.add_covariates_as_shared"><code class="docutils literal notranslate"><span class="pre">JointInference.add_covariates_as_shared()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.determine_unshared_covariates"><code class="docutils literal notranslate"><span class="pre">JointInference.determine_unshared_covariates()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.run"><code class="docutils literal notranslate"><span class="pre">JointInference.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.run_marginal"><code class="docutils literal notranslate"><span class="pre">JointInference.run_marginal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.marginals_without_all"><code class="docutils literal notranslate"><span class="pre">JointInference.marginals_without_all()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.run_joint"><code class="docutils literal notranslate"><span class="pre">JointInference.run_joint()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.joint_inference_makes_sense"><code class="docutils literal notranslate"><span class="pre">JointInference.joint_inference_makes_sense()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_counts"><code class="docutils literal notranslate"><span class="pre">JointInference.get_counts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.run_joint_without_covariates"><code class="docutils literal notranslate"><span class="pre">JointInference.run_joint_without_covariates()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.create_config"><code class="docutils literal notranslate"><span class="pre">JointInference.create_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.perform_lrt_covariates"><code class="docutils literal notranslate"><span class="pre">JointInference.perform_lrt_covariates()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.add_covariates"><code class="docutils literal notranslate"><span class="pre">JointInference.add_covariates()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.bootstrap"><code class="docutils literal notranslate"><span class="pre">JointInference.bootstrap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.bootstrap_if_required"><code class="docutils literal notranslate"><span class="pre">JointInference.bootstrap_if_required()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.run_joint_bootstrap_sample"><code class="docutils literal notranslate"><span class="pre">JointInference.run_joint_bootstrap_sample()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_x0"><code class="docutils literal notranslate"><span class="pre">JointInference.get_x0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.perform_lrt_shared"><code class="docutils literal notranslate"><span class="pre">JointInference.perform_lrt_shared()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_inferences"><code class="docutils literal notranslate"><span class="pre">JointInference.get_inferences()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_discretized"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_discretized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_sfs_comparison"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_sfs_comparison()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_continuous"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_continuous()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_inferred_parameters"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_inferred_parameters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_inferred_parameters_boxplot"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_inferred_parameters_boxplot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_cis_params_mle"><code class="docutils literal notranslate"><span class="pre">JointInference.get_cis_params_mle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_discretized"><code class="docutils literal notranslate"><span class="pre">JointInference.get_discretized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_bootstrap_params"><code class="docutils literal notranslate"><span class="pre">JointInference.get_bootstrap_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.to_json"><code class="docutils literal notranslate"><span class="pre">JointInference.to_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.alpha"><code class="docutils literal notranslate"><span class="pre">JointInference.alpha</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_L2_residual"><code class="docutils literal notranslate"><span class="pre">JointInference.get_L2_residual()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.add_alpha_to_bootstraps"><code class="docutils literal notranslate"><span class="pre">JointInference.add_alpha_to_bootstraps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.add_demography"><code class="docutils literal notranslate"><span class="pre">JointInference.add_demography()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.adjust_polarization"><code class="docutils literal notranslate"><span class="pre">JointInference.adjust_polarization()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.assign_result"><code class="docutils literal notranslate"><span class="pre">JointInference.assign_result()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.check_fixed_params_exist"><code class="docutils literal notranslate"><span class="pre">JointInference.check_fixed_params_exist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.compare_nested_likelihoods"><code class="docutils literal notranslate"><span class="pre">JointInference.compare_nested_likelihoods()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.compare_nested_models"><code class="docutils literal notranslate"><span class="pre">JointInference.compare_nested_models()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.default_bounds"><code class="docutils literal notranslate"><span class="pre">JointInference.default_bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.default_opts_mle"><code class="docutils literal notranslate"><span class="pre">JointInference.default_opts_mle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.default_scales"><code class="docutils literal notranslate"><span class="pre">JointInference.default_scales</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.default_x0"><code class="docutils literal notranslate"><span class="pre">JointInference.default_x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.evaluate_likelihood"><code class="docutils literal notranslate"><span class="pre">JointInference.evaluate_likelihood()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.from_config"><code class="docutils literal notranslate"><span class="pre">JointInference.from_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.from_config_file"><code class="docutils literal notranslate"><span class="pre">JointInference.from_config_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.from_file"><code class="docutils literal notranslate"><span class="pre">JointInference.from_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.from_json"><code class="docutils literal notranslate"><span class="pre">JointInference.from_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_alpha"><code class="docutils literal notranslate"><span class="pre">JointInference.get_alpha()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_bootstrap_param_names"><code class="docutils literal notranslate"><span class="pre">JointInference.get_bootstrap_param_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_bounds_linear"><code class="docutils literal notranslate"><span class="pre">JointInference.get_bounds_linear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_errors_discretized_dfe"><code class="docutils literal notranslate"><span class="pre">JointInference.get_errors_discretized_dfe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_fixed_param_names"><code class="docutils literal notranslate"><span class="pre">JointInference.get_fixed_param_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_n_optimized"><code class="docutils literal notranslate"><span class="pre">JointInference.get_n_optimized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_optimized_param_names"><code class="docutils literal notranslate"><span class="pre">JointInference.get_optimized_param_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_scales_linear"><code class="docutils literal notranslate"><span class="pre">JointInference.get_scales_linear()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.get_summary"><code class="docutils literal notranslate"><span class="pre">JointInference.get_summary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.lrt"><code class="docutils literal notranslate"><span class="pre">JointInference.lrt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.model_sfs"><code class="docutils literal notranslate"><span class="pre">JointInference.model_sfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.param_names"><code class="docutils literal notranslate"><span class="pre">JointInference.param_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_all"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_all()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_bucket_sizes"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_bucket_sizes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_interval_density"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_interval_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_likelihoods"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_likelihoods()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_nested_likelihoods"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_nested_likelihoods()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.plot_observed_sfs"><code class="docutils literal notranslate"><span class="pre">JointInference.plot_observed_sfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.raise_if_locked"><code class="docutils literal notranslate"><span class="pre">JointInference.raise_if_locked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.report_result"><code class="docutils literal notranslate"><span class="pre">JointInference.report_result()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.resample_sfs"><code class="docutils literal notranslate"><span class="pre">JointInference.resample_sfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.run_bootstrap_sample"><code class="docutils literal notranslate"><span class="pre">JointInference.run_bootstrap_sample()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.run_if_required"><code class="docutils literal notranslate"><span class="pre">JointInference.run_if_required()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.run_if_required_wrapper"><code class="docutils literal notranslate"><span class="pre">JointInference.run_if_required_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.to_file"><code class="docutils literal notranslate"><span class="pre">JointInference.to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.update_properties"><code class="docutils literal notranslate"><span class="pre">JointInference.update_properties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.sfs_neut"><code class="docutils literal notranslate"><span class="pre">JointInference.sfs_neut</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.sfs_sel"><code class="docutils literal notranslate"><span class="pre">JointInference.sfs_sel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.model"><code class="docutils literal notranslate"><span class="pre">JointInference.model</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.folded"><code class="docutils literal notranslate"><span class="pre">JointInference.folded</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.n"><code class="docutils literal notranslate"><span class="pre">JointInference.n</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.discretization"><code class="docutils literal notranslate"><span class="pre">JointInference.discretization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.theta"><code class="docutils literal notranslate"><span class="pre">JointInference.theta</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.params_mle"><code class="docutils literal notranslate"><span class="pre">JointInference.params_mle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.sfs_mle"><code class="docutils literal notranslate"><span class="pre">JointInference.sfs_mle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.likelihood"><code class="docutils literal notranslate"><span class="pre">JointInference.likelihood</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.likelihoods"><code class="docutils literal notranslate"><span class="pre">JointInference.likelihoods</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.n_runs"><code class="docutils literal notranslate"><span class="pre">JointInference.n_runs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.result"><code class="docutils literal notranslate"><span class="pre">JointInference.result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.do_bootstrap"><code class="docutils literal notranslate"><span class="pre">JointInference.do_bootstrap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.n_bootstraps"><code class="docutils literal notranslate"><span class="pre">JointInference.n_bootstraps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.parallelize"><code class="docutils literal notranslate"><span class="pre">JointInference.parallelize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.bootstraps"><code class="docutils literal notranslate"><span class="pre">JointInference.bootstraps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.bootstrap_results"><code class="docutils literal notranslate"><span class="pre">JointInference.bootstrap_results</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.L2_residual"><code class="docutils literal notranslate"><span class="pre">JointInference.L2_residual</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.seed"><code class="docutils literal notranslate"><span class="pre">JointInference.seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.execution_time"><code class="docutils literal notranslate"><span class="pre">JointInference.execution_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.locked"><code class="docutils literal notranslate"><span class="pre">JointInference.locked</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.x0"><code class="docutils literal notranslate"><span class="pre">JointInference.x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.joint_inference.JointInference.rng"><code class="docutils literal notranslate"><span class="pre">JointInference.rng</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.abstract_inference.Inference"><code class="docutils literal notranslate"><span class="pre">Inference</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.plot_discretized"><code class="docutils literal notranslate"><span class="pre">Inference.plot_discretized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.plot_continuous"><code class="docutils literal notranslate"><span class="pre">Inference.plot_continuous()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.plot_inferred_parameters"><code class="docutils literal notranslate"><span class="pre">Inference.plot_inferred_parameters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.plot_inferred_parameters_boxplot"><code class="docutils literal notranslate"><span class="pre">Inference.plot_inferred_parameters_boxplot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.get_cis_params_mle"><code class="docutils literal notranslate"><span class="pre">Inference.get_cis_params_mle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.get_errors_params_mle"><code class="docutils literal notranslate"><span class="pre">Inference.get_errors_params_mle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.get_discretized"><code class="docutils literal notranslate"><span class="pre">Inference.get_discretized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.get_stats_discretized"><code class="docutils literal notranslate"><span class="pre">Inference.get_stats_discretized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.abstract_inference.Inference.compute_histogram"><code class="docutils literal notranslate"><span class="pre">Inference.compute_histogram()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.optimization.SharedParams"><code class="docutils literal notranslate"><span class="pre">SharedParams</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.SharedParams.params"><code class="docutils literal notranslate"><span class="pre">SharedParams.params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.SharedParams.types"><code class="docutils literal notranslate"><span class="pre">SharedParams.types</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.SharedParams.__init__"><code class="docutils literal notranslate"><span class="pre">SharedParams.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.optimization.Covariate"><code class="docutils literal notranslate"><span class="pre">Covariate</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.param"><code class="docutils literal notranslate"><span class="pre">Covariate.param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.values"><code class="docutils literal notranslate"><span class="pre">Covariate.values</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.callback"><code class="docutils literal notranslate"><span class="pre">Covariate.callback</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.bounds"><code class="docutils literal notranslate"><span class="pre">Covariate.bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.x0"><code class="docutils literal notranslate"><span class="pre">Covariate.x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.bounds_scale"><code class="docutils literal notranslate"><span class="pre">Covariate.bounds_scale</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.apply"><code class="docutils literal notranslate"><span class="pre">Covariate.apply()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.apply_default"><code class="docutils literal notranslate"><span class="pre">Covariate.apply_default()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.optimization.Covariate.__init__"><code class="docutils literal notranslate"><span class="pre">Covariate.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration class</a></li>
<li class="toctree-l1"><a class="reference internal" href="parametrization.html">Parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectrum.html">Spectrum class</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectra.html">Spectra class</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">VCF Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotation.html">VCF Annotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtration.html">VCF Filtration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fastDFE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Inference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/inference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="inference">
<span id="modules-base-inference"></span><h1>Inference<a class="headerlink" href="#inference" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fastdfe.base_inference.</span></span><span class="sig-name descname"><span class="pre">BaseInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs_neut:</span> <span class="pre">fastdfe.spectrum.Spectra</span> <span class="pre">|</span> <span class="pre">fastdfe.spectrum.Spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_sel:</span> <span class="pre">fastdfe.spectrum.Spectra</span> <span class="pre">|</span> <span class="pre">fastdfe.spectrum.Spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_del:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(-100000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_ben:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_mode:</span> <span class="pre">typing.Literal['midpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'quad']</span> <span class="pre">=</span> <span class="pre">'midpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linearized:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">fastdfe.parametrization.Parametrization</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'GammaExpParametrization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Tuple[float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Literal['lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'symlog']]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type:</span> <span class="pre">typing.Literal['likelihood'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'L2']</span> <span class="pre">=</span> <span class="pre">'likelihood'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opts_mle:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_bootstrap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstraps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded:</span> <span class="pre">typing.Optional[bool]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discretization:</span> <span class="pre">typing.Optional[fastdfe.discretization.Discretization]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization:</span> <span class="pre">typing.Optional[fastdfe.optimization.Optimization]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractInference</span></code></p>
<p>Base inference class for inferring the SFS given one neutral and one selected SFS.
Note that BaseInference is by default seeded.</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastdfe</span> <span class="kn">import</span> <span class="n">Spectrum</span><span class="p">,</span> <span class="n">BaseInference</span>

<span class="n">sfs_neut</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">([</span><span class="mi">177130</span><span class="p">,</span> <span class="mi">997</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">652</span><span class="p">])</span>
<span class="n">sfs_sel</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">([</span><span class="mi">797939</span><span class="p">,</span> <span class="mi">1329</span><span class="p">,</span> <span class="mi">499</span><span class="p">,</span> <span class="mi">265</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">794</span><span class="p">])</span>

<span class="c1"># create inference object</span>
<span class="n">inf</span> <span class="o">=</span> <span class="n">BaseInference</span><span class="p">(</span>
    <span class="n">sfs_neut</span><span class="o">=</span><span class="n">sfs_neut</span><span class="p">,</span>
    <span class="n">sfs_sel</span><span class="o">=</span><span class="n">sfs_sel</span><span class="p">,</span>
    <span class="n">n_runs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">n_bootstraps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">do_bootstrap</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># run inference</span>
<span class="n">inf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># plot discretized DFE</span>
<span class="n">inf</span><span class="o">.</span><span class="n">plot_discretized</span><span class="p">()</span>

<span class="c1"># plot SFS comparison</span>
<span class="n">inf</span><span class="o">.</span><span class="n">plot_sfs_comparison</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.default_x0">
<span class="sig-name descname"><span class="pre">default_x0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'eps':</span> <span class="pre">0.0}</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.default_x0" title="Permalink to this definition"></a></dt>
<dd><p>Default parameters not connected to the DFE parametrization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.default_bounds">
<span class="sig-name descname"><span class="pre">default_bounds</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'eps':</span> <span class="pre">(0,</span> <span class="pre">0.15)}</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.default_bounds" title="Permalink to this definition"></a></dt>
<dd><p>Default parameter bounds not connected to the DFE parametrization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.default_scales">
<span class="sig-name descname"><span class="pre">default_scales</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'eps':</span> <span class="pre">'lin'}</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.default_scales" title="Permalink to this definition"></a></dt>
<dd><p>Scales for the parameters not connected to the DFE parametrization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.default_opts_mle">
<span class="sig-name descname"><span class="pre">default_opts_mle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.default_opts_mle" title="Permalink to this definition"></a></dt>
<dd><p>Default options for the MLE</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs_neut:</span> <span class="pre">fastdfe.spectrum.Spectra</span> <span class="pre">|</span> <span class="pre">fastdfe.spectrum.Spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_sel:</span> <span class="pre">fastdfe.spectrum.Spectra</span> <span class="pre">|</span> <span class="pre">fastdfe.spectrum.Spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_del:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(-100000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_ben:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_mode:</span> <span class="pre">typing.Literal['midpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'quad']</span> <span class="pre">=</span> <span class="pre">'midpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linearized:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">fastdfe.parametrization.Parametrization</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'GammaExpParametrization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Tuple[float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Literal['lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'symlog']]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type:</span> <span class="pre">typing.Literal['likelihood'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'L2']</span> <span class="pre">=</span> <span class="pre">'likelihood'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opts_mle:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_bootstrap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstraps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded:</span> <span class="pre">typing.Optional[bool]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">discretization:</span> <span class="pre">typing.Optional[fastdfe.discretization.Discretization]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization:</span> <span class="pre">typing.Optional[fastdfe.optimization.Optimization]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create BaseInference instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfs_neut</strong> (<a class="reference internal" href="spectra.html#fastdfe.spectrum.Spectra" title="fastdfe.spectrum.Spectra"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectra</span></code></a> | <a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – The neutral SFS. Note that we require monomorphic counts to be specified in order to infer
the mutation rate. If a <code class="docutils literal notranslate"><span class="pre">Spectra</span></code> object with more than one SFS is provided, the <code class="docutils literal notranslate"><span class="pre">all</span></code> attribute will be
used.</p></li>
<li><p><strong>sfs_sel</strong> (<a class="reference internal" href="spectra.html#fastdfe.spectrum.Spectra" title="fastdfe.spectrum.Spectra"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectra</span></code></a> | <a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – The selected SFS. Note that we require monomorphic counts to be specified in order to infer
the mutation rate. If a <code class="docutils literal notranslate"><span class="pre">Spectra</span></code> object with more than one SFS is provided, the <code class="docutils literal notranslate"><span class="pre">all</span></code> attribute will be
used.</p></li>
<li><p><strong>intervals_del</strong> ((<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)) – <code class="docutils literal notranslate"><span class="pre">(start,</span> <span class="pre">stop,</span> <span class="pre">n_interval)</span></code> for deleterious population-scaled
selection coefficients. The intervals will be log10-spaced.</p></li>
<li><p><strong>integration_mode</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'midpoint'</span></code>, <code class="docutils literal notranslate"><span class="pre">'quad'</span></code>]) – Integration mode for the DFE, <code class="docutils literal notranslate"><span class="pre">quad</span></code> not recommended</p></li>
<li><p><strong>linearized</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the linearized DFE, <code class="docutils literal notranslate"><span class="pre">False</span></code> not recommended</p></li>
<li><p><strong>intervals_ben</strong> ((<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)) – Same as for intervals_del but for beneficial selection coefficients.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="parametrization.html#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Instance of DFEParametrization which parametrized the DFE</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Seed for the random number generator. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> for no seed.</p></li>
<li><p><strong>x0</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Dictionary of initial values in the form <code class="docutils literal notranslate"><span class="pre">{'all':</span> <span class="pre">{param:</span> <span class="pre">value}}</span></code></p></li>
<li><p><strong>bounds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Bounds for the optimization in the form <code class="docutils literal notranslate"><span class="pre">{param:</span> <span class="pre">(lower,</span> <span class="pre">upper)}</span></code></p></li>
<li><p><strong>scales</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>, <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code>]]) – Scales for the optimization in the form <a href="#id1"><span class="problematic" id="id2">``</span></a>{param: scale}`</p></li>
<li><p><strong>loss_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'likelihood'</span></code>, <code class="docutils literal notranslate"><span class="pre">'L2'</span></code>]) – Type of loss function to use for optimization.</p></li>
<li><p><strong>opts_mle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Options for the optimization.</p></li>
<li><p><strong>n_runs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of independent optimization runs out of which the best one is chosen. The first run
will use the initial values if specified. Consider increasing this number if the optimization does not
produce good results.</p></li>
<li><p><strong>fixed_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Parameters held fixed when optimization, i.e., <code class="docutils literal notranslate"><span class="pre">{'all':</span> <span class="pre">{param:</span> <span class="pre">value}}</span></code></p></li>
<li><p><strong>do_bootstrap</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to do bootstrapping.</p></li>
<li><p><strong>n_bootstraps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of bootstraps.</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to parallelize the bootstrapping.</p></li>
<li><p><strong>folded</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – Whether the SFS are folded. If not specified, the SFS will be folded if both of the given
SFS appear to be folded.</p></li>
<li><p><strong>discretization</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code>]) – Discretization instance. Mainly intended for internal use.</p></li>
<li><p><strong>optimization</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Optimization</span></code>]) – Optimization instance. Mainly intended for internal use.</p></li>
<li><p><strong>locked</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to lock the instance.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments which are ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.sfs_neut">
<span class="sig-name descname"><span class="pre">sfs_neut</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.sfs_neut" title="Permalink to this definition"></a></dt>
<dd><p>Neutral SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.sfs_sel">
<span class="sig-name descname"><span class="pre">sfs_sel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.sfs_sel" title="Permalink to this definition"></a></dt>
<dd><p>Selected SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="parametrization.html#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.model" title="Permalink to this definition"></a></dt>
<dd><p>The DFE parametrization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.folded">
<span class="sig-name descname"><span class="pre">folded</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.folded" title="Permalink to this definition"></a></dt>
<dd><p>Whether the SFS are folded</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.n">
<span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.n" title="Permalink to this definition"></a></dt>
<dd><p>Sample size</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.discretization">
<span class="sig-name descname"><span class="pre">discretization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Discretization</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.discretization" title="Permalink to this definition"></a></dt>
<dd><p>Discretization instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.theta">
<span class="sig-name descname"><span class="pre">theta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.theta" title="Permalink to this definition"></a></dt>
<dd><p>Estimate of theta from neutral SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.params_mle">
<span class="sig-name descname"><span class="pre">params_mle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.params_mle" title="Permalink to this definition"></a></dt>
<dd><p>MLE estimates of the initial optimization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.sfs_mle">
<span class="sig-name descname"><span class="pre">sfs_mle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.sfs_mle" title="Permalink to this definition"></a></dt>
<dd><p>Modelled MLE SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Likelihood of the MLE, this value may be updated after bootstrapping</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.likelihoods">
<span class="sig-name descname"><span class="pre">likelihoods</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Likelihoods of the different ML runs, controlled by <code class="docutils literal notranslate"><span class="pre">n_runs</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.n_runs">
<span class="sig-name descname"><span class="pre">n_runs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.n_runs" title="Permalink to this definition"></a></dt>
<dd><p>Number of MLE runs to perform</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.result">
<span class="sig-name descname"><span class="pre">result</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.result" title="Permalink to this definition"></a></dt>
<dd><p>Numerical optimization result</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.do_bootstrap">
<span class="sig-name descname"><span class="pre">do_bootstrap</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.do_bootstrap" title="Permalink to this definition"></a></dt>
<dd><p>Whether to do bootstrapping</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.n_bootstraps">
<span class="sig-name descname"><span class="pre">n_bootstraps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.n_bootstraps" title="Permalink to this definition"></a></dt>
<dd><p>Number of bootstraps</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.parallelize">
<span class="sig-name descname"><span class="pre">parallelize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.parallelize" title="Permalink to this definition"></a></dt>
<dd><p>Whether to parallelize the bootstrapping</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.fixed_params">
<span class="sig-name descname"><span class="pre">fixed_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.fixed_params" title="Permalink to this definition"></a></dt>
<dd><p>Fixed parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.scales">
<span class="sig-name descname"><span class="pre">scales</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'lin'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'log'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.scales" title="Permalink to this definition"></a></dt>
<dd><p>parameter scales</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.bounds" title="Permalink to this definition"></a></dt>
<dd><p>parameter bounds</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.optimization">
<span class="sig-name descname"><span class="pre">optimization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimization</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.optimization" title="Permalink to this definition"></a></dt>
<dd><p>Optimization instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.x0" title="Permalink to this definition"></a></dt>
<dd><p>Initial values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.bootstraps">
<span class="sig-name descname"><span class="pre">bootstraps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.bootstraps" title="Permalink to this definition"></a></dt>
<dd><p>Bootstrapped MLE parameter estimates</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.bootstrap_results">
<span class="sig-name descname"><span class="pre">bootstrap_results</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.bootstrap_results" title="Permalink to this definition"></a></dt>
<dd><p>Bootstrap optimization results</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.L2_residual">
<span class="sig-name descname"><span class="pre">L2_residual</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.L2_residual" title="Permalink to this definition"></a></dt>
<dd><p>L2 norm of fit minus observed SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.seed" title="Permalink to this definition"></a></dt>
<dd><p>Random number generator seed</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.rng">
<span class="sig-name descname"><span class="pre">rng</span></span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.rng" title="Permalink to this definition"></a></dt>
<dd><p>Random generator instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.execution_time">
<span class="sig-name descname"><span class="pre">execution_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.execution_time" title="Permalink to this definition"></a></dt>
<dd><p>Total execution time in seconds</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.locked">
<span class="sig-name descname"><span class="pre">locked</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.locked" title="Permalink to this definition"></a></dt>
<dd><p>Whether inferences can be run from the class itself</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_fixed_param_names">
<span class="sig-name descname"><span class="pre">get_fixed_param_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_fixed_param_names" title="Permalink to this definition"></a></dt>
<dd><p>Get the names of the fixed parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.check_fixed_params_exist">
<span class="sig-name descname"><span class="pre">check_fixed_params_exist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.check_fixed_params_exist" title="Permalink to this definition"></a></dt>
<dd><p>Check that the fixed parameters are valid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.raise_if_locked">
<span class="sig-name descname"><span class="pre">raise_if_locked</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.raise_if_locked" title="Permalink to this definition"></a></dt>
<dd><p>Raise an error if this object is locked.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.run_if_required">
<span class="sig-name descname"><span class="pre">run_if_required</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.run_if_required" title="Permalink to this definition"></a></dt>
<dd><p>Run if not run yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Arguments.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DFE parametrization and modelled SFS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.run_if_required_wrapper">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_if_required_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.run_if_required_wrapper" title="Permalink to this definition"></a></dt>
<dd><p>Decorator to run inference if required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> – Function to decorate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decorated function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.run" title="Permalink to this definition"></a></dt>
<dd><p>Perform the DFE inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pbar</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – Whether to show a progress bar.</p></li>
<li><p><strong>do_bootstrap</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – Whether to perform bootstrapping.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Modelled SFS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_counts">
<span class="sig-name descname"><span class="pre">get_counts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_counts" title="Permalink to this definition"></a></dt>
<dd><p>Get callback functions for modelling SFS counts from given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Callback functions for modelling SFS counts for each type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.evaluate_likelihood">
<span class="sig-name descname"><span class="pre">evaluate_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.evaluate_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate likelihood function at given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Parameters indexed by type and parameter name.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The likelihood.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.assign_result">
<span class="sig-name descname"><span class="pre">assign_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">scipy.optimize._optimize.OptimizeResult</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_mle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.assign_result" title="Permalink to this definition"></a></dt>
<dd><p>Assign optimization result and MLE parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_mle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – MLE parameters.</p></li>
<li><p><strong>result</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code>) – Optimization result.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.report_result">
<span class="sig-name descname"><span class="pre">report_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">scipy.optimize._optimize.OptimizeResult</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.report_result" title="Permalink to this definition"></a></dt>
<dd><p>Inform on optimization result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – MLE parameters.</p></li>
<li><p><strong>result</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code>) – Optimization result.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.update_properties">
<span class="sig-name descname"><span class="pre">update_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.update_properties" title="Permalink to this definition"></a></dt>
<dd><p>Update the properties of this class with the given dictionary
given that its entries are not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Dictionary of properties to update.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.bootstrap">
<span class="sig-name descname"><span class="pre">bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.bootstrap" title="Permalink to this definition"></a></dt>
<dd><p>Perform the parametric bootstrap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Number of bootstrap samples.</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – Whether to parallelize the bootstrap.</p></li>
<li><p><strong>update_likelihood</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to update the likelihood to be the mean of the bootstrap samples.</p></li>
<li><p><strong>pbar</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show a progress bar.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dataframe with bootstrap results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.add_alpha_to_bootstraps">
<span class="sig-name descname"><span class="pre">add_alpha_to_bootstraps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.add_alpha_to_bootstraps" title="Permalink to this definition"></a></dt>
<dd><p>Add estimates for alpha to the bootstraps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.resample_sfs">
<span class="sig-name descname"><span class="pre">resample_sfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><span class="pre">fastdfe.spectrum.Spectrum</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.resample_sfs" title="Permalink to this definition"></a></dt>
<dd><p>Resample SFS assuming independent Poisson counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfs</strong> (<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – Spectrum to resample.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Seed for random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Resampled spectrum.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.run_bootstrap_sample">
<span class="sig-name descname"><span class="pre">run_bootstrap_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.run_bootstrap_sample" title="Permalink to this definition"></a></dt>
<dd><p>Resample the observed selected SFS and rerun the optimization procedure.
We take the MLE params as initial params here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Seed for random number generator.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optimization result and MLE parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_scales_linear">
<span class="sig-name descname"><span class="pre">get_scales_linear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_scales_linear" title="Permalink to this definition"></a></dt>
<dd><p>Get linear scales for all parameters. We do this for the bootstraps as x0 should be close to MLE.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of scales.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_bounds_linear">
<span class="sig-name descname"><span class="pre">get_bounds_linear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_bounds_linear" title="Permalink to this definition"></a></dt>
<dd><p>Get linear bounds for all parameters. We do this for the bootstraps as x0 should be close to MLE.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of bounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.model_sfs">
<span class="sig-name descname"><span class="pre">model_sfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_neut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><span class="pre">fastdfe.spectrum.Spectrum</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_sel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><span class="pre">fastdfe.spectrum.Spectrum</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.model_sfs" title="Permalink to this definition"></a></dt>
<dd><p>Model the selected SFS from the given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfs_sel</strong> (<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – Observed spectrum of selected sites.</p></li>
<li><p><strong>sfs_neut</strong> (<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – Observed spectrum of neutral sites.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Dictionary of parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of modelled and observed counts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.adjust_polarization">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjust_polarization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.adjust_polarization" title="Permalink to this definition"></a></dt>
<dd><p>Adjust the polarization of the given SFS where
eps is the rate of ancestral misidentification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Polymorphic SFS counts to adjust.</p></li>
<li><p><strong>eps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Rate of ancestral misidentification.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adjusted SFS counts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.add_demography">
<span class="sig-name descname"><span class="pre">add_demography</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs_neut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><span class="pre">fastdfe.spectrum.Spectrum</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">counts_sel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.add_demography" title="Permalink to this definition"></a></dt>
<dd><p>Add the effect of demography to counts_sel by considering
how counts_neut is perturbed relative to the standard coalescent.
The polarization error is also included here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfs_neut</strong> (<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – Observed spectrum of neutral sites.</p></li>
<li><p><strong>counts_sel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Modelled counts of selected sites.</p></li>
<li><p><strong>eps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Rate of ancestral misidentification.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adjusted counts of selected sites.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_continuous">
<span class="sig-name descname"><span class="pre">plot_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'symlog'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'DFE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_continuous" title="Permalink to this definition"></a></dt>
<dd><p>Plot continuous DFE.
The special constants np.inf and -np.inf are also valid interval bounds.
By default, the PDF is plotted as is. Due to the logarithmic scale on
the x-axis, we may get a wrong intuition on how the mass is distributed,
however. To get a better intuition, we can optionally scale the density
by the x-axis interval size using <code class="docutils literal notranslate"><span class="pre">scale_density</span> <span class="pre">=</span> <span class="pre">True</span></code>. This has the
disadvantage that the density now changes for x, so that even a constant
density will look warped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use for confidence intervals.</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level for confidence intervals.</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to plot confidence intervals.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>, <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code>]) – y-scale</p></li>
<li><p><strong>scale_density</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to scale the density by the x-axis interval size</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_bucket_sizes">
<span class="sig-name descname"><span class="pre">plot_bucket_sizes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'bucket</span> <span class="pre">sizes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_bucket_sizes" title="Permalink to this definition"></a></dt>
<dd><p>Plot mass in each bucket for the MLE DFE.
This can be used to check if the interval bounds and spacing
are chosen appropriately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_interval_density">
<span class="sig-name descname"><span class="pre">plot_interval_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_interval_density" title="Permalink to this definition"></a></dt>
<dd><p>Plot density of the discretization intervals chosen. Note that although this plot looks similar, this is
not the DFE!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Color of the bars.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>interval_labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for the intervals.</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_sfs_comparison">
<span class="sig-name descname"><span class="pre">plot_sfs_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'modelled'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'observed'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'neutral'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['modelled',</span> <span class="pre">'observed']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'SFS</span> <span class="pre">comparison'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_subplots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_monomorphic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_sfs_comparison" title="Permalink to this definition"></a></dt>
<dd><p>Plot SFS comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for the SFS.</p></li>
<li><p><strong>sfs_types</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'modelled'</span></code>, <code class="docutils literal notranslate"><span class="pre">'observed'</span></code>, <code class="docutils literal notranslate"><span class="pre">'neutral'</span></code>]]) – Types of SFS to plot.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title</p></li>
<li><p><strong>use_subplots</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use subplots</p></li>
<li><p><strong>show_monomorphic</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show monomorphic counts</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_observed_sfs">
<span class="sig-name descname"><span class="pre">plot_observed_sfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_observed_sfs" title="Permalink to this definition"></a></dt>
<dd><p>Plot neutral and selected SFS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for the SFS.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_all">
<span class="sig-name descname"><span class="pre">plot_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_all" title="Permalink to this definition"></a></dt>
<dd><p>Plot a bunch of plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_errors_discretized_dfe">
<span class="sig-name descname"><span class="pre">get_errors_discretized_dfe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_errors_discretized_dfe" title="Permalink to this definition"></a></dt>
<dd><p>Get the discretized DFE errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence interval level.</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Arrays of errors, confidence intervals, bootstraps, means and values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_inferred_parameters">
<span class="sig-name descname"><span class="pre">plot_inferred_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'parameter</span> <span class="pre">estimates'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'symlog'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'loc':</span> <span class="pre">'upper</span> <span class="pre">right',</span> <span class="pre">'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_inferred_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Visualize the inferred parameters and their confidence intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>, <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code>]) – y-scale of the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show the legend.</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show confidence intervals.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use.</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level for the confidence intervals.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_inferred_parameters_boxplot">
<span class="sig-name descname"><span class="pre">plot_inferred_parameters_boxplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'parameter</span> <span class="pre">estimates'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_inferred_parameters_boxplot" title="Permalink to this definition"></a></dt>
<dd><p>Visualize the inferred parameters and their confidence intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no inference objects are given or no bootstraps are found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_likelihoods">
<span class="sig-name descname"><span class="pre">plot_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'likelihoods'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Visualize the likelihoods of the optimization runs using a scatter plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>]) – y-scale of the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.lrt">
<span class="sig-name descname"><span class="pre">lrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ll_simple</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ll_complex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.lrt" title="Permalink to this definition"></a></dt>
<dd><p>Perform the likelihood ratio test (LRT).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ll_simple</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Log-likelihood of the simple model.</p></li>
<li><p><strong>ll_complex</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Log-likelihood of the complex model.</p></li>
<li><p><strong>df</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Degrees of freedom.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>p-value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.compare_nested_likelihoods">
<span class="sig-name descname"><span class="pre">compare_nested_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">complex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><span class="pre">fastdfe.base_inference.BaseInference</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.compare_nested_likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Perform likelihood ratio test with given more complex model.
The given model’s fixed parameters need to be a proper
subset of this model’s fixed parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>complex</strong> (<a class="reference internal" href="#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseInference</span></code></a>) – More complex model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>p-value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.compare_nested_models">
<span class="sig-name descname"><span class="pre">compare_nested_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.compare_nested_models" title="Permalink to this definition"></a></dt>
<dd><p>Compare the various nested versions of the specified
model using likelihood ratio tests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>do_bootstrap</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to perform bootstrapping. This is recommended to get more accurate p-values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, BaseInference])</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Matrix of p-values, dict of base inference objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_nested_likelihoods">
<span class="sig-name descname"><span class="pre">plot_nested_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_empty</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nested</span> <span class="pre">model</span> <span class="pre">comparison'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_nested_likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Plot the p-values of nested likelihoods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>remove_empty</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to remove empty rows and columns.</p></li>
<li><p><strong>transpose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to transpose the matrix.</p></li>
<li><p><strong>cmap</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Colormap to use.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
<li><p><strong>do_bootstrap</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to perform bootstrapping. This is recommended to get more accurate p-values.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.plot_discretized">
<span class="sig-name descname"><span class="pre">plot_discretized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'discretized</span> <span class="pre">DFE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.plot_discretized" title="Permalink to this definition"></a></dt>
<dd><p>Plot discretized DFE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of the plot</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence interval level</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to plot confidence intervals</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save the plot to</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show the plot</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bars.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes to plot to</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_alpha">
<span class="sig-name descname"><span class="pre">get_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_alpha" title="Permalink to this definition"></a></dt>
<dd><p>Get alpha, the proportion of beneficial non-synonymous substitutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – Parameters to use for calculation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.alpha">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alpha</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.alpha" title="Permalink to this definition"></a></dt>
<dd><p>Cache alpha, the proportion of beneficial non-synonymous substitutions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_bootstrap_params">
<span class="sig-name descname"><span class="pre">get_bootstrap_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_bootstrap_params" title="Permalink to this definition"></a></dt>
<dd><p>Get the parameters to be included in the bootstraps.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters to be included in the bootstraps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_bootstrap_param_names">
<span class="sig-name descname"><span class="pre">get_bootstrap_param_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_bootstrap_param_names" title="Permalink to this definition"></a></dt>
<dd><p>Get the parameters to be included in the bootstraps.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters to be included in the bootstraps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_optimized_param_names">
<span class="sig-name descname"><span class="pre">get_optimized_param_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_optimized_param_names" title="Permalink to this definition"></a></dt>
<dd><p>Get the parameters names for the parameters that are optimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of parameter names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_n_optimized">
<span class="sig-name descname"><span class="pre">get_n_optimized</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_n_optimized" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of parameters that are optimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of parameters that are optimized.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.create_config">
<span class="sig-name descname"><span class="pre">create_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.create_config" title="Permalink to this definition"></a></dt>
<dd><p>Create a config object from the inference object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="config.html#fastdfe.config.Config" title="fastdfe.config.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Config object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="config.html#fastdfe.config.Config" title="fastdfe.config.Config"><span class="pre">fastdfe.config.Config</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.from_config" title="Permalink to this definition"></a></dt>
<dd><p>Load from config object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="config.html#fastdfe.config.Config" title="fastdfe.config.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a>) – Config object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Inference object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.from_config_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.from_config_file" title="Permalink to this definition"></a></dt>
<dd><p>Load from config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Config file path.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Inference object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_summary">
<span class="sig-name descname"><span class="pre">get_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_summary" title="Permalink to this definition"></a></dt>
<dd><p>Get summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceResults</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inference results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_x0">
<span class="sig-name descname"><span class="pre">get_x0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_x0" title="Permalink to this definition"></a></dt>
<dd><p>Get initial values.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initial values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.param_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fastdfe.base_inference.BaseInference.param_names" title="Permalink to this definition"></a></dt>
<dd><p>Parameter names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of parameter names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.to_json" title="Permalink to this definition"></a></dt>
<dd><p>Serialize object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JSON string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Load object from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classes</strong> – Classes to be used for unserialization</p></li>
<li><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File to load from</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.from_json">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.from_json" title="Permalink to this definition"></a></dt>
<dd><p>Unserialize object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classes</strong> – Classes to be used for unserialization</p></li>
<li><p><strong>json</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – JSON string</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_cis_params_mle">
<span class="sig-name descname"><span class="pre">get_cis_params_mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_cis_params_mle" title="Permalink to this definition"></a></dt>
<dd><p>Get confidence intervals for the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence interval level</p></li>
<li><p><strong>param_names</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Names of the parameters to return confidence intervals for</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Confidence intervals for the parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.get_discretized">
<span class="sig-name descname"><span class="pre">get_discretized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.get_discretized" title="Permalink to this definition"></a></dt>
<dd><p>Get discretized DFE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence interval level</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return confidence intervals</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of values and array of errors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.base_inference.BaseInference.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.base_inference.BaseInference.to_file" title="Permalink to this definition"></a></dt>
<dd><p>Save object to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File to save to</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fastdfe.joint_inference.</span></span><span class="sig-name descname"><span class="pre">JointInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs_neut:</span> <span class="pre">fastdfe.spectrum.Spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_sel:</span> <span class="pre">fastdfe.spectrum.Spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_divergence:</span> <span class="pre">typing.Optional[bool]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_del:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(-100000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_ben:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_mode:</span> <span class="pre">typing.Literal['midpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'quad']</span> <span class="pre">=</span> <span class="pre">'midpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linearized:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">fastdfe.parametrization.Parametrization</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'GammaExpParametrization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Tuple[float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Literal['lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'symlog']]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type:</span> <span class="pre">typing.Literal['likelihood'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'L2']</span> <span class="pre">=</span> <span class="pre">'likelihood'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opts_mle:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_params:</span> <span class="pre">typing.List[fastdfe.optimization.SharedParams]</span> <span class="pre">=</span> <span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariates:</span> <span class="pre">typing.List[fastdfe.optimization.Covariate]</span> <span class="pre">=</span> <span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_bootstrap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstraps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded:</span> <span class="pre">typing.Optional[bool]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseInference</span></code></a></p>
<p>Enabling the sharing of parameters among several Inference objects.</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastdfe</span> <span class="kn">import</span> <span class="n">JointInference</span><span class="p">,</span> <span class="n">Spectra</span><span class="p">,</span> <span class="n">SharedParams</span>

<span class="c1"># neutral SFS for two types</span>
<span class="n">sfs_neut</span> <span class="o">=</span> <span class="n">Spectra</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">pendula</span><span class="o">=</span><span class="p">[</span><span class="mi">177130</span><span class="p">,</span> <span class="mi">997</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">652</span><span class="p">],</span>
    <span class="n">pubescens</span><span class="o">=</span><span class="p">[</span><span class="mi">172528</span><span class="p">,</span> <span class="mi">3612</span><span class="p">,</span> <span class="mi">1359</span><span class="p">,</span> <span class="mi">790</span><span class="p">,</span> <span class="mi">584</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">325</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">31</span><span class="p">]</span>
<span class="p">))</span>

<span class="c1"># selected SFS for two types</span>
<span class="n">sfs_sel</span> <span class="o">=</span> <span class="n">Spectra</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">pendula</span><span class="o">=</span><span class="p">[</span><span class="mi">797939</span><span class="p">,</span> <span class="mi">1329</span><span class="p">,</span> <span class="mi">499</span><span class="p">,</span> <span class="mi">265</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">794</span><span class="p">],</span>
    <span class="n">pubescens</span><span class="o">=</span><span class="p">[</span><span class="mi">791106</span><span class="p">,</span> <span class="mi">5326</span><span class="p">,</span> <span class="mi">1741</span><span class="p">,</span> <span class="mi">1005</span><span class="p">,</span> <span class="mi">756</span><span class="p">,</span> <span class="mi">546</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">41</span><span class="p">]</span>
<span class="p">))</span>

<span class="c1"># create inference object</span>
<span class="n">inf</span> <span class="o">=</span> <span class="n">JointInference</span><span class="p">(</span>
    <span class="n">sfs_neut</span><span class="o">=</span><span class="n">sfs_neut</span><span class="p">,</span>
    <span class="n">sfs_sel</span><span class="o">=</span><span class="n">sfs_sel</span><span class="p">,</span>
    <span class="n">fixed_params</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="c1"># fix eps to 0</span>
    <span class="n">do_bootstrap</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># run inference</span>
<span class="n">inf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs_neut:</span> <span class="pre">fastdfe.spectrum.Spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_sel:</span> <span class="pre">fastdfe.spectrum.Spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_divergence:</span> <span class="pre">typing.Optional[bool]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_del:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(-100000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_ben:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_mode:</span> <span class="pre">typing.Literal['midpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'quad']</span> <span class="pre">=</span> <span class="pre">'midpoint'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linearized:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">fastdfe.parametrization.Parametrization</span> <span class="pre">|</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'GammaExpParametrization'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Tuple[float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Literal['lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'symlog']]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type:</span> <span class="pre">typing.Literal['likelihood'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'L2']</span> <span class="pre">=</span> <span class="pre">'likelihood'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opts_mle:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params:</span> <span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float]]</span> <span class="pre">=</span> <span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_params:</span> <span class="pre">typing.List[fastdfe.optimization.SharedParams]</span> <span class="pre">=</span> <span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariates:</span> <span class="pre">typing.List[fastdfe.optimization.Covariate]</span> <span class="pre">=</span> <span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_bootstrap:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstraps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folded:</span> <span class="pre">typing.Optional[bool]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfs_neut</strong> (<a class="reference internal" href="spectra.html#fastdfe.spectrum.Spectra" title="fastdfe.spectrum.Spectra"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectra</span></code></a>) – Neutral SFS. Note that we require monomorphic counts to be specified in order to infer
the mutation rate.</p></li>
<li><p><strong>sfs_sel</strong> (<a class="reference internal" href="spectra.html#fastdfe.spectrum.Spectra" title="fastdfe.spectrum.Spectra"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectra</span></code></a>) – Selected SFS. Note that we require monomorphic counts to be specified in order to infer
the mutation rate.</p></li>
<li><p><strong>include_divergence</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – Whether to include divergence in the likelihood</p></li>
<li><p><strong>intervals_del</strong> ((<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)) – <code class="docutils literal notranslate"><span class="pre">(start,</span> <span class="pre">stop,</span> <span class="pre">n_interval)</span></code> for deleterious population-scaled
selection coefficients. The intervals will be log10-spaced.</p></li>
<li><p><strong>intervals_ben</strong> ((<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)) – Same as intervals_del but for beneficial selection coefficients</p></li>
<li><p><strong>integration_mode</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'midpoint'</span></code>, <code class="docutils literal notranslate"><span class="pre">'quad'</span></code>]) – Integration mode, <code class="docutils literal notranslate"><span class="pre">quad</span></code> not recommended</p></li>
<li><p><strong>linearized</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the linearized model, <code class="docutils literal notranslate"><span class="pre">False</span></code> not recommended</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="parametrization.html#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – DFE parametrization</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Random seed. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> for no seed.</p></li>
<li><p><strong>x0</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Dictionary of initial values in the form <code class="docutils literal notranslate"><span class="pre">{type:</span> <span class="pre">{param:</span> <span class="pre">value}}</span></code></p></li>
<li><p><strong>bounds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Bounds for the optimization in the form {param: (lower, upper)}</p></li>
<li><p><strong>scales</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>, <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code>]]) – Scales for the optimization in the form {param: scale}</p></li>
<li><p><strong>loss_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'likelihood'</span></code>, <code class="docutils literal notranslate"><span class="pre">'L2'</span></code>]) – Loss type</p></li>
<li><p><strong>opts_mle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Options for the optimization</p></li>
<li><p><strong>n_runs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of independent optimization runs out of which the best one is chosen. The first run
will use the initial values if specified. Consider increasing this number if the optimization does not
produce good results.</p></li>
<li><p><strong>fixed_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Dictionary of fixed parameters in the form <code class="docutils literal notranslate"><span class="pre">{type:</span> <span class="pre">{param:</span> <span class="pre">value}}</span></code></p></li>
<li><p><strong>shared_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="#fastdfe.optimization.SharedParams" title="fastdfe.optimization.SharedParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">SharedParams</span></code></a>]) – List of shared parameters</p></li>
<li><p><strong>do_bootstrap</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to perform bootstrapping</p></li>
<li><p><strong>n_bootstraps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of bootstraps</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to parallelize the optimization</p></li>
<li><p><strong>folded</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – Whether the SFS are folded. If not specified, the SFS will be folded if all of the given
SFS appear to be folded.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments which are ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.types">
<span class="sig-name descname"><span class="pre">types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List[str]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.types" title="Permalink to this definition"></a></dt>
<dd><p>SFS types</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.params_mle_raw">
<span class="sig-name descname"><span class="pre">params_mle_raw</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[Dict[str,</span> <span class="pre">Dict[str,</span> <span class="pre">float]]]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.params_mle_raw" title="Permalink to this definition"></a></dt>
<dd><p>original MLE parameters before adding covariates and unpacked shared</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.shared_params">
<span class="sig-name descname"><span class="pre">shared_params</span></span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.shared_params" title="Permalink to this definition"></a></dt>
<dd><p>Shared parameters with expanded ‘all’ type</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.covariates">
<span class="sig-name descname"><span class="pre">covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict[str,</span> <span class="pre">Covariate]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.covariates" title="Permalink to this definition"></a></dt>
<dd><p>Covariates indexed by parameter name</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.x0_cov">
<span class="sig-name descname"><span class="pre">x0_cov</span></span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.x0_cov" title="Permalink to this definition"></a></dt>
<dd><p>Initial values for covariates</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.fixed_params">
<span class="sig-name descname"><span class="pre">fixed_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict[str,</span> <span class="pre">Dict[str,</span> <span class="pre">float]]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.fixed_params" title="Permalink to this definition"></a></dt>
<dd><p>fixed parameters with expanded ‘all’ type</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.marginal_inferences">
<span class="sig-name descname"><span class="pre">marginal_inferences</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict[str,</span> <span class="pre">BaseInference]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.marginal_inferences" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of marginal inferences indexed by type</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.scales">
<span class="sig-name descname"><span class="pre">scales</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict[str,</span> <span class="pre">Literal['lin',</span> <span class="pre">'log',</span> <span class="pre">'symlog']]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.scales" title="Permalink to this definition"></a></dt>
<dd><p>parameter scales</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict[str,</span> <span class="pre">Tuple[float,</span> <span class="pre">float]]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.bounds" title="Permalink to this definition"></a></dt>
<dd><p>parameter bounds</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.optimization">
<span class="sig-name descname"><span class="pre">optimization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optimization</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.optimization" title="Permalink to this definition"></a></dt>
<dd><p>Joint optimization instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.joint_inferences">
<span class="sig-name descname"><span class="pre">joint_inferences</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict[str,</span> <span class="pre">BaseInference]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.joint_inferences" title="Permalink to this definition"></a></dt>
<dd><p>Joint inference object indexed by type</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.check_shared_params">
<span class="sig-name descname"><span class="pre">check_shared_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.check_shared_params" title="Permalink to this definition"></a></dt>
<dd><p>Check if the shared parameters were specified correctly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.check_no_shared_params_fixed">
<span class="sig-name descname"><span class="pre">check_no_shared_params_fixed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.check_no_shared_params_fixed" title="Permalink to this definition"></a></dt>
<dd><p>Check that no shared parameters are fixed and raise an error otherwise.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_shared_param_names">
<span class="sig-name descname"><span class="pre">get_shared_param_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_shared_param_names" title="Permalink to this definition"></a></dt>
<dd><p>Get the names of the shared parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Names of the shared parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.add_covariates_as_shared">
<span class="sig-name descname"><span class="pre">add_covariates_as_shared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covariates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fastdfe.optimization.Covariate" title="fastdfe.optimization.Covariate"><span class="pre">fastdfe.optimization.Covariate</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.add_covariates_as_shared" title="Permalink to this definition"></a></dt>
<dd><p>Add covariates as shared parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>covariates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="#fastdfe.optimization.Covariate" title="fastdfe.optimization.Covariate"><code class="xref py py-class docutils literal notranslate"><span class="pre">Covariate</span></code></a>]) – List of covariates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.determine_unshared_covariates">
<span class="sig-name descname"><span class="pre">determine_unshared_covariates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covariates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.determine_unshared_covariates" title="Permalink to this definition"></a></dt>
<dd><p>Determine which covariates are not shared.
:type covariates: 
:param covariates:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.run" title="Permalink to this definition"></a></dt>
<dd><p>Run inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional keyword arguments</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Modelled SFS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.run_marginal">
<span class="sig-name descname"><span class="pre">run_marginal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.run_marginal" title="Permalink to this definition"></a></dt>
<dd><p>Run marginal optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict of marginal inferences indexed by type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.marginals_without_all">
<span class="sig-name descname"><span class="pre">marginals_without_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.marginals_without_all" title="Permalink to this definition"></a></dt>
<dd><p>Get marginal inference without ‘all’ type.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <a class="reference internal" href="#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseInference</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict of marginal inferences indexed by type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.run_joint">
<span class="sig-name descname"><span class="pre">run_joint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.run_joint" title="Permalink to this definition"></a></dt>
<dd><p>Run joint optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modelled SFS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.joint_inference_makes_sense">
<span class="sig-name descname"><span class="pre">joint_inference_makes_sense</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.joint_inference_makes_sense" title="Permalink to this definition"></a></dt>
<dd><p>Check if joint inference makes sense.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether joint inference makes sense.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_counts">
<span class="sig-name descname"><span class="pre">get_counts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_counts" title="Permalink to this definition"></a></dt>
<dd><p>Get callback functions for modelling SFS counts from given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict of callback functions indexed by type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.run_joint_without_covariates">
<span class="sig-name descname"><span class="pre">run_joint_without_covariates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.run_joint_without_covariates" title="Permalink to this definition"></a></dt>
<dd><p>Run joint inference without covariates. Note that the result of this function is cached.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#fastdfe.joint_inference.JointInference" title="fastdfe.joint_inference.JointInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">JointInference</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Joint inference instance devoid of covariates.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.create_config">
<span class="sig-name descname"><span class="pre">create_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.create_config" title="Permalink to this definition"></a></dt>
<dd><p>Create a config object from the inference object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="config.html#fastdfe.config.Config" title="fastdfe.config.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Config object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.perform_lrt_covariates">
<span class="sig-name descname"><span class="pre">perform_lrt_covariates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.perform_lrt_covariates" title="Permalink to this definition"></a></dt>
<dd><p>Perform likelihood ratio test against joint inference without covariates.
In the simple model we share parameters across types. Low p-values indicate that
the covariates provide a significant improvement in the fit.</p>
<p>To access the JointInference object without covariates, you can call <a class="reference internal" href="#fastdfe.joint_inference.JointInference.run_joint_without_covariates" title="fastdfe.joint_inference.JointInference.run_joint_without_covariates"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_joint_without_covariates()</span></code></a>,
which is cached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>do_bootstrap</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to bootstrap. This improves the accuracy of the p-value. Note
that if bootstrapping was performed previously without updating the likelihood, this won’t have any effect.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Likelihood ratio test statistic.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.add_covariates">
<span class="sig-name descname"><span class="pre">add_covariates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.add_covariates" title="Permalink to this definition"></a></dt>
<dd><p>Add covariates to parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Dict of parameters</p></li>
<li><p><strong>type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – SFS type</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict of parameters with covariates added</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.bootstrap">
<span class="sig-name descname"><span class="pre">bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.bootstrap" title="Permalink to this definition"></a></dt>
<dd><p>Perform the parametric bootstrap both for the marginal and joint inferences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Number of bootstrap samples</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]) – Whether to parallelize computations</p></li>
<li><p><strong>update_likelihood</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to update the likelihood</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame with bootstrap samples</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.bootstrap_if_required">
<span class="sig-name descname"><span class="pre">bootstrap_if_required</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.bootstrap_if_required" title="Permalink to this definition"></a></dt>
<dd><p>Bootstrap if not done yet.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.run_joint_bootstrap_sample">
<span class="sig-name descname"><span class="pre">run_joint_bootstrap_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.run_joint_bootstrap_sample" title="Permalink to this definition"></a></dt>
<dd><p>Resample the observed selected SFS and rerun the optimization procedure.
We take the MLE params as initial params here.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Optimization result and dictionary of MLE params</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_x0">
<span class="sig-name descname"><span class="pre">get_x0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_x0" title="Permalink to this definition"></a></dt>
<dd><p>Get initial values for joint inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of initial values indexed by type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.perform_lrt_shared">
<span class="sig-name descname"><span class="pre">perform_lrt_shared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.perform_lrt_shared" title="Permalink to this definition"></a></dt>
<dd><p>Compare likelihood of joint inference with product of marginal likelihoods.
This provides information about the goodness of fit achieved by the parameter sharing.
Low p-values indicate that parameter sharing is not justified, i.e., that the marginal
inferences provide a better fit to the data. Note that it is more difficult to properly
optimize the joint likelihood, which makes this test conservative, i.e., the reported p-value
might be larger than what it really is.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>do_bootstrap</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to perform bootstrapping. This improves the accuracy of the p-value. Note
that if bootstrapping was performed previously without updating the likelihood, this won’t have any effect.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>p-value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_inferences">
<span class="sig-name descname"><span class="pre">get_inferences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_inferences" title="Permalink to this definition"></a></dt>
<dd><p>Get all inference objects as dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <a class="reference internal" href="#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseInference</span></code></a>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of base inference objects indexed by type and joint vs marginal subtypes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_discretized">
<span class="sig-name descname"><span class="pre">plot_discretized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file:</span> <span class="pre">typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals:</span> <span class="pre">numpy.ndarray</span> <span class="pre">=</span> <span class="pre">array([</span> <span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-100.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-10.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-1.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type:</span> <span class="pre">typing.Literal['percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'bca']</span> <span class="pre">=</span> <span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_del:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(-100000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">-1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals_ben:</span> <span class="pre">(&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'int'&gt;)</span> <span class="pre">=</span> <span class="pre">(1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'discretized</span> <span class="pre">DFE</span> <span class="pre">comparison'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels:</span> <span class="pre">typing.Optional[typing.List[str]]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend:</span> <span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax:</span> <span class="pre">typing.Optional[matplotlib.axes._axes.Axes]</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_discretized" title="Permalink to this definition"></a></dt>
<dd><p>Plot discretized DFE comparing the different types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for types</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of plot</p></li>
<li><p><strong>intervals_ben</strong> ((<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)) – Interval boundaries for beneficial DFE</p></li>
<li><p><strong>intervals_del</strong> ((<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)) – Interval boundaries for deleterious DFE</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to plot confidence intervals</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bars.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_sfs_comparison">
<span class="sig-name descname"><span class="pre">plot_sfs_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'modelled'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'observed'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'selected'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'neutral'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['modelled',</span> <span class="pre">'observed']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'SFS</span> <span class="pre">comparison'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_subplots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_monomorphic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_sfs_comparison" title="Permalink to this definition"></a></dt>
<dd><p>Plot SFS comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>types</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Types to plot</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for types</p></li>
<li><p><strong>sfs_types</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'modelled'</span></code>, <code class="docutils literal notranslate"><span class="pre">'observed'</span></code>, <code class="docutils literal notranslate"><span class="pre">'selected'</span></code>, <code class="docutils literal notranslate"><span class="pre">'neutral'</span></code>]]) – Types of SFS to plot</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title</p></li>
<li><p><strong>use_subplots</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use subplots</p></li>
<li><p><strong>show_monomorphic</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show monomorphic counts</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_continuous">
<span class="sig-name descname"><span class="pre">plot_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'DFE</span> <span class="pre">comparison'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'symlog'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_continuous" title="Permalink to this definition"></a></dt>
<dd><p>Plot discretized DFE. The special constants <code class="docutils literal notranslate"><span class="pre">np.inf</span></code> and <code class="docutils literal notranslate"><span class="pre">-np.inf</span></code> are also valid interval bounds.
By default, the PDF is plotted as is. Due to the logarithmic scale on
the x-axis, we may get a wrong intuition on how the mass is distributed,
however. To get a better intuition, we can optionally scale the density
by the x-axis interval size using <code class="docutils literal notranslate"><span class="pre">scale_density</span> <span class="pre">=</span> <span class="pre">True</span></code>. This has the
disadvantage that the density now changes for x, so that even a constant
density will look warped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale_density</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to scale the density by the x-axis interval size</p></li>
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>, <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code>]) – y-scale</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for types</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of plot</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to plot confidence intervals</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_inferred_parameters">
<span class="sig-name descname"><span class="pre">plot_inferred_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'inferred</span> <span class="pre">parameters'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'loc':</span> <span class="pre">'upper</span> <span class="pre">right',</span> <span class="pre">'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_inferred_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Plot discretized DFE comparing the different types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show legend</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for types</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of plot</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to plot confidence intervals</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_inferred_parameters_boxplot">
<span class="sig-name descname"><span class="pre">plot_inferred_parameters_boxplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'inferred</span> <span class="pre">parameters'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_inferred_parameters_boxplot" title="Permalink to this definition"></a></dt>
<dd><p>Plot discretized DFE comparing the different types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for types</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of plot</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no inference objects are given or no bootstraps are found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_cis_params_mle">
<span class="sig-name descname"><span class="pre">get_cis_params_mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_cis_params_mle" title="Permalink to this definition"></a></dt>
<dd><p>Get confidence intervals for the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Confidence intervals for the parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_discretized">
<span class="sig-name descname"><span class="pre">get_discretized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_discretized" title="Permalink to this definition"></a></dt>
<dd><p>Get discretized DFEs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence interval level</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return confidence intervals</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of array of values and array of errors indexed by inference type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_bootstrap_params">
<span class="sig-name descname"><span class="pre">get_bootstrap_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_bootstrap_params" title="Permalink to this definition"></a></dt>
<dd><p>Get bootstrap parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bootstrap parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.to_json" title="Permalink to this definition"></a></dt>
<dd><p>Serialize object. Note that the deserialized inference objects no
longer share the same optimization instance among other things.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>JSON string</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.alpha">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alpha</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.alpha" title="Permalink to this definition"></a></dt>
<dd><p>The is no single alpha for the joint inference. Please refer
to the <code class="docutils literal notranslate"><span class="pre">self.joint_inferences[t].alpha</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_L2_residual">
<span class="sig-name descname"><span class="pre">get_L2_residual</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_L2_residual" title="Permalink to this definition"></a></dt>
<dd><p>L2 residual of joint inference. We calculate the residual over
the jointly inferred SFS for all types.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.add_alpha_to_bootstraps">
<span class="sig-name descname"><span class="pre">add_alpha_to_bootstraps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.add_alpha_to_bootstraps" title="Permalink to this definition"></a></dt>
<dd><p>Add estimates for alpha to the bootstraps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.add_demography">
<span class="sig-name descname"><span class="pre">add_demography</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs_neut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><span class="pre">fastdfe.spectrum.Spectrum</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">counts_sel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.add_demography" title="Permalink to this definition"></a></dt>
<dd><p>Add the effect of demography to counts_sel by considering
how counts_neut is perturbed relative to the standard coalescent.
The polarization error is also included here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfs_neut</strong> (<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – Observed spectrum of neutral sites.</p></li>
<li><p><strong>counts_sel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Modelled counts of selected sites.</p></li>
<li><p><strong>eps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Rate of ancestral misidentification.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adjusted counts of selected sites.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.adjust_polarization">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjust_polarization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.adjust_polarization" title="Permalink to this definition"></a></dt>
<dd><p>Adjust the polarization of the given SFS where
eps is the rate of ancestral misidentification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>counts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Polymorphic SFS counts to adjust.</p></li>
<li><p><strong>eps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Rate of ancestral misidentification.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adjusted SFS counts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.assign_result">
<span class="sig-name descname"><span class="pre">assign_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">scipy.optimize._optimize.OptimizeResult</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_mle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.assign_result" title="Permalink to this definition"></a></dt>
<dd><p>Assign optimization result and MLE parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params_mle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – MLE parameters.</p></li>
<li><p><strong>result</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code>) – Optimization result.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.check_fixed_params_exist">
<span class="sig-name descname"><span class="pre">check_fixed_params_exist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.check_fixed_params_exist" title="Permalink to this definition"></a></dt>
<dd><p>Check that the fixed parameters are valid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.compare_nested_likelihoods">
<span class="sig-name descname"><span class="pre">compare_nested_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">complex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><span class="pre">fastdfe.base_inference.BaseInference</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.compare_nested_likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Perform likelihood ratio test with given more complex model.
The given model’s fixed parameters need to be a proper
subset of this model’s fixed parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>complex</strong> (<a class="reference internal" href="#fastdfe.base_inference.BaseInference" title="fastdfe.base_inference.BaseInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseInference</span></code></a>) – More complex model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>p-value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.compare_nested_models">
<span class="sig-name descname"><span class="pre">compare_nested_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.compare_nested_models" title="Permalink to this definition"></a></dt>
<dd><p>Compare the various nested versions of the specified
model using likelihood ratio tests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>do_bootstrap</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to perform bootstrapping. This is recommended to get more accurate p-values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, BaseInference])</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Matrix of p-values, dict of base inference objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.default_bounds">
<span class="sig-name descname"><span class="pre">default_bounds</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'eps':</span> <span class="pre">(0,</span> <span class="pre">0.15)}</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.default_bounds" title="Permalink to this definition"></a></dt>
<dd><p>Default parameter bounds not connected to the DFE parametrization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.default_opts_mle">
<span class="sig-name descname"><span class="pre">default_opts_mle</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.default_opts_mle" title="Permalink to this definition"></a></dt>
<dd><p>Default options for the MLE</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.default_scales">
<span class="sig-name descname"><span class="pre">default_scales</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'eps':</span> <span class="pre">'lin'}</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.default_scales" title="Permalink to this definition"></a></dt>
<dd><p>Scales for the parameters not connected to the DFE parametrization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.default_x0">
<span class="sig-name descname"><span class="pre">default_x0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'eps':</span> <span class="pre">0.0}</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.default_x0" title="Permalink to this definition"></a></dt>
<dd><p>Default parameters not connected to the DFE parametrization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.evaluate_likelihood">
<span class="sig-name descname"><span class="pre">evaluate_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.evaluate_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate likelihood function at given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Parameters indexed by type and parameter name.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The likelihood.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="config.html#fastdfe.config.Config" title="fastdfe.config.Config"><span class="pre">fastdfe.config.Config</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.from_config" title="Permalink to this definition"></a></dt>
<dd><p>Load from config object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="config.html#fastdfe.config.Config" title="fastdfe.config.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a>) – Config object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Inference object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.from_config_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.from_config_file" title="Permalink to this definition"></a></dt>
<dd><p>Load from config file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Config file path.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Inference object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Load object from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classes</strong> – Classes to be used for unserialization</p></li>
<li><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File to load from</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.from_json">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.from_json" title="Permalink to this definition"></a></dt>
<dd><p>Unserialize object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classes</strong> – Classes to be used for unserialization</p></li>
<li><p><strong>json</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – JSON string</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_alpha">
<span class="sig-name descname"><span class="pre">get_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_alpha" title="Permalink to this definition"></a></dt>
<dd><p>Get alpha, the proportion of beneficial non-synonymous substitutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – Parameters to use for calculation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_bootstrap_param_names">
<span class="sig-name descname"><span class="pre">get_bootstrap_param_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_bootstrap_param_names" title="Permalink to this definition"></a></dt>
<dd><p>Get the parameters to be included in the bootstraps.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parameters to be included in the bootstraps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_bounds_linear">
<span class="sig-name descname"><span class="pre">get_bounds_linear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_bounds_linear" title="Permalink to this definition"></a></dt>
<dd><p>Get linear bounds for all parameters. We do this for the bootstraps as x0 should be close to MLE.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of bounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_errors_discretized_dfe">
<span class="sig-name descname"><span class="pre">get_errors_discretized_dfe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_errors_discretized_dfe" title="Permalink to this definition"></a></dt>
<dd><p>Get the discretized DFE errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence interval level.</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Arrays of errors, confidence intervals, bootstraps, means and values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_fixed_param_names">
<span class="sig-name descname"><span class="pre">get_fixed_param_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_fixed_param_names" title="Permalink to this definition"></a></dt>
<dd><p>Get the names of the fixed parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_n_optimized">
<span class="sig-name descname"><span class="pre">get_n_optimized</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_n_optimized" title="Permalink to this definition"></a></dt>
<dd><p>Get the number of parameters that are optimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of parameters that are optimized.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_optimized_param_names">
<span class="sig-name descname"><span class="pre">get_optimized_param_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_optimized_param_names" title="Permalink to this definition"></a></dt>
<dd><p>Get the parameters names for the parameters that are optimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of parameter names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_scales_linear">
<span class="sig-name descname"><span class="pre">get_scales_linear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_scales_linear" title="Permalink to this definition"></a></dt>
<dd><p>Get linear scales for all parameters. We do this for the bootstraps as x0 should be close to MLE.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>]]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of scales.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.get_summary">
<span class="sig-name descname"><span class="pre">get_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.get_summary" title="Permalink to this definition"></a></dt>
<dd><p>Get summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">InferenceResults</span></code></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inference results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.lrt">
<span class="sig-name descname"><span class="pre">lrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ll_simple</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ll_complex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.lrt" title="Permalink to this definition"></a></dt>
<dd><p>Perform the likelihood ratio test (LRT).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ll_simple</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Log-likelihood of the simple model.</p></li>
<li><p><strong>ll_complex</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Log-likelihood of the complex model.</p></li>
<li><p><strong>df</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Degrees of freedom.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>p-value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.model_sfs">
<span class="sig-name descname"><span class="pre">model_sfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_neut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><span class="pre">fastdfe.spectrum.Spectrum</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfs_sel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><span class="pre">fastdfe.spectrum.Spectrum</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.model_sfs" title="Permalink to this definition"></a></dt>
<dd><p>Model the selected SFS from the given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfs_sel</strong> (<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – Observed spectrum of selected sites.</p></li>
<li><p><strong>sfs_neut</strong> (<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – Observed spectrum of neutral sites.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Dictionary of parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of modelled and observed counts</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.param_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.param_names" title="Permalink to this definition"></a></dt>
<dd><p>Parameter names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of parameter names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_all">
<span class="sig-name descname"><span class="pre">plot_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_all" title="Permalink to this definition"></a></dt>
<dd><p>Plot a bunch of plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_bucket_sizes">
<span class="sig-name descname"><span class="pre">plot_bucket_sizes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'bucket</span> <span class="pre">sizes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_bucket_sizes" title="Permalink to this definition"></a></dt>
<dd><p>Plot mass in each bucket for the MLE DFE.
This can be used to check if the interval bounds and spacing
are chosen appropriately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_interval_density">
<span class="sig-name descname"><span class="pre">plot_interval_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_interval_density" title="Permalink to this definition"></a></dt>
<dd><p>Plot density of the discretization intervals chosen. Note that although this plot looks similar, this is
not the DFE!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>color</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Color of the bars.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>interval_labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for the intervals.</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_likelihoods">
<span class="sig-name descname"><span class="pre">plot_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'likelihoods'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Visualize the likelihoods of the optimization runs using a scatter plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>]) – y-scale of the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_nested_likelihoods">
<span class="sig-name descname"><span class="pre">plot_nested_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_empty</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'nested</span> <span class="pre">model</span> <span class="pre">comparison'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_bootstrap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_nested_likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Plot the p-values of nested likelihoods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>remove_empty</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to remove empty rows and columns.</p></li>
<li><p><strong>transpose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to transpose the matrix.</p></li>
<li><p><strong>cmap</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Colormap to use.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
<li><p><strong>do_bootstrap</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to perform bootstrapping. This is recommended to get more accurate p-values.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.plot_observed_sfs">
<span class="sig-name descname"><span class="pre">plot_observed_sfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.plot_observed_sfs" title="Permalink to this definition"></a></dt>
<dd><p>Plot neutral and selected SFS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Labels for the SFS.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes object to plot on.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.raise_if_locked">
<span class="sig-name descname"><span class="pre">raise_if_locked</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.raise_if_locked" title="Permalink to this definition"></a></dt>
<dd><p>Raise an error if this object is locked.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.report_result">
<span class="sig-name descname"><span class="pre">report_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">scipy.optimize._optimize.OptimizeResult</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.report_result" title="Permalink to this definition"></a></dt>
<dd><p>Inform on optimization result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – MLE parameters.</p></li>
<li><p><strong>result</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code>) – Optimization result.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.resample_sfs">
<span class="sig-name descname"><span class="pre">resample_sfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><span class="pre">fastdfe.spectrum.Spectrum</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.resample_sfs" title="Permalink to this definition"></a></dt>
<dd><p>Resample SFS assuming independent Poisson counts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfs</strong> (<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>) – Spectrum to resample.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Seed for random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Resampled spectrum.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.run_bootstrap_sample">
<span class="sig-name descname"><span class="pre">run_bootstrap_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.run_bootstrap_sample" title="Permalink to this definition"></a></dt>
<dd><p>Resample the observed selected SFS and rerun the optimization procedure.
We take the MLE params as initial params here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Seed for random number generator.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizeResult</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optimization result and MLE parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.run_if_required">
<span class="sig-name descname"><span class="pre">run_if_required</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.run_if_required" title="Permalink to this definition"></a></dt>
<dd><p>Run if not run yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – Arguments.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="spectrum.html#fastdfe.spectrum.Spectrum" title="fastdfe.spectrum.Spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spectrum</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DFE parametrization and modelled SFS.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.run_if_required_wrapper">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_if_required_wrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.run_if_required_wrapper" title="Permalink to this definition"></a></dt>
<dd><p>Decorator to run inference if required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> – Function to decorate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decorated function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.to_file" title="Permalink to this definition"></a></dt>
<dd><p>Save object to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File to save to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.update_properties">
<span class="sig-name descname"><span class="pre">update_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.update_properties" title="Permalink to this definition"></a></dt>
<dd><p>Update the properties of this class with the given dictionary
given that its entries are not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Dictionary of properties to update.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.sfs_neut">
<span class="sig-name descname"><span class="pre">sfs_neut</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Spectrum</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.sfs_neut" title="Permalink to this definition"></a></dt>
<dd><p>Neutral SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.sfs_sel">
<span class="sig-name descname"><span class="pre">sfs_sel</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Spectrum</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.sfs_sel" title="Permalink to this definition"></a></dt>
<dd><p>Selected SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Parametrization</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.model" title="Permalink to this definition"></a></dt>
<dd><p>The DFE parametrization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.folded">
<span class="sig-name descname"><span class="pre">folded</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.folded" title="Permalink to this definition"></a></dt>
<dd><p>Whether the SFS are folded</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.n">
<span class="sig-name descname"><span class="pre">n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.n" title="Permalink to this definition"></a></dt>
<dd><p>Sample size</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.discretization">
<span class="sig-name descname"><span class="pre">discretization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Discretization</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.discretization" title="Permalink to this definition"></a></dt>
<dd><p>Discretization instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.theta">
<span class="sig-name descname"><span class="pre">theta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.theta" title="Permalink to this definition"></a></dt>
<dd><p>Estimate of theta from neutral SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.params_mle">
<span class="sig-name descname"><span class="pre">params_mle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[Dict[str,</span> <span class="pre">float]]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.params_mle" title="Permalink to this definition"></a></dt>
<dd><p>MLE estimates of the initial optimization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.sfs_mle">
<span class="sig-name descname"><span class="pre">sfs_mle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[Spectrum]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.sfs_mle" title="Permalink to this definition"></a></dt>
<dd><p>Modelled MLE SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[float]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Likelihood of the MLE, this value may be updated after bootstrapping</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.likelihoods">
<span class="sig-name descname"><span class="pre">likelihoods</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[List[float]]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Likelihoods of the different ML runs, controlled by <code class="docutils literal notranslate"><span class="pre">n_runs</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.n_runs">
<span class="sig-name descname"><span class="pre">n_runs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.n_runs" title="Permalink to this definition"></a></dt>
<dd><p>Number of MLE runs to perform</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.result">
<span class="sig-name descname"><span class="pre">result</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[OptimizeResult]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.result" title="Permalink to this definition"></a></dt>
<dd><p>Numerical optimization result</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.do_bootstrap">
<span class="sig-name descname"><span class="pre">do_bootstrap</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.do_bootstrap" title="Permalink to this definition"></a></dt>
<dd><p>Whether to do bootstrapping</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.n_bootstraps">
<span class="sig-name descname"><span class="pre">n_bootstraps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.n_bootstraps" title="Permalink to this definition"></a></dt>
<dd><p>Number of bootstraps</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.parallelize">
<span class="sig-name descname"><span class="pre">parallelize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.parallelize" title="Permalink to this definition"></a></dt>
<dd><p>Whether to parallelize the bootstrapping</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.bootstraps">
<span class="sig-name descname"><span class="pre">bootstraps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[pd.DataFrame]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.bootstraps" title="Permalink to this definition"></a></dt>
<dd><p>Bootstrapped MLE parameter estimates</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.bootstrap_results">
<span class="sig-name descname"><span class="pre">bootstrap_results</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[List[OptimizeResult]]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.bootstrap_results" title="Permalink to this definition"></a></dt>
<dd><p>Bootstrap optimization results</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.L2_residual">
<span class="sig-name descname"><span class="pre">L2_residual</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional[float]</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.L2_residual" title="Permalink to this definition"></a></dt>
<dd><p>L2 norm of fit minus observed SFS</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.seed" title="Permalink to this definition"></a></dt>
<dd><p>Random number generator seed</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.execution_time">
<span class="sig-name descname"><span class="pre">execution_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.execution_time" title="Permalink to this definition"></a></dt>
<dd><p>Total execution time in seconds</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.locked">
<span class="sig-name descname"><span class="pre">locked</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fastdfe.joint_inference.JointInference.locked" title="Permalink to this definition"></a></dt>
<dd><p>Whether inferences can be run from the class itself</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.x0" title="Permalink to this definition"></a></dt>
<dd><p>Initial values</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.joint_inference.JointInference.rng">
<span class="sig-name descname"><span class="pre">rng</span></span><a class="headerlink" href="#fastdfe.joint_inference.JointInference.rng" title="Permalink to this definition"></a></dt>
<dd><p>Random generator instance</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fastdfe.abstract_inference.</span></span><span class="sig-name descname"><span class="pre">Inference</span></span><a class="headerlink" href="#fastdfe.abstract_inference.Inference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Static utility methods for inference objects.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.plot_discretized">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_discretized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inferences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">fastdfe.abstract_inference.AbstractInference</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'discretized</span> <span class="pre">DFEs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.plot_discretized" title="Permalink to this definition"></a></dt>
<dd><p>Visualize several discretized DFEs given by the list of inference objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inferences</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractInference</span></code>]) – List of inference objects.</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Intervals to use for discretization.</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to plot confidence intervals.</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level for confidence intervals.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use for confidence intervals.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Path to file to save the plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of the plot.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Labels for the DFEs.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments for the plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes of the plot.</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes of the plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.plot_continuous">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inferences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">fastdfe.abstract_inference.AbstractInference</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'continuous</span> <span class="pre">DFEs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'symlog'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.plot_continuous" title="Permalink to this definition"></a></dt>
<dd><p>Visualize several DFEs given by the list of inference objects.
By default, the PDF is plotted as is. Due to the logarithmic scale on
the x-axis, we may get a wrong intuition on how the mass is distributed,
however. To get a better intuition, we can optionally scale the density
by the x-axis interval size using <code class="docutils literal notranslate"><span class="pre">scale_density</span> <span class="pre">=</span> <span class="pre">True</span></code>. This has the
disadvantage that the density now changes for x, so that even a constant
density will look warped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inferences</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractInference</span></code>]) – List of inference objects.</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Intervals to use for discretization.</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to plot confidence intervals.</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level for confidence intervals.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use for confidence intervals.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Path to file to save the plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of the plot.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Labels for the DFEs.</p></li>
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>, <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code>]) – y-scale of the plot.</p></li>
<li><p><strong>scale_density</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to scale the density by the x-axis interval size.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes of the plot.</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
<li><p><strong>kwargs</strong> – Additional arguments for the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes of the plot.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.plot_inferred_parameters">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_inferred_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inferences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">fastdfe.abstract_inference.AbstractInference</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'parameter</span> <span class="pre">estimates'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'symlog'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'loc':</span> <span class="pre">'upper</span> <span class="pre">right',</span> <span class="pre">'prop':</span> <span class="pre">{'size':</span> <span class="pre">8}}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.plot_inferred_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Visualize several discretized DFEs given by the list of inference objects.
Note that the DFE parametrization needs to be the same for all inference objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inferences</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractInference</span></code>]) – List of inference objects.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Unique labels for the DFEs.</p></li>
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>, <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code>]) – y-scale of the plot.</p></li>
<li><p><strong>legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show a legend.</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to plot confidence intervals.</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level for confidence intervals.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use for confidence intervals.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Path to file to save the plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of the plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes of the plot.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments for the plot.</p></li>
<li><p><strong>kwargs_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Keyword arguments passed to <code class="xref py py-meth docutils literal notranslate"><span class="pre">plt.legend()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes of the plot.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no inference objects are given.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.plot_inferred_parameters_boxplot">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_inferred_parameters_boxplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inferences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">fastdfe.abstract_inference.AbstractInference</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'parameter</span> <span class="pre">estimates'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.plot_inferred_parameters_boxplot" title="Permalink to this definition"></a></dt>
<dd><p>Visualize several discretized DFEs given by the list of inference objects.
Note that the DFE parametrization needs to be the same for all inference objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inferences</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractInference</span></code>]) – List of inference objects.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Unique labels for the DFEs.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Path to file to save the plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Title of the plot.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments for the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes of the plot.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no inference objects are given or no bootstraps are found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.get_cis_params_mle">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cis_params_mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inferences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">fastdfe.abstract_inference.AbstractInference</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.get_cis_params_mle" title="Permalink to this definition"></a></dt>
<dd><p>Get confidence intervals for the MLE parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use for confidence intervals.</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level for confidence intervals.</p></li>
<li><p><strong>inferences</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractInference</span></code>]) – List of inference objects.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Labels for the DFEs.</p></li>
<li><p><strong>param_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Names of the parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of confidence intervals indexed by labels.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.get_errors_params_mle">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_errors_params_mle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inferences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">fastdfe.abstract_inference.AbstractInference</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.get_errors_params_mle" title="Permalink to this definition"></a></dt>
<dd><p>Get errors and values for MLE params of inferences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use.</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence level for confidence intervals.</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to compute confidence intervals.</p></li>
<li><p><strong>inferences</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractInference</span></code>]) – List of inference objects.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Labels for the inferences.</p></li>
<li><p><strong>param_names</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Names of the parameters to get errors and values for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]], <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>])</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary of errors and dictionary of values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.get_discretized">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_discretized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inferences</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">fastdfe.abstract_inference.AbstractInference</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.get_discretized" title="Permalink to this definition"></a></dt>
<dd><p>Get values and errors of discretized DFE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inferences</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractInference</span></code>]) – List of inference objects.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Labels for the DFEs.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap to use</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence interval level</p></li>
<li><p><strong>confidence_intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to compute confidence intervals</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bars.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>])</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array of values and array of errors</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.get_stats_discretized">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_stats_discretized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstraps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="parametrization.html#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><span class="pre">fastdfe.parametrization.Parametrization</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-inf,</span> <span class="pre">-100.,</span> <span class="pre">-10.,</span> <span class="pre">-1.,</span> <span class="pre">0.,</span> <span class="pre">1.,</span> <span class="pre">inf])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'percentile'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'percentile'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.get_stats_discretized" title="Permalink to this definition"></a></dt>
<dd><p>Compute errors and confidence interval for a discretized DFE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Parameters of the model</p></li>
<li><p><strong>bootstraps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>) – Bootstrapped samples</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="parametrization.html#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – DFE parametrization</p></li>
<li><p><strong>ci_level</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Confidence interval level</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
<li><p><strong>bootstrap_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'percentile'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bca'</span></code>]) – Type of bootstrap</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>)</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Arrays of errors, confidence intervals, bootstraps, means and values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.abstract_inference.Inference.compute_histogram">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="parametrization.html#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><span class="pre">fastdfe.parametrization.Parametrization</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.abstract_inference.Inference.compute_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Discretize the DFE given a DFE parametrization and its parameter values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="parametrization.html#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – DFE parametrization</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Parameters of the model</p></li>
<li><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – Array of interval boundaries yielding <code class="docutils literal notranslate"><span class="pre">intervals.shape[0]</span> <span class="pre">-</span> <span class="pre">1</span></code> bins.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Discretized DFE</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.optimization.SharedParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fastdfe.optimization.</span></span><span class="sig-name descname"><span class="pre">SharedParams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.optimization.SharedParams" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class specifying the sharing of params among types.
‘all’ means all available types or params.</p>
<p>Basic usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastdfe</span> <span class="kn">import</span> <span class="n">JointInference</span><span class="p">,</span> <span class="n">Spectra</span><span class="p">,</span> <span class="n">SharedParams</span>

<span class="c1"># neutral SFS for two types</span>
<span class="n">sfs_neut</span> <span class="o">=</span> <span class="n">Spectra</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">pendula</span><span class="o">=</span><span class="p">[</span><span class="mi">177130</span><span class="p">,</span> <span class="mi">997</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">652</span><span class="p">],</span>
    <span class="n">pubescens</span><span class="o">=</span><span class="p">[</span><span class="mi">172528</span><span class="p">,</span> <span class="mi">3612</span><span class="p">,</span> <span class="mi">1359</span><span class="p">,</span> <span class="mi">790</span><span class="p">,</span> <span class="mi">584</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">325</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">31</span><span class="p">]</span>
<span class="p">))</span>

<span class="c1"># selected SFS for two types</span>
<span class="n">sfs_sel</span> <span class="o">=</span> <span class="n">Spectra</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
    <span class="n">pendula</span><span class="o">=</span><span class="p">[</span><span class="mi">797939</span><span class="p">,</span> <span class="mi">1329</span><span class="p">,</span> <span class="mi">499</span><span class="p">,</span> <span class="mi">265</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">794</span><span class="p">],</span>
    <span class="n">pubescens</span><span class="o">=</span><span class="p">[</span><span class="mi">791106</span><span class="p">,</span> <span class="mi">5326</span><span class="p">,</span> <span class="mi">1741</span><span class="p">,</span> <span class="mi">1005</span><span class="p">,</span> <span class="mi">756</span><span class="p">,</span> <span class="mi">546</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">294</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">41</span><span class="p">]</span>
<span class="p">))</span>

<span class="c1"># create inference object</span>
<span class="n">inf</span> <span class="o">=</span> <span class="n">JointInference</span><span class="p">(</span>
    <span class="n">sfs_neut</span><span class="o">=</span><span class="n">sfs_neut</span><span class="p">,</span>
    <span class="n">sfs_sel</span><span class="o">=</span><span class="n">sfs_sel</span><span class="p">,</span>
    <span class="n">shared_params</span><span class="o">=</span><span class="p">[</span><span class="n">SharedParams</span><span class="p">(</span><span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pendula&quot;</span><span class="p">,</span> <span class="s2">&quot;pubescens&quot;</span><span class="p">],</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;eps&quot;</span><span class="p">,</span> <span class="s2">&quot;S_d&quot;</span><span class="p">])],</span>
    <span class="n">do_bootstrap</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># run inference</span>
<span class="n">inf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.optimization.SharedParams.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">],</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'all'</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.optimization.SharedParams.params" title="Permalink to this definition"></a></dt>
<dd><p>The params to share</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.optimization.SharedParams.types">
<span class="sig-name descname"><span class="pre">types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">],</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'all'</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.optimization.SharedParams.types" title="Permalink to this definition"></a></dt>
<dd><p>The types to share</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.optimization.SharedParams.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.optimization.SharedParams.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">fastdfe.optimization.</span></span><span class="sig-name descname"><span class="pre">Covariate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.0001,</span> <span class="pre">10000.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'symlog'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'symlog'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.optimization.Covariate" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class defining a covariate which induces a relationship
with one or many parameters. The relationship is defined
by a callback function which modifies the parameters. The
default callback introduces a linear relationship.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.param">
<span class="sig-name descname"><span class="pre">param</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#fastdfe.optimization.Covariate.param" title="Permalink to this definition"></a></dt>
<dd><p>The parameter to modify</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.values">
<span class="sig-name descname"><span class="pre">values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.optimization.Covariate.values" title="Permalink to this definition"></a></dt>
<dd><p>The values of the covariate for each type</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#fastdfe.optimization.Covariate.callback" title="Permalink to this definition"></a></dt>
<dd><p>The callback function to modify the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(0.0001,</span> <span class="pre">10000.0)</span></em><a class="headerlink" href="#fastdfe.optimization.Covariate.bounds" title="Permalink to this definition"></a></dt>
<dd><p>The bounds of the covariate parameter to be estimated</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#fastdfe.optimization.Covariate.x0" title="Permalink to this definition"></a></dt>
<dd><p>The initial value of the covariate</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.bounds_scale">
<span class="sig-name descname"><span class="pre">bounds_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'lin'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'log'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'symlog'</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'symlog'</span></em><a class="headerlink" href="#fastdfe.optimization.Covariate.bounds_scale" title="Permalink to this definition"></a></dt>
<dd><p>The scale of the bounds. See <code class="xref py py-func docutils literal notranslate"><span class="pre">scale_value()</span></code> for details</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covariate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.optimization.Covariate.apply" title="Permalink to this definition"></a></dt>
<dd><p>Apply the custom or default callback to modify the given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covariate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The value of the covariate.</p></li>
<li><p><strong>type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The type of the relationship.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The input parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Modified parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.apply_default">
<span class="sig-name descname"><span class="pre">apply_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">covariate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.optimization.Covariate.apply_default" title="Permalink to this definition"></a></dt>
<dd><p>Modify the given parameters introducing a linear relationship
with the given covariate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covariate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The value of the covariate.</p></li>
<li><p><strong>type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The type of the relationship.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The input parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Modified parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.optimization.Covariate.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.0001,</span> <span class="pre">10000.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'symlog'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'symlog'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.optimization.Covariate.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../reference/miscellaneous.html" class="btn btn-neutral float-left" title="Miscellaneous" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="config.html" class="btn btn-neutral float-right" title="Configuration class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Janek Sendrowski.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>