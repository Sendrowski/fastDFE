<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DFE Parametrizations &mdash; fastDFE 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spectrum class" href="spectrum.html" />
    <link rel="prev" title="Configuration class" href="config.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            fastDFE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/introduction.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/inference.html">DFE Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/config.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/parametrizations.html">DFE parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/spectra.html">Working with SFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/parser.html">VCF Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/miscellaneous.html">Miscellaneous</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/inference.html">DFE Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/config.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/parametrizations.html">DFE parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/spectra.html">Working with SFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/parser.html">VCF Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/miscellaneous.html">Miscellaneous</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration class</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">DFE Parametrizations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.parametrization.Parametrization"><code class="docutils literal notranslate"><span class="pre">Parametrization</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.Parametrization.x0"><code class="docutils literal notranslate"><span class="pre">Parametrization.x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.Parametrization.bounds"><code class="docutils literal notranslate"><span class="pre">Parametrization.bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.Parametrization.scales"><code class="docutils literal notranslate"><span class="pre">Parametrization.scales</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.Parametrization.submodels"><code class="docutils literal notranslate"><span class="pre">Parametrization.submodels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.Parametrization.__init__"><code class="docutils literal notranslate"><span class="pre">Parametrization.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.Parametrization.param_names"><code class="docutils literal notranslate"><span class="pre">Parametrization.param_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.Parametrization.get_pdf"><code class="docutils literal notranslate"><span class="pre">Parametrization.get_pdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.Parametrization.get_cdf"><code class="docutils literal notranslate"><span class="pre">Parametrization.get_cdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.parametrization.GammaExpParametrization"><code class="docutils literal notranslate"><span class="pre">GammaExpParametrization</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaExpParametrization.x0"><code class="docutils literal notranslate"><span class="pre">GammaExpParametrization.x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaExpParametrization.bounds"><code class="docutils literal notranslate"><span class="pre">GammaExpParametrization.bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaExpParametrization.scales"><code class="docutils literal notranslate"><span class="pre">GammaExpParametrization.scales</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaExpParametrization.submodels"><code class="docutils literal notranslate"><span class="pre">GammaExpParametrization.submodels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaExpParametrization.get_pdf"><code class="docutils literal notranslate"><span class="pre">GammaExpParametrization.get_pdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaExpParametrization.get_cdf"><code class="docutils literal notranslate"><span class="pre">GammaExpParametrization.get_cdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.parametrization.DisplacedGammaParametrization"><code class="docutils literal notranslate"><span class="pre">DisplacedGammaParametrization</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DisplacedGammaParametrization.x0"><code class="docutils literal notranslate"><span class="pre">DisplacedGammaParametrization.x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DisplacedGammaParametrization.bounds"><code class="docutils literal notranslate"><span class="pre">DisplacedGammaParametrization.bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DisplacedGammaParametrization.scales"><code class="docutils literal notranslate"><span class="pre">DisplacedGammaParametrization.scales</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DisplacedGammaParametrization.submodels"><code class="docutils literal notranslate"><span class="pre">DisplacedGammaParametrization.submodels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DisplacedGammaParametrization.get_pdf"><code class="docutils literal notranslate"><span class="pre">DisplacedGammaParametrization.get_pdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DisplacedGammaParametrization.get_cdf"><code class="docutils literal notranslate"><span class="pre">DisplacedGammaParametrization.get_cdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.parametrization.GammaDiscreteParametrization"><code class="docutils literal notranslate"><span class="pre">GammaDiscreteParametrization</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaDiscreteParametrization.x0"><code class="docutils literal notranslate"><span class="pre">GammaDiscreteParametrization.x0</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaDiscreteParametrization.bounds"><code class="docutils literal notranslate"><span class="pre">GammaDiscreteParametrization.bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaDiscreteParametrization.scales"><code class="docutils literal notranslate"><span class="pre">GammaDiscreteParametrization.scales</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaDiscreteParametrization.submodels"><code class="docutils literal notranslate"><span class="pre">GammaDiscreteParametrization.submodels</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaDiscreteParametrization.get_pdf"><code class="docutils literal notranslate"><span class="pre">GammaDiscreteParametrization.get_pdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.GammaDiscreteParametrization.get_cdf"><code class="docutils literal notranslate"><span class="pre">GammaDiscreteParametrization.get_cdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.__init__"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.intervals"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.intervals</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.interval_sizes"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.interval_sizes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.k"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.k</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.params"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.param_names"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.param_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.fixed_params"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.fixed_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.get_pdf"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.get_pdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization.get_cdf"><code class="docutils literal notranslate"><span class="pre">DiscreteParametrization.get_cdf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.__init__"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.intervals"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.intervals</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.interval_sizes"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.interval_sizes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.k"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.k</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.params"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.param_names"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.param_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.fixed_params"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.fixed_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.to_nominal"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.to_nominal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.to_fractional"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.to_fractional()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.get_pdf"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.get_pdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.parametrization.DiscreteFractionalParametrization.get_cdf"><code class="docutils literal notranslate"><span class="pre">DiscreteFractionalParametrization.get_cdf()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spectrum.html">Spectrum class</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectra.html">Spectra class</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">VCF Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotation.html">VCF Annotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtration.html">VCF Filtration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fastDFE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">DFE Parametrizations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/parametrization.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-fastdfe.parametrization">
<span id="dfe-parametrizations"></span><span id="modules-parametrization"></span><h1>DFE Parametrizations<a class="headerlink" href="#module-fastdfe.parametrization" title="Permalink to this heading"></a></h1>
<p>DFE parametrizations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Parametrization</span></span><a class="headerlink" href="#fastdfe.parametrization.Parametrization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for parametrizing a DFE by a set of parameters.
Note that <a class="reference internal" href="#fastdfe.parametrization.Parametrization.get_pdf" title="fastdfe.parametrization.Parametrization.get_pdf"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_pdf()</span></code></a> is not required to be implemented, provided that the
linearized mode of fastDFE is used (which is highly recommended).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#fastdfe.parametrization.Parametrization.x0" title="Permalink to this definition"></a></dt>
<dd><p>Default initial parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#fastdfe.parametrization.Parametrization.bounds" title="Permalink to this definition"></a></dt>
<dd><p>Default parameter bounds</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization.scales">
<span class="sig-name descname"><span class="pre">scales</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'lin'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'log'</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#fastdfe.parametrization.Parametrization.scales" title="Permalink to this definition"></a></dt>
<dd><p>Scales over which to optimize the parameters, either ‘log’ or ‘lin’</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization.submodels">
<span class="sig-name descname"><span class="pre">submodels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'dele':</span> <span class="pre">{},</span> <span class="pre">'full':</span> <span class="pre">{}}</span></em><a class="headerlink" href="#fastdfe.parametrization.Parametrization.submodels" title="Permalink to this definition"></a></dt>
<dd><p>The kind of submodels supported by holding some parameters fixed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.Parametrization.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize parametrization.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization.param_names">
<span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></em><a class="headerlink" href="#fastdfe.parametrization.Parametrization.param_names" title="Permalink to this definition"></a></dt>
<dd><p>argument names</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization.get_pdf">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.Parametrization.get_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Get probability distribution function of DFE.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function that accepts an array of selection coefficients and returns their probability density</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.Parametrization.get_cdf">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.Parametrization.get_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Get probability distribution function of DFE.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function that accepts an array of selection coefficients and returns their cumulative probability</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaExpParametrization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GammaExpParametrization</span></span><a class="headerlink" href="#fastdfe.parametrization.GammaExpParametrization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a></p>
<p>Parametrization for mixture of a gamma and exponential distribution. This corresponds to
model C in polyDFE.</p>
<p>We have the following probability density function:</p>
<div class="math notranslate nohighlight">
\[\phi(S; S_d, b, p_b, S_b) = (1 - p_b) f_\Gamma(-S; S_d, b) \cdot \mathbf{1}_{\{S &lt; 0\}} +
p_b f_e(S; S_b) \cdot \mathbf{1}_{\{S \geq 0\}}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_d\)</span> is the mean of the DFE for <span class="math notranslate nohighlight">\(S &lt; 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> is the shape of the gamma distribution</p></li>
<li><p><span class="math notranslate nohighlight">\(p_b\)</span> is the probability that <span class="math notranslate nohighlight">\(S \geq 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(S_b\)</span> is the mean of the DFE for <span class="math notranslate nohighlight">\(S \geq 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_\Gamma(x; m, b)\)</span> is the density of the gamma distribution with mean <span class="math notranslate nohighlight">\(m\)</span> and shape <span class="math notranslate nohighlight">\(b\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_e(x; m)\)</span> is the density of the Exponential distribution with mean <span class="math notranslate nohighlight">\(m\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{1}_{\{A\}}\)</span> denotes the indicator function, which is 1 if <span class="math notranslate nohighlight">\(A\)</span> is true, and 0 otherwise.</p></li>
</ul>
<p>The DFE has often been observed to be multi-modal for negative selection coefficients. A gamma distribution
provides a good amount of flexibility to accommodate this.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaExpParametrization.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_b':</span> <span class="pre">1,</span> <span class="pre">'S_d':</span> <span class="pre">-1000,</span> <span class="pre">'b':</span> <span class="pre">0.4,</span> <span class="pre">'p_b':</span> <span class="pre">0.05}</span></em><a class="headerlink" href="#fastdfe.parametrization.GammaExpParametrization.x0" title="Permalink to this definition"></a></dt>
<dd><p>Default initial parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaExpParametrization.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_b':</span> <span class="pre">(0.0001,</span> <span class="pre">100),</span> <span class="pre">'S_d':</span> <span class="pre">(-100000.0,</span> <span class="pre">-0.01),</span> <span class="pre">'b':</span> <span class="pre">(0.01,</span> <span class="pre">10),</span> <span class="pre">'p_b':</span> <span class="pre">(0,</span> <span class="pre">0.5)}</span></em><a class="headerlink" href="#fastdfe.parametrization.GammaExpParametrization.bounds" title="Permalink to this definition"></a></dt>
<dd><p>Default parameter bounds, using non-zero lower bounds for S_d and S_B due to log-scaled scales</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaExpParametrization.scales">
<span class="sig-name descname"><span class="pre">scales</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'lin'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'log'</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_b':</span> <span class="pre">'log',</span> <span class="pre">'S_d':</span> <span class="pre">'log',</span> <span class="pre">'b':</span> <span class="pre">'log',</span> <span class="pre">'p_b':</span> <span class="pre">'lin'}</span></em><a class="headerlink" href="#fastdfe.parametrization.GammaExpParametrization.scales" title="Permalink to this definition"></a></dt>
<dd><p>Scales over which to optimize the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaExpParametrization.submodels">
<span class="sig-name descname"><span class="pre">submodels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'dele':</span> <span class="pre">{'S_b':</span> <span class="pre">1,</span> <span class="pre">'p_b':</span> <span class="pre">0},</span> <span class="pre">'full':</span> <span class="pre">{}}</span></em><a class="headerlink" href="#fastdfe.parametrization.GammaExpParametrization.submodels" title="Permalink to this definition"></a></dt>
<dd><p>The kind of submodels supported by holding some parameters fixed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaExpParametrization.get_pdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S_d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.GammaExpParametrization.get_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Get PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S_d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Mean selection coefficient for deleterious mutations</p></li>
<li><p><strong>b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Shape parameter for gamma distribution</p></li>
<li><p><strong>p_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Probability of a beneficial mutation</p></li>
<li><p><strong>S_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Mean selection coefficient for beneficial mutations</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that accepts an array of selection coefficients and returns their probability density</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaExpParametrization.get_cdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S_d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.GammaExpParametrization.get_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Get CDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S_d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Mean selection coefficient for deleterious mutations</p></li>
<li><p><strong>b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Shape parameter for gamma distribution</p></li>
<li><p><strong>p_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Probability of a beneficial mutation</p></li>
<li><p><strong>S_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Mean selection coefficient for beneficial mutations</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that accepts an array of selection coefficients and returns their cumulative probability</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.parametrization.DisplacedGammaParametrization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DisplacedGammaParametrization</span></span><a class="headerlink" href="#fastdfe.parametrization.DisplacedGammaParametrization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a></p>
<p>Parametrization for a reflected displaced gamma distribution.</p>
<p>We have the following probability density function:</p>
<div class="math notranslate nohighlight">
\[\phi(S; \hat{S}, b, S_{max}) = f_\Gamma(S_{max} - S; S_{max} - \hat{S}, b) \cdot \mathbf{1}_{\{S \leq S_{max}\}}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{S}\)</span> is the mean of the DFE</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> is the shape of the gamma distribution</p></li>
<li><p><span class="math notranslate nohighlight">\(S_{max}\)</span> is the maximum value that <span class="math notranslate nohighlight">\(S\)</span> can take</p></li>
<li><p><span class="math notranslate nohighlight">\(f_\Gamma(x; m, b)\)</span> is the density of the gamma distribution with mean <span class="math notranslate nohighlight">\(m\)</span> and shape <span class="math notranslate nohighlight">\(b\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{1}_{\{A\}}\)</span> denotes the indicator function, which is 1 if <span class="math notranslate nohighlight">\(A\)</span> is true, and 0 otherwise.</p></li>
</ul>
<p>This parametrization uses a single gamma distribution for both positive and negative selection coefficients.
This is a less flexible parametrization, which may produce results similar to the other models while requiring
fewer parameters. It also does not allow for a purely deleterious sub-parametrization.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DisplacedGammaParametrization.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_max':</span> <span class="pre">1,</span> <span class="pre">'S_mean':</span> <span class="pre">-100,</span> <span class="pre">'b':</span> <span class="pre">1}</span></em><a class="headerlink" href="#fastdfe.parametrization.DisplacedGammaParametrization.x0" title="Permalink to this definition"></a></dt>
<dd><p>Default initial parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DisplacedGammaParametrization.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_max':</span> <span class="pre">(0.001,</span> <span class="pre">100),</span> <span class="pre">'S_mean':</span> <span class="pre">(-100000,</span> <span class="pre">-0.01),</span> <span class="pre">'b':</span> <span class="pre">(0.01,</span> <span class="pre">10)}</span></em><a class="headerlink" href="#fastdfe.parametrization.DisplacedGammaParametrization.bounds" title="Permalink to this definition"></a></dt>
<dd><p>Default parameter bounds</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DisplacedGammaParametrization.scales">
<span class="sig-name descname"><span class="pre">scales</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'lin'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'log'</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_max':</span> <span class="pre">'log',</span> <span class="pre">'S_mean':</span> <span class="pre">'log',</span> <span class="pre">'b':</span> <span class="pre">'lin'}</span></em><a class="headerlink" href="#fastdfe.parametrization.DisplacedGammaParametrization.scales" title="Permalink to this definition"></a></dt>
<dd><p>Scales over which to optimize the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DisplacedGammaParametrization.submodels">
<span class="sig-name descname"><span class="pre">submodels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'dele':</span> <span class="pre">{},</span> <span class="pre">'full':</span> <span class="pre">{}}</span></em><a class="headerlink" href="#fastdfe.parametrization.DisplacedGammaParametrization.submodels" title="Permalink to this definition"></a></dt>
<dd><p>The kind of submodels supported by holding some parameters fixed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DisplacedGammaParametrization.get_pdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DisplacedGammaParametrization.get_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Get PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function that accepts an array of selection coefficients and returns their probability density</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DisplacedGammaParametrization.get_cdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DisplacedGammaParametrization.get_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Get CDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function that accepts an array of selection coefficients and returns their cumulative probability</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaDiscreteParametrization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GammaDiscreteParametrization</span></span><a class="headerlink" href="#fastdfe.parametrization.GammaDiscreteParametrization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a></p>
<p>Parametrization for a mixture of a gamma and discrete distribution. This corresponds to polyDFE’s model B.</p>
<p>We have the following probability density function:</p>
<div class="math notranslate nohighlight">
\[\phi(S; S_d, b, p_b, S_b) = (1 - p_b) f_{\Gamma}(S; S_d, b) \cdot \mathbf{1}_{\{S &lt; 0\}} +
p_b \cdot S_b \cdot \mathbf{1}_{\{0 \leq S \leq 1 / S_b\}}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_d\)</span> is the mean of the DFE for <span class="math notranslate nohighlight">\(S &lt; 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> is the shape of the gamma distribution</p></li>
<li><p><span class="math notranslate nohighlight">\(p_b\)</span> is the probability that <span class="math notranslate nohighlight">\(S \geq 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(S_b\)</span> is the shared selection coefficient of all positively selected mutations up to <span class="math notranslate nohighlight">\(1/S_b\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(f_\Gamma(x; m, b)\)</span> is the density of the gamma distribution with mean <span class="math notranslate nohighlight">\(m\)</span> and shape <span class="math notranslate nohighlight">\(b\)</span></p></li>
</ul>
<p>This parametrization is similar to <a class="reference internal" href="#fastdfe.parametrization.GammaExpParametrization" title="fastdfe.parametrization.GammaExpParametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">GammaExpParametrization</span></code></a>, but uses a constant mass for positive
selection coefficients. The results should be rather similar in most cases.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaDiscreteParametrization.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_b':</span> <span class="pre">1,</span> <span class="pre">'S_d':</span> <span class="pre">-1000,</span> <span class="pre">'b':</span> <span class="pre">0.4,</span> <span class="pre">'p_b':</span> <span class="pre">0.05}</span></em><a class="headerlink" href="#fastdfe.parametrization.GammaDiscreteParametrization.x0" title="Permalink to this definition"></a></dt>
<dd><p>Default initial parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaDiscreteParametrization.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_b':</span> <span class="pre">(0.0001,</span> <span class="pre">100),</span> <span class="pre">'S_d':</span> <span class="pre">(-100000.0,</span> <span class="pre">-0.01),</span> <span class="pre">'b':</span> <span class="pre">(0.01,</span> <span class="pre">10),</span> <span class="pre">'p_b':</span> <span class="pre">(0,</span> <span class="pre">0.5)}</span></em><a class="headerlink" href="#fastdfe.parametrization.GammaDiscreteParametrization.bounds" title="Permalink to this definition"></a></dt>
<dd><p>default parameter bounds</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaDiscreteParametrization.scales">
<span class="sig-name descname"><span class="pre">scales</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code><span class="pre">[</span><code class="docutils literal notranslate"><span class="pre">'lin'</span></code><span class="pre">,</span> <code class="docutils literal notranslate"><span class="pre">'log'</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'S_b':</span> <span class="pre">'log',</span> <span class="pre">'S_d':</span> <span class="pre">'log',</span> <span class="pre">'b':</span> <span class="pre">'log',</span> <span class="pre">'p_b':</span> <span class="pre">'lin'}</span></em><a class="headerlink" href="#fastdfe.parametrization.GammaDiscreteParametrization.scales" title="Permalink to this definition"></a></dt>
<dd><p>scales over which to optimize the parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaDiscreteParametrization.submodels">
<span class="sig-name descname"><span class="pre">submodels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'dele':</span> <span class="pre">{'S_b':</span> <span class="pre">1,</span> <span class="pre">'p_b':</span> <span class="pre">0},</span> <span class="pre">'full':</span> <span class="pre">{}}</span></em><a class="headerlink" href="#fastdfe.parametrization.GammaDiscreteParametrization.submodels" title="Permalink to this definition"></a></dt>
<dd><p>The kind of submodels supported by holding some parameters fixed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaDiscreteParametrization.get_pdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S_d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.GammaDiscreteParametrization.get_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Get PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S_d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Mean of the DFE for S &gt;= 0</p></li>
<li><p><strong>b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Shape of the gamma distribution</p></li>
<li><p><strong>p_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Probability that S &gt; 0</p></li>
<li><p><strong>S_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Shared selection coefficient of all positively selected mutations up to S_b</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that accepts an array of selection coefficients and returns their probability density</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.GammaDiscreteParametrization.get_cdf">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S_d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.GammaDiscreteParametrization.get_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Get CDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>S_d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Mean of the DFE for S &gt;= 0</p></li>
<li><p><strong>b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Shape of the gamma distribution</p></li>
<li><p><strong>p_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Probability that S &gt; 0</p></li>
<li><p><strong>S_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Shared selection coefficient of all positively selected mutations up to S_b</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that accepts an array of selection coefficients and returns their cumulative probability</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiscreteParametrization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-100000,</span> <span class="pre">-100,</span> <span class="pre">-10,</span> <span class="pre">-1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1000])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a></p>
<p>Parametrization for a discrete distribution. This corresponds to polyDFE’s model D.
By default we use 6 bins, but this can be changed by passing a different array to the constructor.
The resulting parameter names are <span class="math notranslate nohighlight">\(S_1, S_2, \dots, S_k\)</span>, where <span class="math notranslate nohighlight">\(k\)</span> is the number of bins.</p>
<p>That is, the probability density function is given by:</p>
<p><span class="math notranslate nohighlight">\(\phi(S; S_1, S_2, \dots, S_k) = \sum_{i=1}^{k} S_i/c_i \cdot \mathbf{1}_{\{S \in B_i\}}\)</span>
such that <span class="math notranslate nohighlight">\(\sum_{i=1}^{k} S_i = 1,\)</span></p>
<p>where <span class="math notranslate nohighlight">\(B_i\)</span> and <span class="math notranslate nohighlight">\(c_i\)</span> are interval <span class="math notranslate nohighlight">\(i\)</span> and the width of interval <span class="math notranslate nohighlight">\(i\)</span>, respectively.</p>
<p>This parametrization has the advantage of not imposing a shape on the DFE. For a reasonably fine parametrization,
the number of parameters is larger than those of the other models, however. We generally also observe larger
confidence intervals for this parametrization, and the optimization procedure may well be less efficient as
we have to re-normalize the parameters to make sure they sum up to 1.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-100000,</span> <span class="pre">-100,</span> <span class="pre">-10,</span> <span class="pre">-1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1000])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – The intervals of the discrete distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.intervals">
<span class="sig-name descname"><span class="pre">intervals</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.intervals" title="Permalink to this definition"></a></dt>
<dd><p>Intervals</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.interval_sizes">
<span class="sig-name descname"><span class="pre">interval_sizes</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.interval_sizes" title="Permalink to this definition"></a></dt>
<dd><p>Interval sizes</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.k">
<span class="sig-name descname"><span class="pre">k</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.k" title="Permalink to this definition"></a></dt>
<dd><p>Number of intervals, including the two infinite ones</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.params" title="Permalink to this definition"></a></dt>
<dd><p>All parameter names, including the fixed ones</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.param_names">
<span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.param_names" title="Permalink to this definition"></a></dt>
<dd><p>Parameter names that are not fixed</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.fixed_params">
<span class="sig-name descname"><span class="pre">fixed_params</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.fixed_params" title="Permalink to this definition"></a></dt>
<dd><p>Fixed parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.get_pdf">
<span class="sig-name descname"><span class="pre">get_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.get_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Get PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Parameter values S1, S2, …, Sk</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that computes the PDF for given S values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteParametrization.get_cdf">
<span class="sig-name descname"><span class="pre">get_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteParametrization.get_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Get CDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Parameter values S1, S2, …, Sk</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that computes the CDF for given S values</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DiscreteFractionalParametrization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-100000,</span> <span class="pre">-100,</span> <span class="pre">-10,</span> <span class="pre">-1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1000])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.parametrization.Parametrization" title="fastdfe.parametrization.Parametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parametrization</span></code></a></p>
<p>Same model as <a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization" title="fastdfe.parametrization.DiscreteParametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscreteParametrization</span></code></a>, but re-parametrized by
<span class="math notranslate nohighlight">\(\hat{S}_1, \hat{S}_2, \dots, \hat{S}_{k-1}\)</span>, so that the mass in the ith interval <span class="math notranslate nohighlight">\(S_i\)</span>
is determined by the sum of masses to the left, i.e.</p>
<p><span class="math notranslate nohighlight">\(S_i = \hat{S}_i \sum_{j&lt;i} S_j, i = 1, \dots, k - 1\)</span>,</p>
<p><span class="math notranslate nohighlight">\(S_k = 1 - \sum_{j=1}^{k-1} S_j\)</span>.</p>
<p>This parametrization has the advantage of not imposing a shape on the DFE. For a reasonably fine parametrization,
the number of parameters is larger than those of the other models, however. It is preferable over
<a class="reference internal" href="#fastdfe.parametrization.DiscreteParametrization" title="fastdfe.parametrization.DiscreteParametrization"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscreteParametrization</span></code></a> as it has one parameter less and does not impose a constraint on the parameters.
Another disadvantage is that there might be <cite>gaps</cite> in the estimated DFE, which is not possible with the other
parametrizations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([-100000,</span> <span class="pre">-100,</span> <span class="pre">-10,</span> <span class="pre">-1,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1000])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>intervals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – The intervals of the discrete distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.intervals">
<span class="sig-name descname"><span class="pre">intervals</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.intervals" title="Permalink to this definition"></a></dt>
<dd><p>Intervals</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.interval_sizes">
<span class="sig-name descname"><span class="pre">interval_sizes</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.interval_sizes" title="Permalink to this definition"></a></dt>
<dd><p>Interval sizes</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.k">
<span class="sig-name descname"><span class="pre">k</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.k" title="Permalink to this definition"></a></dt>
<dd><p>Number of intervals, including the two infinite ones</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.params" title="Permalink to this definition"></a></dt>
<dd><p>All parameter names, including fixed parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.param_names">
<span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></em><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.param_names" title="Permalink to this definition"></a></dt>
<dd><p>Parameter names that are not fixed</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.fixed_params">
<span class="sig-name descname"><span class="pre">fixed_params</span></span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.fixed_params" title="Permalink to this definition"></a></dt>
<dd><p>Fixed parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.to_nominal">
<span class="sig-name descname"><span class="pre">to_nominal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.to_nominal" title="Permalink to this definition"></a></dt>
<dd><p>Convert representation of fraction of total mass to the left
to representation of fractions which sum to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Parameter values S0, S2, …, Sk</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converted parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.to_fractional">
<span class="sig-name descname"><span class="pre">to_fractional</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.to_fractional" title="Permalink to this definition"></a></dt>
<dd><p>Invert the to_nominal operation: Convert representation of fractions which sum to 1
back to representation of fraction of total mass to the left.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Converted parameters (nominal space)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Original parameters (parameter space)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.get_pdf">
<span class="sig-name descname"><span class="pre">get_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.get_pdf" title="Permalink to this definition"></a></dt>
<dd><p>Get PDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Parameter values S1, S2, …, Sk-1</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that computes the PDF for given S values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.parametrization.DiscreteFractionalParametrization.get_cdf">
<span class="sig-name descname"><span class="pre">get_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.parametrization.DiscreteFractionalParametrization.get_cdf" title="Permalink to this definition"></a></dt>
<dd><p>Get CDF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Parameter values S1, S2, …, Sk-1</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that computes the CDF for given S values</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="config.html" class="btn btn-neutral float-left" title="Configuration class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spectrum.html" class="btn btn-neutral float-right" title="Spectrum class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Janek Sendrowski.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>