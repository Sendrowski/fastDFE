<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VCF Annotation &mdash; fastDFE 1.1.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="VCF Filtration" href="filtration.html" />
    <link rel="prev" title="VCF Parsing" href="parser.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            fastDFE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/introduction.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/inference.html">DFE Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/config.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/parametrizations.html">DFE parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/spectra.html">Working with SFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/parser.html">VCF Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/Python/miscellaneous.html">Miscellaneous</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">R Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/inference.html">DFE Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/config.html">Configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/parametrizations.html">DFE parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/spectra.html">Working with SFS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/parser.html">VCF Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/R/miscellaneous.html">Miscellaneous</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration class</a></li>
<li class="toctree-l1"><a class="reference internal" href="parametrization.html">DFE Parametrizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectrum.html">Spectrum class</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectra.html">Spectra class</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">VCF Parsing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">VCF Annotation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.Annotation"><code class="docutils literal notranslate"><span class="pre">Annotation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.Annotation.__init__"><code class="docutils literal notranslate"><span class="pre">Annotation.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.Annotation.n_annotated"><code class="docutils literal notranslate"><span class="pre">Annotation.n_annotated</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.Annotation.annotate_site"><code class="docutils literal notranslate"><span class="pre">Annotation.annotate_site()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.Annotation.count_target_sites"><code class="docutils literal notranslate"><span class="pre">Annotation.count_target_sites()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.DegeneracyAnnotation"><code class="docutils literal notranslate"><span class="pre">DegeneracyAnnotation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.DegeneracyAnnotation.__init__"><code class="docutils literal notranslate"><span class="pre">DegeneracyAnnotation.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.DegeneracyAnnotation.mismatches"><code class="docutils literal notranslate"><span class="pre">DegeneracyAnnotation.mismatches</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.DegeneracyAnnotation.n_skipped"><code class="docutils literal notranslate"><span class="pre">DegeneracyAnnotation.n_skipped</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.DegeneracyAnnotation.errors"><code class="docutils literal notranslate"><span class="pre">DegeneracyAnnotation.errors</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.DegeneracyAnnotation.annotate_site"><code class="docutils literal notranslate"><span class="pre">DegeneracyAnnotation.annotate_site()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation.__init__"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation.vep_mismatches"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation.vep_mismatches</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation.snpeff_mismatches"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation.snpeff_mismatches</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation.n_vep_comparisons"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation.n_vep_comparisons</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation.n_snpeff_comparisons"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation.n_snpeff_comparisons</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation.mutate"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation.mutate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation.is_synonymous"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation.is_synonymous()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SynonymyAnnotation.annotate_site"><code class="docutils literal notranslate"><span class="pre">SynonymyAnnotation.annotate_site()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.AncestralAlleleAnnotation"><code class="docutils literal notranslate"><span class="pre">AncestralAlleleAnnotation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.MaximumParsimonyAncestralAnnotation"><code class="docutils literal notranslate"><span class="pre">MaximumParsimonyAncestralAnnotation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumParsimonyAncestralAnnotation.__init__"><code class="docutils literal notranslate"><span class="pre">MaximumParsimonyAncestralAnnotation.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumParsimonyAncestralAnnotation.samples"><code class="docutils literal notranslate"><span class="pre">MaximumParsimonyAncestralAnnotation.samples</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumParsimonyAncestralAnnotation.annotate_site"><code class="docutils literal notranslate"><span class="pre">MaximumParsimonyAncestralAnnotation.annotate_site()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel.__init__"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel.pool_branch_rates"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel.pool_branch_rates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel.fixed_params"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel.fixed_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel.bounds"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel.bounds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel.cache"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel.cache()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel.get_x0"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel.get_x0()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel.get_bounds"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel.get_bounds()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel.validate_bounds"><code class="docutils literal notranslate"><span class="pre">SubstitutionModel.validate_bounds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.JCSubstitutionModel"><code class="docutils literal notranslate"><span class="pre">JCSubstitutionModel</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.JCSubstitutionModel.__init__"><code class="docutils literal notranslate"><span class="pre">JCSubstitutionModel.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.JCSubstitutionModel.get_bound"><code class="docutils literal notranslate"><span class="pre">JCSubstitutionModel.get_bound()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.JCSubstitutionModel.get_bounds"><code class="docutils literal notranslate"><span class="pre">JCSubstitutionModel.get_bounds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.K2SubstitutionModel"><code class="docutils literal notranslate"><span class="pre">K2SubstitutionModel</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.K2SubstitutionModel.__init__"><code class="docutils literal notranslate"><span class="pre">K2SubstitutionModel.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.K2SubstitutionModel.get_bounds"><code class="docutils literal notranslate"><span class="pre">K2SubstitutionModel.get_bounds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.SiteConfig"><code class="docutils literal notranslate"><span class="pre">SiteConfig</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.n_major"><code class="docutils literal notranslate"><span class="pre">SiteConfig.n_major</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.major_base"><code class="docutils literal notranslate"><span class="pre">SiteConfig.major_base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.minor_base"><code class="docutils literal notranslate"><span class="pre">SiteConfig.minor_base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.outgroup_bases"><code class="docutils literal notranslate"><span class="pre">SiteConfig.outgroup_bases</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.multiplicity"><code class="docutils literal notranslate"><span class="pre">SiteConfig.multiplicity</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.sites"><code class="docutils literal notranslate"><span class="pre">SiteConfig.sites</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.p_minor"><code class="docutils literal notranslate"><span class="pre">SiteConfig.p_minor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.p_major"><code class="docutils literal notranslate"><span class="pre">SiteConfig.p_major</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteConfig.__init__"><code class="docutils literal notranslate"><span class="pre">SiteConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.SiteInfo"><code class="docutils literal notranslate"><span class="pre">SiteInfo</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.n_major"><code class="docutils literal notranslate"><span class="pre">SiteInfo.n_major</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.major_base"><code class="docutils literal notranslate"><span class="pre">SiteInfo.major_base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.minor_base"><code class="docutils literal notranslate"><span class="pre">SiteInfo.minor_base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.outgroup_bases"><code class="docutils literal notranslate"><span class="pre">SiteInfo.outgroup_bases</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.p_minor"><code class="docutils literal notranslate"><span class="pre">SiteInfo.p_minor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.p_major"><code class="docutils literal notranslate"><span class="pre">SiteInfo.p_major</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.p_major_ancestral"><code class="docutils literal notranslate"><span class="pre">SiteInfo.p_major_ancestral</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.major_ancestral"><code class="docutils literal notranslate"><span class="pre">SiteInfo.major_ancestral</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.p_bases_first_node"><code class="docutils literal notranslate"><span class="pre">SiteInfo.p_bases_first_node</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.p_first_node_ancestral"><code class="docutils literal notranslate"><span class="pre">SiteInfo.p_first_node_ancestral</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.first_node_ancestral"><code class="docutils literal notranslate"><span class="pre">SiteInfo.first_node_ancestral</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.rate_params"><code class="docutils literal notranslate"><span class="pre">SiteInfo.rate_params</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.plot_tree"><code class="docutils literal notranslate"><span class="pre">SiteInfo.plot_tree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.SiteInfo.__init__"><code class="docutils literal notranslate"><span class="pre">SiteInfo.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.BaseType"><code class="docutils literal notranslate"><span class="pre">BaseType</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.BaseType.MINOR"><code class="docutils literal notranslate"><span class="pre">BaseType.MINOR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.BaseType.MAJOR"><code class="docutils literal notranslate"><span class="pre">BaseType.MAJOR</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.PolarizationPrior"><code class="docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.PolarizationPrior.__init__"><code class="docutils literal notranslate"><span class="pre">PolarizationPrior.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.PolarizationPrior.allow_divergence"><code class="docutils literal notranslate"><span class="pre">PolarizationPrior.allow_divergence</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.PolarizationPrior.probabilities"><code class="docutils literal notranslate"><span class="pre">PolarizationPrior.probabilities</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.PolarizationPrior.plot"><code class="docutils literal notranslate"><span class="pre">PolarizationPrior.plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.KingmanPolarizationPrior"><code class="docutils literal notranslate"><span class="pre">KingmanPolarizationPrior</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.AdaptivePolarizationPrior"><code class="docutils literal notranslate"><span class="pre">AdaptivePolarizationPrior</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.AdaptivePolarizationPrior.__init__"><code class="docutils literal notranslate"><span class="pre">AdaptivePolarizationPrior.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.AdaptivePolarizationPrior.n_runs"><code class="docutils literal notranslate"><span class="pre">AdaptivePolarizationPrior.n_runs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.AdaptivePolarizationPrior.parallelize"><code class="docutils literal notranslate"><span class="pre">AdaptivePolarizationPrior.parallelize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.AdaptivePolarizationPrior.seed"><code class="docutils literal notranslate"><span class="pre">AdaptivePolarizationPrior.seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.AdaptivePolarizationPrior.rng"><code class="docutils literal notranslate"><span class="pre">AdaptivePolarizationPrior.rng</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.parallelize"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.parallelize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.max_sites"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.max_sites</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.confidence_threshold"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.confidence_threshold</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.prior"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.prior</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_runs"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.n_runs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.model"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.model</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.configs"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.configs</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.p_bins"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.p_bins</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_sites"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.n_sites</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.param_names"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.param_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.likelihoods"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.likelihoods</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.likelihood"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.likelihood</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.result"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.result</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.params_mle"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.params_mle</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_target_sites"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.n_target_sites</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_est_sfs"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.from_est_sfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.to_est_sfs"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.to_est_sfs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_data"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.from_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_dataframe"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.from_dataframe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.infer"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.infer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.set_mle_params"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.set_mle_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.is_monotonic"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.is_monotonic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.p_polarization"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.p_polarization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_tree"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.get_p_tree()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_config"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.get_p_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_configs"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.get_p_configs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.evaluate_likelihood"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.evaluate_likelihood()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_inferred_site_info"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.get_inferred_site_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_site_info"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.get_site_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.annotate_site"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.annotate_site()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.plot_likelihoods"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.plot_likelihoods()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_outgroup_divergence"><code class="docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation.get_outgroup_divergence()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fastdfe.annotation.Annotator"><code class="docutils literal notranslate"><span class="pre">Annotator</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.Annotator.__init__"><code class="docutils literal notranslate"><span class="pre">Annotator.__init__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.Annotator.output"><code class="docutils literal notranslate"><span class="pre">Annotator.output</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.Annotator.annotations"><code class="docutils literal notranslate"><span class="pre">Annotator.annotations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#fastdfe.annotation.Annotator.annotate"><code class="docutils literal notranslate"><span class="pre">Annotator.annotate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="filtration.html">VCF Filtration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">fastDFE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">VCF Annotation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/annotation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-fastdfe.annotation">
<span id="vcf-annotation"></span><span id="modules-annotation"></span><h1>VCF Annotation<a class="headerlink" href="#module-fastdfe.annotation" title="Permalink to this heading"></a></h1>
<p>VCF annotations and an annotator to apply them.</p>
<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Annotation</span></span><a class="headerlink" href="#fastdfe.annotation.Annotation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.Annotation.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new annotation instance.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotation.n_annotated">
<span class="sig-name descname"><span class="pre">n_annotated</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.annotation.Annotation.n_annotated" title="Permalink to this definition"></a></dt>
<dd><p>The number of annotated sites.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotation.annotate_site">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">annotate_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">cyvcf2.cyvcf2.Variant</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">fastdfe.io_handlers.DummyVariant</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.Annotation.annotate_site" title="Permalink to this definition"></a></dt>
<dd><p>Annotate a single site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variant</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">DummyVariant</span></code>) – The variant to annotate.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The annotated variant.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotation.count_target_sites">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">count_target_sites</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_overlaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contigs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.Annotation.count_target_sites" title="Permalink to this definition"></a></dt>
<dd><p>Count the number of target sites in a GFF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The path to The GFF file path, possibly gzipped or a URL</p></li>
<li><p><strong>remove_overlaps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to remove overlapping target sites.</p></li>
<li><p><strong>contigs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – The contigs to count the target sites for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of target sites per chromosome/contig.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.DegeneracyAnnotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DegeneracyAnnotation</span></span><a class="headerlink" href="#fastdfe.annotation.DegeneracyAnnotation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.annotation.Annotation" title="fastdfe.annotation.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a></p>
<p>Degeneracy annotation. We annotate the degeneracy by looking at each codon for coding variants.
This also annotates mono-allelic sites.</p>
<p>This annotation adds the info fields <code class="docutils literal notranslate"><span class="pre">Degeneracy</span></code> and <code class="docutils literal notranslate"><span class="pre">Degeneracy_Info</span></code>, which hold the degeneracy
of a site (0, 2, 4) and extra information about the degeneracy, respectively. To be used with
<a class="reference internal" href="parser.html#fastdfe.parser.DegeneracyStratification" title="fastdfe.parser.DegeneracyStratification"><code class="xref py py-class docutils literal notranslate"><span class="pre">DegeneracyStratification</span></code></a>.</p>
<p>For this annotation to work, we require a FASTA and GFF file (passed to <a class="reference internal" href="parser.html#fastdfe.parser.Parser" title="fastdfe.parser.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a> or
<a class="reference internal" href="#fastdfe.annotation.Annotator" title="fastdfe.annotation.Annotator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotator</span></code></a>).</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fastdfe</span> <span class="k">as</span> <span class="nn">fd</span>

<span class="n">ann</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">Annotator</span><span class="p">(</span>
    <span class="n">vcf</span><span class="o">=</span><span class="s2">&quot;http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/&quot;</span>
        <span class="s2">&quot;1000_genomes_project/release/20181203_biallelic_SNV/&quot;</span>
        <span class="s2">&quot;ALL.chr21.shapeit2_integrated_v1a.GRCh38.20181129.phased.vcf.gz&quot;</span><span class="p">,</span>
    <span class="n">fasta</span><span class="o">=</span><span class="s2">&quot;http://ftp.ensembl.org/pub/release-109/fasta/homo_sapiens/&quot;</span>
          <span class="s2">&quot;dna/Homo_sapiens.GRCh38.dna.chromosome.21.fa.gz&quot;</span><span class="p">,</span>
    <span class="n">gff</span><span class="o">=</span><span class="s2">&quot;http://ftp.ensembl.org/pub/release-109/gff3/homo_sapiens/&quot;</span>
        <span class="s2">&quot;Homo_sapiens.GRCh38.109.chromosome.21.gff3.gz&quot;</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sapiens.chr21.degeneracy.vcf.gz&#39;</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="p">[</span><span class="n">fd</span><span class="o">.</span><span class="n">DegeneracyAnnotation</span><span class="p">()],</span>
    <span class="n">aliases</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">chr21</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;21&#39;</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">ann</span><span class="o">.</span><span class="n">annotate</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.DegeneracyAnnotation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.DegeneracyAnnotation.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new annotation instance.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.DegeneracyAnnotation.mismatches">
<span class="sig-name descname"><span class="pre">mismatches</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.DegeneracyAnnotation.mismatches" title="Permalink to this definition"></a></dt>
<dd><p>The variants that could not be annotated correctly.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.DegeneracyAnnotation.n_skipped">
<span class="sig-name descname"><span class="pre">n_skipped</span></span><a class="headerlink" href="#fastdfe.annotation.DegeneracyAnnotation.n_skipped" title="Permalink to this definition"></a></dt>
<dd><p>The variant that were skipped because they were not in coding regions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.DegeneracyAnnotation.errors">
<span class="sig-name descname"><span class="pre">errors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.DegeneracyAnnotation.errors" title="Permalink to this definition"></a></dt>
<dd><p>The variants for which the codon could not be determined.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.DegeneracyAnnotation.annotate_site">
<span class="sig-name descname"><span class="pre">annotate_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">cyvcf2.cyvcf2.Variant</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">fastdfe.io_handlers.DummyVariant</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.DegeneracyAnnotation.annotate_site" title="Permalink to this definition"></a></dt>
<dd><p>Annotate a single site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>v</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">DummyVariant</span></code>) – The variant to annotate.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SynonymyAnnotation</span></span><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.annotation.DegeneracyAnnotation" title="fastdfe.annotation.DegeneracyAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">DegeneracyAnnotation</span></code></a></p>
<p>Synonymy annotation. This class annotates a variant with the synonymous/non-synonymous status.</p>
<p>This annotation adds the info fields <code class="docutils literal notranslate"><span class="pre">Synonymous</span></code> and <code class="docutils literal notranslate"><span class="pre">Synonymous_Info</span></code>, which hold
the synonymy (Synonymous [0] or non-synonymous [1]) and the codon information, respectively.
To be used with <a class="reference internal" href="parser.html#fastdfe.parser.SynonymyStratification" title="fastdfe.parser.SynonymyStratification"><code class="xref py py-class docutils literal notranslate"><span class="pre">SynonymyStratification</span></code></a>.</p>
<p>For this annotation to work, we require a FASTA and GFF file (passed to <a class="reference internal" href="parser.html#fastdfe.parser.Parser" title="fastdfe.parser.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a> or
<a class="reference internal" href="#fastdfe.annotation.Annotator" title="fastdfe.annotation.Annotator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotator</span></code></a>).</p>
<p>This class was tested against <a class="reference external" href="https://www.ensembl.org/info/docs/tools/vep/index.html">VEP</a> and <a class="reference external" href="https://pcingola.github.io/SnpEff/">SnpEff</a> and provides the same annotations in almost
all cases.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not recommended for use with <a class="reference internal" href="parser.html#fastdfe.parser.Parser" title="fastdfe.parser.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a> as we also need to annotate mono-allelic sites.
Consider using <a class="reference internal" href="#fastdfe.annotation.DegeneracyAnnotation" title="fastdfe.annotation.DegeneracyAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">DegeneracyAnnotation</span></code></a> and
<a class="reference internal" href="parser.html#fastdfe.parser.DegeneracyStratification" title="fastdfe.parser.DegeneracyStratification"><code class="xref py py-class docutils literal notranslate"><span class="pre">DegeneracyStratification</span></code></a> instead.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new annotation instance.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation.vep_mismatches">
<span class="sig-name descname"><span class="pre">vep_mismatches</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation.vep_mismatches" title="Permalink to this definition"></a></dt>
<dd><p>The number of sites that did not match with VEP.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation.snpeff_mismatches">
<span class="sig-name descname"><span class="pre">snpeff_mismatches</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation.snpeff_mismatches" title="Permalink to this definition"></a></dt>
<dd><p>The number of sites that did not math with the annotation provided by SnpEff</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation.n_vep_comparisons">
<span class="sig-name descname"><span class="pre">n_vep_comparisons</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation.n_vep_comparisons" title="Permalink to this definition"></a></dt>
<dd><p>The number of sites that were concordant with VEP.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation.n_snpeff_comparisons">
<span class="sig-name descname"><span class="pre">n_snpeff_comparisons</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation.n_snpeff_comparisons" title="Permalink to this definition"></a></dt>
<dd><p>The number of sites that were concordant with SnpEff.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation.mutate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mutate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation.mutate" title="Permalink to this definition"></a></dt>
<dd><p>Mutate the codon at the given position to the given alternative allele.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>codon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The codon to mutate.</p></li>
<li><p><strong>alt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The alternative allele.</p></li>
<li><p><strong>pos</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The position to mutate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mutated codon.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation.is_synonymous">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_synonymous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">codon1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codon2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation.is_synonymous" title="Permalink to this definition"></a></dt>
<dd><p>Check if two codons are synonymous.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>codon1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The first codon.</p></li>
<li><p><strong>codon2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The second codon.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if the codons are synonymous, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SynonymyAnnotation.annotate_site">
<span class="sig-name descname"><span class="pre">annotate_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">cyvcf2.cyvcf2.Variant</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">fastdfe.io_handlers.DummyVariant</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SynonymyAnnotation.annotate_site" title="Permalink to this definition"></a></dt>
<dd><p>Annotate a single site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>v</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">DummyVariant</span></code>) – The variant to annotate.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The annotated variant.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.AncestralAlleleAnnotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AncestralAlleleAnnotation</span></span><a class="headerlink" href="#fastdfe.annotation.AncestralAlleleAnnotation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.annotation.Annotation" title="fastdfe.annotation.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for ancestral allele annotation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumParsimonyAncestralAnnotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaximumParsimonyAncestralAnnotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumParsimonyAncestralAnnotation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.annotation.AncestralAlleleAnnotation" title="fastdfe.annotation.AncestralAlleleAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">AncestralAlleleAnnotation</span></code></a></p>
<p>Annotation of ancestral alleles using maximum parsimony. To be used with
<a class="reference internal" href="parser.html#fastdfe.parser.AncestralBaseStratification" title="fastdfe.parser.AncestralBaseStratification"><code class="xref py py-class docutils literal notranslate"><span class="pre">AncestralBaseStratification</span></code></a> and <a class="reference internal" href="#fastdfe.annotation.Annotator" title="fastdfe.annotation.Annotator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotator</span></code></a> or <a class="reference internal" href="parser.html#fastdfe.parser.Parser" title="fastdfe.parser.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a>.</p>
<p>Note that maximum parsimony is not a reliable way to determine ancestral alleles, so it is recommended
to use this annotation together with the ancestral misidentification parameter <code class="docutils literal notranslate"><span class="pre">eps</span></code> or to fold
spectra altogether. Alternatively, you can use <a class="reference internal" href="filtration.html#fastdfe.filtration.DeviantOutgroupFiltration" title="fastdfe.filtration.DeviantOutgroupFiltration"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeviantOutgroupFiltration</span></code></a> to
filter out sites where the major allele among outgroups does not coincide with the major allele among ingroups.
This annotation has the advantage of requiring no outgroup data. If outgroup data is available consider using
:class`MLEAncestralAlleleAnnotation` instead.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumParsimonyAncestralAnnotation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumParsimonyAncestralAnnotation.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new ancestral allele annotation instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>samples</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – The samples to consider when determining the ancestral allele. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all samples are
considered.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumParsimonyAncestralAnnotation.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumParsimonyAncestralAnnotation.samples" title="Permalink to this definition"></a></dt>
<dd><p>The samples to consider when determining the ancestral allele.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumParsimonyAncestralAnnotation.annotate_site">
<span class="sig-name descname"><span class="pre">annotate_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">cyvcf2.cyvcf2.Variant</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">fastdfe.io_handlers.DummyVariant</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumParsimonyAncestralAnnotation.annotate_site" title="Permalink to this definition"></a></dt>
<dd><p>Annotate a single site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variant</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">DummyVariant</span></code>) – The variant to annotate.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The annotated variant.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SubstitutionModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_branch_rates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for substitution models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_branch_rates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new substitution model instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bounds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – The bounds for the parameters.</p></li>
<li><p><strong>pool_branch_rates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to pool the branch rates. By default, each branch has its own rate which
is optimized using MLE. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the branch rates are pooled and a single rate is optimized. This is
useful if the number of sites used is small.</p></li>
<li><p><strong>fixed_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The fixed parameters. Parameters that are not fixed are optimized using MLE.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel.pool_branch_rates">
<span class="sig-name descname"><span class="pre">pool_branch_rates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel.pool_branch_rates" title="Permalink to this definition"></a></dt>
<dd><p>Whether to pool the branch rates.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel.fixed_params">
<span class="sig-name descname"><span class="pre">fixed_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel.fixed_params" title="Permalink to this definition"></a></dt>
<dd><p>The fixed parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel.bounds">
<span class="sig-name descname"><span class="pre">bounds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]]</span></em><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel.bounds" title="Permalink to this definition"></a></dt>
<dd><p>Parameter bounds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel.cache">
<span class="sig-name descname"><span class="pre">cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_branches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel.cache" title="Permalink to this definition"></a></dt>
<dd><p>Cache the probabilities for the given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The parameters.</p></li>
<li><p><strong>n_branches</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel.get_x0">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_x0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.random._generator.Generator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel.get_x0" title="Permalink to this definition"></a></dt>
<dd><p>Get the initial values for the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bounds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – The bounds for the parameters.</p></li>
<li><p><strong>rng</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>) – The random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The initial values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel.get_bounds">
<span class="sig-name descname"><span class="pre">get_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_outgroups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel.get_bounds" title="Permalink to this definition"></a></dt>
<dd><p>Get the bounds for the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_outgroups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of outgroups.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The bounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SubstitutionModel.validate_bounds">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">validate_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SubstitutionModel.validate_bounds" title="Permalink to this definition"></a></dt>
<dd><p>Make sure the lower bounds are positive and the upper bounds are larger than the lower bounds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bounds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – The bounds to validate</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the bounds are invalid</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.JCSubstitutionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">JCSubstitutionModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'K':</span> <span class="pre">(1e-05,</span> <span class="pre">10)}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_branch_rates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.JCSubstitutionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubstitutionModel</span></code></a></p>
<p>Jukes-Cantor substitution model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.JCSubstitutionModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'K':</span> <span class="pre">(1e-05,</span> <span class="pre">10)}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_branch_rates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.JCSubstitutionModel.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new substitution model instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bounds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – The bounds for the parameters. K is the branch rate.</p></li>
<li><p><strong>pool_branch_rates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to pool the branch rates. By default, each branch has its own rate which
is optimized using MLE. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the branch rates are pooled and a single rate is optimized. This is
useful if the number of sites used is small. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, each branch has its own rate denoted by “K{i}”,
where i is the branch index. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the branch rate is denoted by “K”.</p></li>
<li><p><strong>fixed_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The fixed parameters. Parameters that are not fixed are optimized using MLE.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.JCSubstitutionModel.get_bound">
<span class="sig-name descname"><span class="pre">get_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.JCSubstitutionModel.get_bound" title="Permalink to this definition"></a></dt>
<dd><p>Get the bounds for a parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>param</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The parameter.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The lower and upper bounds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.JCSubstitutionModel.get_bounds">
<span class="sig-name descname"><span class="pre">get_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_outgroups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.JCSubstitutionModel.get_bounds" title="Permalink to this definition"></a></dt>
<dd><p>Get the bounds for the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_outgroups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of outgroups.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The lower and upper bounds.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.K2SubstitutionModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">K2SubstitutionModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'K':</span> <span class="pre">(1e-05,</span> <span class="pre">10),</span> <span class="pre">'k':</span> <span class="pre">(0.1,</span> <span class="pre">10)}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_branch_rates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.K2SubstitutionModel" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.annotation.JCSubstitutionModel" title="fastdfe.annotation.JCSubstitutionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">JCSubstitutionModel</span></code></a></p>
<p>Kimura 2-parameter substitution model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.K2SubstitutionModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'K':</span> <span class="pre">(1e-05,</span> <span class="pre">10),</span> <span class="pre">'k':</span> <span class="pre">(0.1,</span> <span class="pre">10)}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_branch_rates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.K2SubstitutionModel.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new substitution model instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bounds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – The bounds for the parameters. K is the branch rate. k is the transition/transversion ratio.</p></li>
<li><p><strong>pool_branch_rates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to pool the branch rates. By default, each branch has its own rate which
is optimized using MLE. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the branch rates are pooled and a single rate is optimized. This is
useful if the number of sites used is small.</p></li>
<li><p><strong>fixed_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The fixed parameters. Parameters that are not fixed are optimized using MLE.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.K2SubstitutionModel.get_bounds">
<span class="sig-name descname"><span class="pre">get_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_outgroups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.K2SubstitutionModel.get_bounds" title="Permalink to this definition"></a></dt>
<dd><p>Get the bounds for the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_outgroups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of outgroups.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The lower and upper bounds.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SiteConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_major:</span> <span class="pre">int,</span> <span class="pre">major_base:</span> <span class="pre">int,</span> <span class="pre">minor_base:</span> <span class="pre">int,</span> <span class="pre">outgroup_bases:</span> <span class="pre">numpy.ndarray[int],</span> <span class="pre">multiplicity:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">sites:</span> <span class="pre">numpy.ndarray[int]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">p_minor:</span> <span class="pre">numpy.float64</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">p_major:</span> <span class="pre">numpy.float64</span> <span class="pre">=</span> <span class="pre">nan</span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SiteConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Ancestral allele site configuration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.n_major">
<span class="sig-name descname"><span class="pre">n_major</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.annotation.SiteConfig.n_major" title="Permalink to this definition"></a></dt>
<dd><p>The number of major alleles.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.major_base">
<span class="sig-name descname"><span class="pre">major_base</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.annotation.SiteConfig.major_base" title="Permalink to this definition"></a></dt>
<dd><p>The major allele base index.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.minor_base">
<span class="sig-name descname"><span class="pre">minor_base</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.annotation.SiteConfig.minor_base" title="Permalink to this definition"></a></dt>
<dd><p>The minor base index.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.outgroup_bases">
<span class="sig-name descname"><span class="pre">outgroup_bases</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.SiteConfig.outgroup_bases" title="Permalink to this definition"></a></dt>
<dd><p>The outgroup base indices.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.multiplicity">
<span class="sig-name descname"><span class="pre">multiplicity</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#fastdfe.annotation.SiteConfig.multiplicity" title="Permalink to this definition"></a></dt>
<dd><p>The multiplicity of the site.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.sites">
<span class="sig-name descname"><span class="pre">sites</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.SiteConfig.sites" title="Permalink to this definition"></a></dt>
<dd><p>The site indices.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.p_minor">
<span class="sig-name descname"><span class="pre">p_minor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float64</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#fastdfe.annotation.SiteConfig.p_minor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.p_major">
<span class="sig-name descname"><span class="pre">p_major</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float64</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#fastdfe.annotation.SiteConfig.p_major" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteConfig.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_major:</span> <span class="pre">int,</span> <span class="pre">major_base:</span> <span class="pre">int,</span> <span class="pre">minor_base:</span> <span class="pre">int,</span> <span class="pre">outgroup_bases:</span> <span class="pre">numpy.ndarray[int],</span> <span class="pre">multiplicity:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">sites:</span> <span class="pre">numpy.ndarray[int]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">p_minor:</span> <span class="pre">numpy.float64</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">p_major:</span> <span class="pre">numpy.float64</span> <span class="pre">=</span> <span class="pre">nan</span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SiteConfig.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SiteInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_major:</span> <span class="pre">int,</span> <span class="pre">major_base:</span> <span class="pre">str,</span> <span class="pre">minor_base:</span> <span class="pre">str,</span> <span class="pre">outgroup_bases:</span> <span class="pre">typing.List[str],</span> <span class="pre">p_minor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">p_major:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">p_major_ancestral:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">major_ancestral:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'.',</span> <span class="pre">p_bases_first_node:</span> <span class="pre">typing.Dict[str,</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">p_first_node_ancestral:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">first_node_ancestral:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'.',</span> <span class="pre">rate_params:</span> <span class="pre">typing.Dict[str,</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SiteInfo" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Ancestral allele site information.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.n_major">
<span class="sig-name descname"><span class="pre">n_major</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.n_major" title="Permalink to this definition"></a></dt>
<dd><p>The number of major alleles.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.major_base">
<span class="sig-name descname"><span class="pre">major_base</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.major_base" title="Permalink to this definition"></a></dt>
<dd><p>The major allele base.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.minor_base">
<span class="sig-name descname"><span class="pre">minor_base</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.minor_base" title="Permalink to this definition"></a></dt>
<dd><p>The minor base index.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.outgroup_bases">
<span class="sig-name descname"><span class="pre">outgroup_bases</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.outgroup_bases" title="Permalink to this definition"></a></dt>
<dd><p>The outgroup base indices.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.p_minor">
<span class="sig-name descname"><span class="pre">p_minor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.p_minor" title="Permalink to this definition"></a></dt>
<dd><p>The probability of the minor allele being the ancestral allele (without prior).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.p_major">
<span class="sig-name descname"><span class="pre">p_major</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.p_major" title="Permalink to this definition"></a></dt>
<dd><p>The probability of the major allele being the ancestral allele (without prior).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.p_major_ancestral">
<span class="sig-name descname"><span class="pre">p_major_ancestral</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.p_major_ancestral" title="Permalink to this definition"></a></dt>
<dd><p>The probability of the major allele being the ancestral allele rather than the minor allele
(possibly with prior if specified).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.major_ancestral">
<span class="sig-name descname"><span class="pre">major_ancestral</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.'</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.major_ancestral" title="Permalink to this definition"></a></dt>
<dd><p>The ancestral base based on comparing major and minor allele.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.p_bases_first_node">
<span class="sig-name descname"><span class="pre">p_bases_first_node</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.p_bases_first_node" title="Permalink to this definition"></a></dt>
<dd><p>The probability of each base being the ancestral base for the first internal node.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.p_first_node_ancestral">
<span class="sig-name descname"><span class="pre">p_first_node_ancestral</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">nan</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.p_first_node_ancestral" title="Permalink to this definition"></a></dt>
<dd><p>The probability that the mostly likely base for the first internal node is the ancestral base.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.first_node_ancestral">
<span class="sig-name descname"><span class="pre">first_node_ancestral</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'.'</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.first_node_ancestral" title="Permalink to this definition"></a></dt>
<dd><p>The ancestral base index for the first internal node.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.rate_params">
<span class="sig-name descname"><span class="pre">rate_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.SiteInfo.rate_params" title="Permalink to this definition"></a></dt>
<dd><p>The branch rates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.plot_tree">
<span class="sig-name descname"><span class="pre">plot_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SiteInfo.plot_tree" title="Permalink to this definition"></a></dt>
<dd><p>Plot the tree for a site. Only Python visualization is supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – The site information.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes to plot on.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show the plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.SiteInfo.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_major:</span> <span class="pre">int,</span> <span class="pre">major_base:</span> <span class="pre">str,</span> <span class="pre">minor_base:</span> <span class="pre">str,</span> <span class="pre">outgroup_bases:</span> <span class="pre">typing.List[str],</span> <span class="pre">p_minor:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">p_major:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">p_major_ancestral:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">major_ancestral:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'.',</span> <span class="pre">p_bases_first_node:</span> <span class="pre">typing.Dict[str,</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;,</span> <span class="pre">p_first_node_ancestral:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">nan,</span> <span class="pre">first_node_ancestral:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'.',</span> <span class="pre">rate_params:</span> <span class="pre">typing.Dict[str,</span> <span class="pre">float]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.SiteInfo.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.BaseType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BaseType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.BaseType" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>The base type, either major or minor.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.BaseType.MINOR">
<span class="sig-name descname"><span class="pre">MINOR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#fastdfe.annotation.BaseType.MINOR" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.BaseType.MAJOR">
<span class="sig-name descname"><span class="pre">MAJOR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#fastdfe.annotation.BaseType.MAJOR" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.PolarizationPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PolarizationPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_divergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.PolarizationPrior" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for priors to be used with the <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation</span></code></a>.
Using a prior, we incorporate information about the general probability of the major allele being the ancestral 
allele across all sites with the same minor allele count, is useful in general as it provides more information 
about the ancestral allele probabilities For example, when we have no outgroup information for a particular site, 
it is good to know how likely it is that the major allele is ancestral in general and incorporate this information 
into the estimates.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.PolarizationPrior.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_divergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.PolarizationPrior.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>allow_divergence</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>Whether to allow divergence. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the probability of the minor allele
being ancestral, which is not contained in the ingroup subsample but rather in all specified ingroups
or among the outgroup, is taken to be the same as if it was present in the ingroup subsample with
frequency 1. This is a hack, but allows us to consider alleles that are not present in the ingroup
subsample.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Setting this to <code class="docutils literal notranslate"><span class="pre">True</span></code> greatly increases the probability of high-frequency derived alleles
which introduces a strong bias in the distribution of frequency counts, e.g., the SFS. Only use this
if you’re interested in the most accurate ancestral state per site.</p>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.PolarizationPrior.allow_divergence">
<span class="sig-name descname"><span class="pre">allow_divergence</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#fastdfe.annotation.PolarizationPrior.allow_divergence" title="Permalink to this definition"></a></dt>
<dd><p>Whether to allow divergence.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.PolarizationPrior.probabilities">
<span class="sig-name descname"><span class="pre">probabilities</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code><span class="pre">,</span> <span class="pre">(</span><code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code><span class="pre">,</span> <span class="pre">)]]</span></em><a class="headerlink" href="#fastdfe.annotation.PolarizationPrior.probabilities" title="Permalink to this definition"></a></dt>
<dd><p>The polarization probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.PolarizationPrior.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'polarization</span> <span class="pre">probabilities'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'p'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.PolarizationPrior.plot" title="Permalink to this definition"></a></dt>
<dd><p>Visualize the polarization probabilities using a scatter plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>]) – y-scale of the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes to plot on. Only for Python visualization backend.</p></li>
<li><p><strong>ylabel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – y-axis label.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.KingmanPolarizationPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">KingmanPolarizationPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_divergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.KingmanPolarizationPrior" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a></p>
<p>Prior based on the standard Kingman coalescent. To be used with 
<a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.AdaptivePolarizationPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AdaptivePolarizationPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_divergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.AdaptivePolarizationPrior" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a></p>
<p>Adaptive prior. To be used with <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation</span></code></a>. This is the
same prior as used in the EST-SFS paper. This prior is adaptive in the sense that the most likely polarization
probabilities given the site configurations are found. This is the most accurate prior, but requires a lot of
sites in order to work properly. You can check that the polarization probabilities are smooth enough across
frequency counts by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_polarization()</span></code>. If they are not
smooth enough, you can increase the number of sites, decrease the number of ingroups, or
use <a class="reference internal" href="#fastdfe.annotation.KingmanPolarizationPrior" title="fastdfe.annotation.KingmanPolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">KingmanPolarizationPrior</span></code></a> instead.</p>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.AdaptivePolarizationPrior.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_divergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.AdaptivePolarizationPrior.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new adaptive prior instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_runs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of runs to perform when determining the polarization parameters. One
run should be sufficient as only one parameter is optimized.</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to parallelize the optimization.</p></li>
<li><p><strong>allow_divergence</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to allow divergence. See <a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a> for details.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The seed for the random number generator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.AdaptivePolarizationPrior.n_runs">
<span class="sig-name descname"><span class="pre">n_runs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#fastdfe.annotation.AdaptivePolarizationPrior.n_runs" title="Permalink to this definition"></a></dt>
<dd><p>The number of runs to use for the adaptive prior.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.AdaptivePolarizationPrior.parallelize">
<span class="sig-name descname"><span class="pre">parallelize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#fastdfe.annotation.AdaptivePolarizationPrior.parallelize" title="Permalink to this definition"></a></dt>
<dd><p>Whether to parallelize the optimization.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.AdaptivePolarizationPrior.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.AdaptivePolarizationPrior.seed" title="Permalink to this definition"></a></dt>
<dd><p>The seed for the random number generator.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.AdaptivePolarizationPrior.rng">
<span class="sig-name descname"><span class="pre">rng</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code></em><a class="headerlink" href="#fastdfe.annotation.AdaptivePolarizationPrior.rng" title="Permalink to this definition"></a></dt>
<dd><p>The random number generator.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaximumLikelihoodAncestralAnnotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">outgroups:</span> <span class="pre">typing.List[str],</span> <span class="pre">n_ingroups:</span> <span class="pre">int,</span> <span class="pre">ingroups:</span> <span class="pre">typing.Optional[typing.List[str]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">exclude:</span> <span class="pre">typing.Optional[typing.List[str]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">model:</span> <span class="pre">fastdfe.annotation.SubstitutionModel</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.K2SubstitutionModel</span> <span class="pre">object&gt;,</span> <span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">prior:</span> <span class="pre">fastdfe.annotation.PolarizationPrior</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.KingmanPolarizationPrior</span> <span class="pre">object&gt;,</span> <span class="pre">max_sites:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">inf,</span> <span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">confidence_threshold:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">n_target_sites:</span> <span class="pre">typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_OutgroupAncestralAlleleAnnotation</span></code></p>
<p>Annotation of ancestral alleles following the probabilistic model of EST-SFS
(<a class="reference external" href="https://doi.org/10.1534/genetics.118.301120">https://doi.org/10.1534/genetics.118.301120</a>). By default, the info field <code class="docutils literal notranslate"><span class="pre">AA</span></code>
(see <code class="xref py py-attr docutils literal notranslate"><span class="pre">Annotator.info_ancestral</span></code>) is added to the VCF file, which holds the ancestral allele. To be used with
<a class="reference internal" href="#fastdfe.annotation.Annotator" title="fastdfe.annotation.Annotator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotator</span></code></a> or <a class="reference internal" href="parser.html#fastdfe.parser.Parser" title="fastdfe.parser.Parser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code></a>. This class can also be used
independently, see the <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_dataframe" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_dataframe"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dataframe()</span></code></a>, <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_data" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_data()</span></code></a> and <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_est_sfs" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_est_sfs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_est_sfs()</span></code></a> methods.</p>
<p>Initially, the branch rates are determined using MLE. Similar to <code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code>, we can also specify the number of
mutational target sites (see the <cite>n_target_sites</cite> argument) in case our VCF file does not contain the full set of
monomorphic sites. This is necessary to obtain realistic branch rate estimates. You can also choose a prior for the
polarization probabilities (see <a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a>). Eventually, for every site, the probability that the
major allele is ancestral is calculated.</p>
<p>When annotating the variants of a VCF file, we check the most likely ancestral allele against a naive
ad-hoc ancestral allele annotation, and record the sites for which we have disagreement. You might want to
sanity-check the mismatches to make sure the model has been properly specified (see <code class="xref py py-attr docutils literal notranslate"><span class="pre">mismatches</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The polarization prior corresponds to the Kingman coalescent probability by default. Using an adaptive prior,
as in the EST-SFS paper, is also possible, but this is only recommended if the number of sites used for the
inference is large (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.prior" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.prior"><code class="xref py py-attr docutils literal notranslate"><span class="pre">prior</span></code></a>).</p></li>
<li><p>The model can only handle sites that have at most 2 alleles across the in- and outgroups, so sites with more
than 2 alleles are ignored. Only variants that are at most bi-allelic in the provided in- and outgroups are
annotated.</p></li>
<li><p>The model determines the probability of the major allele being ancestral opposed to the minor allele. This can
be problematic if the actual ancestral allele is not contained in the ingroup (possibly due to subsampling).
To avoid this issue, we also keep track of potential minor alleles at frequency 0. If we were to ignore this,
it would be impossible to infer divergence, i.e. fixed derived allele that are no longer observed in the
ingroups (see <a class="reference internal" href="#fastdfe.annotation.PolarizationPrior.allow_divergence" title="fastdfe.annotation.PolarizationPrior.allow_divergence"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PolarizationPrior.allow_divergence</span></code></a>). That said, divergence counts are not informative
on DFE inference with fastDFE and allow_divergence should not be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if interested in the SFS.</p></li>
<li><p>The model assumes a single coalescent topology for all sites, in which all outgroups coalesce first with the
ingroup and not with each other. It is important to specify the outgroups in order of increasing divergence
and not to select outgroups that are not much more closely related to each other than to the ingroup (as this
would give rise to a different coalescent topology than the one assumed). You can call
<a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_outgroup_divergence" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_outgroup_divergence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_outgroup_divergence()</span></code></a> after the inference to check the estimated branch rates for each outgroup.
The assumption of a single fixed topology should be good enough provided that in- and outgroups are
sufficiently diverged.</p></li>
</ul>
</div>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fastdfe</span> <span class="k">as</span> <span class="nn">fd</span>

<span class="n">ann</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">Annotator</span><span class="p">(</span>
    <span class="n">vcf</span><span class="o">=</span><span class="s2">&quot;https://github.com/Sendrowski/fastDFE/&quot;</span>
        <span class="s2">&quot;blob/dev/resources/genome/betula/all.&quot;</span>
        <span class="s2">&quot;with_outgroups.subset.10000.vcf.gz?raw=true&quot;</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="p">[</span><span class="n">fd</span><span class="o">.</span><span class="n">MaximumLikelihoodAncestralAnnotation</span><span class="p">(</span>
        <span class="n">outgroups</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ERR2103730&quot;</span><span class="p">],</span>
        <span class="n">n_ingroups</span><span class="o">=</span><span class="mi">15</span>
    <span class="p">)],</span>
    <span class="n">output</span><span class="o">=</span><span class="s2">&quot;genome.polarized.vcf.gz&quot;</span>
<span class="p">)</span>

<span class="n">ann</span><span class="o">.</span><span class="n">annotate</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">outgroups:</span> <span class="pre">typing.List[str],</span> <span class="pre">n_ingroups:</span> <span class="pre">int,</span> <span class="pre">ingroups:</span> <span class="pre">typing.Optional[typing.List[str]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">exclude:</span> <span class="pre">typing.Optional[typing.List[str]]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">model:</span> <span class="pre">fastdfe.annotation.SubstitutionModel</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.K2SubstitutionModel</span> <span class="pre">object&gt;,</span> <span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">prior:</span> <span class="pre">fastdfe.annotation.PolarizationPrior</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.KingmanPolarizationPrior</span> <span class="pre">object&gt;,</span> <span class="pre">max_sites:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">inf,</span> <span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">confidence_threshold:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">n_target_sites:</span> <span class="pre">typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new ancestral allele annotation instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outgroups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – The outgroup samples to consider when determining the ancestral allele in the order of
increasing divergence. A list of sample names as they appear in the VCF file. The order of the outgroups
is important as it determines the order of the branches in the tree, whose rates are optimized, and whose
topology is predetermined. The first outgroup is the closest outgroup to the ingroups, and the last
outgroup is the most distant outgroup. More outgroups lead to a more accurate inference of the ancestral
allele, but also increase the computational cost. Using more than 1 outgroup is recommended, but more than
3 is likely not necessary. Sites where these outgroups are not present are not included when optimizing
the rate parameters. Due to assumptions on the tree topology connecting the in- and outgroups, it is
important that the outgroups are not much more closely related to each other than to the ingroups. Ideally,
the optimized branch rates are show markedly different values, and in any case, they should be monotonically
increasing with the outgroups (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_outgroup_divergence" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_outgroup_divergence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_outgroup_divergence()</span></code></a>).</p></li>
<li><p><strong>n_ingroups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The minimum number of ingroups that must be present at a site for it to be considered
for ancestral allele inference. Note that a larger number of ingroups does not necessarily improve
the accuracy of the ancestral allele inference (see <code class="docutils literal notranslate"><span class="pre">prior</span></code>). A larger number of ingroups can lead
to a large variance in the polarization probabilities, across different frequency counts. <code class="docutils literal notranslate"><span class="pre">n_ingroups</span></code>
should thus only be large if the number of sites used for the inference is also large. A sensible value is
for a reasonable large number of sites (a few thousand) is 10 or perhaps 20 for larger numbers of sites.
We subsample <code class="docutils literal notranslate"><span class="pre">n_ingroups</span></code> ingroups from the total number of ingroups for each site, and such values
should provide representative subsamples in most cases. Note that if <code class="docutils literal notranslate"><span class="pre">ingroups</span></code> is an even number,
the major allele is chosen arbitrarily if the number of major alleles is equal to the number of minor
alleles. To avoid this, you can use an odd number of ingroups.</p></li>
<li><p><strong>ingroups</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – The ingroup samples to consider when determining the ancestral allele. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
all (non-outgroup) samples are considered. A list of sample names as they appear in the VCF file.
Has to be at least as large as <code class="docutils literal notranslate"><span class="pre">n_ingroups</span></code>.</p></li>
<li><p><strong>exclude</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Samples to exclude from the ingroup. A list of sample names as they appear in the VCF file.</p></li>
<li><p><strong>n_runs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of optimization runs to perform when determining the branch rates. You can
check that the likelihoods of the different runs are similar by calling <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.plot_likelihoods" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.plot_likelihoods"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_likelihoods()</span></code></a>.</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to parallelize the computation across multiple cores.</p></li>
<li><p><strong>prior</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a>]) – The prior to use for the polarization probabilities. See <a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a>, 
<a class="reference internal" href="#fastdfe.annotation.KingmanPolarizationPrior" title="fastdfe.annotation.KingmanPolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">KingmanPolarizationPrior</span></code></a> and <a class="reference internal" href="#fastdfe.annotation.AdaptivePolarizationPrior" title="fastdfe.annotation.AdaptivePolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdaptivePolarizationPrior</span></code></a> for more information.</p></li>
<li><p><strong>max_sites</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The maximum number of sites to consider. This is useful if the number of sites is very large.
Choosing a reasonably large subset of sites (on the order of a few thousand bi-allelic sites) can speed up
the computation considerably as parsing can be slow. This subset is then used to calibrate the rate
parameters, and possibly the polarization priors.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The seed for the random number generator. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a random seed is chosen.</p></li>
<li><p><strong>confidence_threshold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – <p>The confidence threshold for the ancestral allele annotation.
Only if the probability of the major allele being ancestral as opposed to
the minor allele is not within <code class="docutils literal notranslate"><span class="pre">((1</span> <span class="pre">-</span> <span class="pre">confidence_threshold)</span> <span class="pre">/</span> <span class="pre">2,</span> <span class="pre">1</span> <span class="pre">-</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">confidence_threshold)</span> <span class="pre">/</span> <span class="pre">2)</span></code>,
the ancestral allele is annotated. This is useful to avoid annotating sites where the ancestral allele
state is not clear. Use values close to <code class="docutils literal notranslate"><span class="pre">0</span></code> to annotate as many sites as possible, and values close to
<code class="docutils literal notranslate"><span class="pre">1</span></code> to annotate only sites where the ancestral allele state is very clear.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This threshold introduces a bias by excluding more sites with high-frequency derived alleles
and should thus be kept at <code class="docutils literal notranslate"><span class="pre">0</span></code> if the distribution of frequency counts is important, e.g., if the SFS
is to be determined.</p>
</div>
</p></li>
<li><p><strong>n_target_sites</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The total number of target sites if this class is used in conjunction with
<code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code> or <a class="reference internal" href="#fastdfe.annotation.Annotator" title="fastdfe.annotation.Annotator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotator</span></code></a>. This is useful if the provided set of sites only
consists of bi-allelic sites. Specify here the total number of sites underlying the given dataset, i.e.,
both mono- and bi-allelic sites. Ignoring mono-allelic sites will lead to overestimation of the rate
parameters. For this to work, a FASTA file must be provided from which the mono-allelic sites can be
sampled. Sampling takes place between the variants of the last and first site on every contig considered
in the VCF file. Use <cite>None</cite> to disable this feature. Note that the number of target sites is automatically
carried over if not specified and this class is used together with <code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code>. In order to use this
feature, you must also specify a FASTA file to <code class="xref py py-class docutils literal notranslate"><span class="pre">Parser</span></code> or <a class="reference internal" href="#fastdfe.annotation.Annotator" title="fastdfe.annotation.Annotator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotator</span></code></a>. Also note that we
extrapolate the number of mono-allelic sites to be sampled from the FASTA file based on the ratio of
sites with called outgroup bases parsed from the VCF file. This is done to obtain branch rates that are
comparable to the ones obtained when using a VCF file that contains both mono- and bi-allelic sites.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.parallelize">
<span class="sig-name descname"><span class="pre">parallelize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.parallelize" title="Permalink to this definition"></a></dt>
<dd><p>Whether to parallelize the computation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.max_sites">
<span class="sig-name descname"><span class="pre">max_sites</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.max_sites" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of sites to consider</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.confidence_threshold">
<span class="sig-name descname"><span class="pre">confidence_threshold</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.confidence_threshold" title="Permalink to this definition"></a></dt>
<dd><p>The confidence threshold for the ancestral allele annotation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.prior">
<span class="sig-name descname"><span class="pre">prior</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">PolarizationPrior</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.prior" title="Permalink to this definition"></a></dt>
<dd><p>The prior to use for the polarization probabilities.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_runs">
<span class="sig-name descname"><span class="pre">n_runs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_runs" title="Permalink to this definition"></a></dt>
<dd><p>Number of random ML starts when determining the rate parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">SubstitutionModel</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.model" title="Permalink to this definition"></a></dt>
<dd><p>The substitution model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.configs">
<span class="sig-name descname"><span class="pre">configs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pd.DataFrame</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.configs" title="Permalink to this definition"></a></dt>
<dd><p>The data frame holding all site configurations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.p_bins">
<span class="sig-name descname"><span class="pre">p_bins</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict[str,</span> <span class="pre">np.ndarray[float,</span> <span class="pre">(n_ingroups</span> <span class="pre">-</span> <span class="pre">1,)]]</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.p_bins" title="Permalink to this definition"></a></dt>
<dd><p>The probability of all sites per frequency bin.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_sites">
<span class="sig-name descname"><span class="pre">n_sites</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_sites" title="Permalink to this definition"></a></dt>
<dd><p>The total number of valid sites parsed (including sites not considered for ancestral allele inference).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.param_names">
<span class="sig-name descname"><span class="pre">param_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List[str]</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.param_names" title="Permalink to this definition"></a></dt>
<dd><p>The parameter names in the order they are passed to the optimizer.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.likelihoods">
<span class="sig-name descname"><span class="pre">likelihoods</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.ndarray[float,</span> <span class="pre">(...,)]</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>The log likelihoods for the different runs when optimizing the rate parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.likelihood">
<span class="sig-name descname"><span class="pre">likelihood</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.likelihood" title="Permalink to this definition"></a></dt>
<dd><p>The best log likelihood when optimizing the rate parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.result">
<span class="sig-name descname"><span class="pre">result</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">OptimizeResult</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.result" title="Permalink to this definition"></a></dt>
<dd><p>Optimization result of the best run.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.params_mle">
<span class="sig-name descname"><span class="pre">params_mle</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict[str,</span> <span class="pre">float]</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.params_mle" title="Permalink to this definition"></a></dt>
<dd><p>The MLE parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_target_sites">
<span class="sig-name descname"><span class="pre">n_target_sites</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span> <span class="pre">|</span> <span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.n_target_sites" title="Permalink to this definition"></a></dt>
<dd><p>The total number of target sites.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_est_sfs">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_est_sfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior:</span> <span class="pre">fastdfe.annotation.PolarizationPrior</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.KingmanPolarizationPrior</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">fastdfe.annotation.SubstitutionModel</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.K2SubstitutionModel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_est_sfs" title="Permalink to this definition"></a></dt>
<dd><p>Create instance from EST-SFS input file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File containing EST-SFS-formatted input data.</p></li>
<li><p><strong>prior</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a>]) – The prior to use for the polarization probabilities (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>n_runs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of runs for rate estimation (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubstitutionModel</span></code></a>) – The substitution model (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to parallelize the runs (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The seed to use for the random number generator.</p></li>
<li><p><strong>chunk_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The chunk size for reading the file.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.to_est_sfs">
<span class="sig-name descname"><span class="pre">to_est_sfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.to_est_sfs" title="Permalink to this definition"></a></dt>
<dd><p>Write the object’s state to an EST-SFS formatted file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The output file name.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_data">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n_major:</span> <span class="pre">typing.Iterable[int],</span> <span class="pre">major_base:</span> <span class="pre">typing.Iterable[str</span> <span class="pre">|</span> <span class="pre">int],</span> <span class="pre">minor_base:</span> <span class="pre">typing.Iterable[str</span> <span class="pre">|</span> <span class="pre">int],</span> <span class="pre">outgroup_bases:</span> <span class="pre">typing.Iterable[typing.Iterable[str</span> <span class="pre">|</span> <span class="pre">int]],</span> <span class="pre">n_ingroups:</span> <span class="pre">int,</span> <span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">model:</span> <span class="pre">fastdfe.annotation.SubstitutionModel</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.K2SubstitutionModel</span> <span class="pre">object&gt;,</span> <span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">prior:</span> <span class="pre">fastdfe.annotation.PolarizationPrior</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.KingmanPolarizationPrior</span> <span class="pre">object&gt;,</span> <span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">pass_indices:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">confidence_threshold:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_data" title="Permalink to this definition"></a></dt>
<dd><p>Create an instance by passing the data directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_major</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The number of major alleles per site. Note that this number has to be lower than <code class="docutils literal notranslate"><span class="pre">n_ingroups</span></code>,
as we consider the number of major alleles of subsamples of size <code class="docutils literal notranslate"><span class="pre">n_ingroups</span></code>.</p></li>
<li><p><strong>major_base</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The major allele per site. A string representation of the base or the base index according
to <code class="docutils literal notranslate"><span class="pre">['A',</span> <span class="pre">'C',</span> <span class="pre">'G',</span> <span class="pre">'T']</span></code> if <code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> if the base is not defined when
<code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">-1</span></code> when <code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>minor_base</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The minor allele per site. A string representation of the base or the base index according
to <code class="docutils literal notranslate"><span class="pre">['A',</span> <span class="pre">'C',</span> <span class="pre">'G',</span> <span class="pre">'T']</span></code> if <code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> if the base is not defined when
<code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">-1</span></code> when <code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>outgroup_bases</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The outgroup alleles per site. A string representation of the base or the base index
if <code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. This should be a list of lists, where the outer list corresponds to the
sites and the inner list to the outgroups per site. All sites are required to have the same number of
outgroups. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> if the base is not defined when <code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">-1</span></code> when
<code class="docutils literal notranslate"><span class="pre">pass_indices</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>n_ingroups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of ingroup samples (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>n_runs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of runs for rate estimation (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubstitutionModel</span></code></a>) – The substitution model (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to parallelize the runs.</p></li>
<li><p><strong>prior</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a>]) – The prior to use for the polarization probabilities (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The seed for the random number generator.</p></li>
<li><p><strong>pass_indices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to pass the base indices instead of the bases.</p></li>
<li><p><strong>confidence_threshold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The confidence threshold for the ancestral allele annotation 
(see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_dataframe">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ingroups:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">fastdfe.annotation.SubstitutionModel</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.K2SubstitutionModel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelize:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior:</span> <span class="pre">fastdfe.annotation.PolarizationPrior</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.KingmanPolarizationPrior</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grouped:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_threshold:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Create an instance from a dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>) – Dataframe with the columns: <code class="docutils literal notranslate"><span class="pre">major_base</span></code>, <code class="docutils literal notranslate"><span class="pre">minor_base</span></code>, <code class="docutils literal notranslate"><span class="pre">outgroup_bases</span></code>, <code class="docutils literal notranslate"><span class="pre">n_major</span></code> of
type <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">int</span></code>, respectively. The outgroup bases should have the same length
for every site.</p></li>
<li><p><strong>n_ingroups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of ingroups (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>n_runs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of runs for rate estimation (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubstitutionModel</span></code></a>) – The substitution model (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>parallelize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to parallelize computations.</p></li>
<li><p><strong>prior</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="#fastdfe.annotation.PolarizationPrior" title="fastdfe.annotation.PolarizationPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolarizationPrior</span></code></a>]) – The prior to use for the polarization probabilities (see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The seed for the random number generator. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a random seed is chosen.</p></li>
<li><p><strong>grouped</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the dataframe is already grouped by all columns (used for internal purposes).</p></li>
<li><p><strong>confidence_threshold</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The confidence threshold for the ancestral allele annotation 
(see <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>).</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">MaximumLikelihoodAncestralAnnotation</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.infer">
<span class="sig-name descname"><span class="pre">infer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.infer" title="Permalink to this definition"></a></dt>
<dd><p>Infer the ancestral allele probabilities for the data provided. This method is only supposed to be called
manually if the data is provided directly, e.g. using <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_data" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_data()</span></code></a>, <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_dataframe" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_dataframe"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_dataframe()</span></code></a> or
<a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_est_sfs" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.from_est_sfs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_est_sfs()</span></code></a>. If the data is provided using a VCF file, this method is called automatically.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.set_mle_params">
<span class="sig-name descname"><span class="pre">set_mle_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.set_mle_params" title="Permalink to this definition"></a></dt>
<dd><p>Set the MLE parameters and update the cache and site configurations. Use this method if you want to
use different parameters for the annotation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The new parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.is_monotonic">
<span class="sig-name descname"><span class="pre">is_monotonic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.is_monotonic" title="Permalink to this definition"></a></dt>
<dd><p>Whether the outgroups are monotonically increasing in divergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the outgroups are monotonically increasing in divergence.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.p_polarization">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">p_polarization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.p_polarization" title="Permalink to this definition"></a></dt>
<dd><p>Get the polarization probabilities or <code class="docutils literal notranslate"><span class="pre">None</span></code> if <code class="docutils literal notranslate"><span class="pre">prior</span></code> is <code class="docutils literal notranslate"><span class="pre">no</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_tree">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_p_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outgroups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outgroup_bases</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><span class="pre">fastdfe.annotation.SubstitutionModel</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_tree" title="Permalink to this definition"></a></dt>
<dd><p>Get the probability of a tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – An observed ingroup base index.</p></li>
<li><p><strong>n_outgroups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of outgroups.</p></li>
<li><p><strong>internal_nodes</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The internal nodes of the tree. We have <code class="docutils literal notranslate"><span class="pre">n_outgroups</span> <span class="pre">-</span> <span class="pre">1</span></code> internal nodes.</p></li>
<li><p><strong>outgroup_bases</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – The observed base indices for the outgroups.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The parameters of the model.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubstitutionModel</span></code></a>) – The model to use. Either ‘K2’ or ‘JC’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_p_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">config:</span> <span class="pre">fastdfe.annotation.SiteConfig,</span> <span class="pre">base_type:</span> <span class="pre">fastdfe.annotation.BaseType,</span> <span class="pre">params:</span> <span class="pre">typing.Dict[str,</span> <span class="pre">float],</span> <span class="pre">model:</span> <span class="pre">fastdfe.annotation.SubstitutionModel</span> <span class="pre">=</span> <span class="pre">&lt;fastdfe.annotation.K2SubstitutionModel</span> <span class="pre">object&gt;,</span> <span class="pre">internal:</span> <span class="pre">typing.Optional[numpy.ndarray[int]]</span> <span class="pre">=</span> <span class="pre">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_config" title="Permalink to this definition"></a></dt>
<dd><p>Get the probability for a site configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#fastdfe.annotation.SiteConfig" title="fastdfe.annotation.SiteConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SiteConfig</span></code></a>) – The site configuration.</p></li>
<li><p><strong>base_type</strong> (<a class="reference internal" href="#fastdfe.annotation.BaseType" title="fastdfe.annotation.BaseType"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseType</span></code></a>) – The base type.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – The parameters for the substitution model.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubstitutionModel</span></code></a>) – The substitution model to use.</p></li>
<li><p><strong>internal</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – Base indices of internal nodes of the tree if fixed. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the internal nodes
are considered as free parameters. -1 also indicates a free parameter. The number of internal nodes
is the number of outgroups minus one.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The probability for a site.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_configs">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_p_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><span class="pre">fastdfe.annotation.SubstitutionModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#fastdfe.annotation.BaseType" title="fastdfe.annotation.BaseType"><span class="pre">fastdfe.annotation.BaseType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_p_configs" title="Permalink to this definition"></a></dt>
<dd><p>Get the probabilities for each site configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>) – The site configurations.</p></li>
<li><p><strong>model</strong> (<a class="reference internal" href="#fastdfe.annotation.SubstitutionModel" title="fastdfe.annotation.SubstitutionModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubstitutionModel</span></code></a>) – The substitution model.</p></li>
<li><p><strong>base_type</strong> (<a class="reference internal" href="#fastdfe.annotation.BaseType" title="fastdfe.annotation.BaseType"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseType</span></code></a>) – The base type.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A dictionary of the rate parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, (<code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>, )]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The probability for each site.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.evaluate_likelihood">
<span class="sig-name descname"><span class="pre">evaluate_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.evaluate_likelihood" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the likelihood function for the rate parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A dictionary of parameters.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The log likelihood.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_inferred_site_info">
<span class="sig-name descname"><span class="pre">get_inferred_site_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_inferred_site_info" title="Permalink to this definition"></a></dt>
<dd><p>Get the site information for the sites included in the parsing process. Note that in case this class is used
with a VCF file, not all sites are included. You can use <a class="reference internal" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_site_info" title="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_site_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_site_info()</span></code></a> to get the site information
for a specific site.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>[<a class="reference internal" href="#fastdfe.annotation.SiteInfo" title="fastdfe.annotation.SiteInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">SiteInfo</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A generator yielding a dictionary with the site information (see <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_site_information()</span></code>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_site_info">
<span class="sig-name descname"><span class="pre">get_site_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_major</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">major_base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minor_base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outgroup_bases</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_site_info" title="Permalink to this definition"></a></dt>
<dd><p>Get information on the specified sites using the inferred parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_major</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of copies of the major allele.</p></li>
<li><p><strong>major_base</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The major bases indices or strings.</p></li>
<li><p><strong>minor_base</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The minor bases indices or strings.</p></li>
<li><p><strong>outgroup_bases</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – The outgroup base indices or strings.</p></li>
<li><p><strong>pass_indices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to pass the indices as strings or convert them to integers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#fastdfe.annotation.SiteInfo" title="fastdfe.annotation.SiteInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">SiteInfo</span></code></a></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The site information.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.annotate_site">
<span class="sig-name descname"><span class="pre">annotate_site</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">cyvcf2.cyvcf2.Variant</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">fastdfe.io_handlers.DummyVariant</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.annotate_site" title="Permalink to this definition"></a></dt>
<dd><p>Annotate a single site.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variant</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Variant</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">DummyVariant</span></code>) – The variant to annotate.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The annotated variant.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.plot_likelihoods">
<span class="sig-name descname"><span class="pre">plot_likelihoods</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rate</span> <span class="pre">likelihoods'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'log'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lnl'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.plot_likelihoods" title="Permalink to this definition"></a></dt>
<dd><p>Visualize the likelihoods of the rate optimization runs using a scatter plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scale</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'lin'</span></code>, <code class="docutils literal notranslate"><span class="pre">'log'</span></code>]) – y-scale of the plot.</p></li>
<li><p><strong>title</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Plot title.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – File to save plot to.</p></li>
<li><p><strong>show</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show plot.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code>]) – Axes to plot on. Only for Python visualization backend.</p></li>
<li><p><strong>ylabel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Label for y-axis.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Axes object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_outgroup_divergence">
<span class="sig-name descname"><span class="pre">get_outgroup_divergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.MaximumLikelihoodAncestralAnnotation.get_outgroup_divergence" title="Permalink to this definition"></a></dt>
<dd><p>Get the inferred branch rates between the ingroup and outgroups by combining the inferred branch rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>One rate for each outgroup.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Annotator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fastdfe.annotation.Annotation" title="fastdfe.annotation.Annotation"><span class="pre">fastdfe.annotation.Annotation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fasta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info_ancestral</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'AA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aliases</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.Annotator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MultiHandler</span></code></p>
<p>Annotate a VCF file with the given annotations.</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fastdfe</span> <span class="k">as</span> <span class="nn">fd</span>

<span class="n">ann</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">Annotator</span><span class="p">(</span>
    <span class="n">vcf</span><span class="o">=</span><span class="s2">&quot;http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/&quot;</span>
        <span class="s2">&quot;1000_genomes_project/release/20181203_biallelic_SNV/&quot;</span>
        <span class="s2">&quot;ALL.chr21.shapeit2_integrated_v1a.GRCh38.20181129.phased.vcf.gz&quot;</span><span class="p">,</span>
    <span class="n">fasta</span><span class="o">=</span><span class="s2">&quot;http://ftp.ensembl.org/pub/release-109/fasta/homo_sapiens/&quot;</span>
          <span class="s2">&quot;dna/Homo_sapiens.GRCh38.dna.chromosome.21.fa.gz&quot;</span><span class="p">,</span>
    <span class="n">gff</span><span class="o">=</span><span class="s2">&quot;http://ftp.ensembl.org/pub/release-109/gff3/homo_sapiens/&quot;</span>
        <span class="s2">&quot;Homo_sapiens.GRCh38.109.chromosome.21.gff3.gz&quot;</span><span class="p">,</span>
    <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sapiens.chr21.degeneracy.vcf.gz&#39;</span><span class="p">,</span>
    <span class="n">annotations</span><span class="o">=</span><span class="p">[</span><span class="n">fd</span><span class="o">.</span><span class="n">DegeneracyAnnotation</span><span class="p">()],</span>
    <span class="n">aliases</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">chr21</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;21&#39;</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">ann</span><span class="o">.</span><span class="n">annotate</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vcf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#fastdfe.annotation.Annotation" title="fastdfe.annotation.Annotation"><span class="pre">fastdfe.annotation.Annotation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fasta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info_ancestral</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'AA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aliases</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.Annotator.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Create a new annotator instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vcf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The path to the VCF file, can be gzipped, urls are also supported</p></li>
<li><p><strong>output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The path to the output file</p></li>
<li><p><strong>annotations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<a class="reference internal" href="#fastdfe.annotation.Annotation" title="fastdfe.annotation.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a>]) – The annotations to apply.</p></li>
<li><p><strong>gff</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – The path to the GFF file, can be gzipped, urls are also supported. Required for
annotations that require a GFF file.</p></li>
<li><p><strong>fasta</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – The path to the FASTA file, can be gzipped, urls are also supported. Required for
annotations that require a FASTA file.</p></li>
<li><p><strong>info_ancestral</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The tag in the INFO field that contains the ancestral allele</p></li>
<li><p><strong>max_sites</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Maximum number of sites to consider</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Seed for the random number generator. Use <code class="docutils literal notranslate"><span class="pre">None</span></code> for no seed.</p></li>
<li><p><strong>cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to cache files downloaded from urls</p></li>
<li><p><strong>aliases</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]) – Dictionary of aliases for the contigs in the VCF file, e.g. <code class="docutils literal notranslate"><span class="pre">{'chr1':</span> <span class="pre">['1']}</span></code>.
This is used to match the contig names in the VCF file with the contig names in the FASTA file and GFF file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotator.output">
<span class="sig-name descname"><span class="pre">output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#fastdfe.annotation.Annotator.output" title="Permalink to this definition"></a></dt>
<dd><p>The path to the output file.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotator.annotations">
<span class="sig-name descname"><span class="pre">annotations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><a class="reference internal" href="#fastdfe.annotation.Annotation" title="fastdfe.annotation.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#fastdfe.annotation.Annotator.annotations" title="Permalink to this definition"></a></dt>
<dd><p>The annotations to apply.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="fastdfe.annotation.Annotator.annotate">
<span class="sig-name descname"><span class="pre">annotate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastdfe.annotation.Annotator.annotate" title="Permalink to this definition"></a></dt>
<dd><p>Annotate the VCF file.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parser.html" class="btn btn-neutral float-left" title="VCF Parsing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="filtration.html" class="btn btn-neutral float-right" title="VCF Filtration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Janek Sendrowski.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>